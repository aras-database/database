"use strict";(self.webpackChunkproton_mail=self.webpackChunkproton_mail||[]).push([[4826],{82522:function(e,t,r){var a=r(28316),n=(r(19465),r(2784)),i=r(4517),o=r(10698),s=r(56666),c=r(70809),l=r(76822),u=r(85789),d=r(23469),p=r(2979),y=r(34489),m=r(1350),f=r(39300);const serializeLogoutURL=(e,t)=>{const r=new URL((0,y.fw)("/switch",m.eim.PROTONACCOUNT));r.searchParams.set("flow","logout"),t&&r.searchParams.set("clear-recovery",JSON.stringify(t));const a=new URLSearchParams,n=e.map((e=>({id:e.UserID,s:e.isSubUser})));return a.set("sessions",(0,f.I0)(JSON.stringify(n))),r.hash=a.toString(),r};var g=r(74009),h=r(42370),b=r(55097),w=r(51401),v=r(68665),A=r(29711),P=r(51993),O=r(42319),j=r(48432),S=r(87258),k=r(64220),E=r(24955),K=r(26729),D=r(52322);const reducer=(e,t)=>{switch(t.type){case"addPendingTask":return[...e,t.payload];case"resolvePendingTask":return e.filter((e=>e!==t.payload));default:return e}},_=(0,n.createContext)(null),I=(0,n.createContext)(null);var globalLoader_GlobalLoaderProvider=e=>{let{children:t}=e;const{addPendingTask:r,tasks:a}=(()=>{const[e,t]=(0,n.useReducer)(reducer,[]),r=(0,n.useCallback)(((e,r)=>{const a={options:r,promise:e};return t({type:"addPendingTask",payload:a}),[e.finally((()=>{t({type:"resolvePendingTask",payload:a})})),a]}),[]);return{tasks:e,addPendingTask:r}})(),i=(0,n.useMemo)((()=>({addPendingTask:r})),[r]);return(0,D.jsx)(_.Provider,{value:a,children:(0,D.jsx)(I.Provider,{value:i,children:t})})},T=r(16553);var globalLoader_GlobalLoader=()=>{const[e]=(0,n.useContext)(_)||[];if(!e)return null;const{text:t}=e.options;return(0,D.jsxs)("div",{className:"fixed flex absolute-center-x bg-norm color-weak p0-5 rounded top-custom global-loader",style:{"--top-custom":"1.5em"},children:[(0,D.jsx)(T.Z,{size:"small",className:"flex"}),t&&(0,D.jsx)("span",{className:"ml0-5",children:t})]})},C=r(72551),Z=r(70429),x=r(21182),M=r(20283),L=r(57964),R=r(31608),N=r(60332),U=r(88379),B=r(49643);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}var api_SideAppApiProvider=e=>{let{children:t}=e;const r=(0,p.ku)(window.location.pathname);return(0,D.jsx)(B.Z.Provider,{value:e=>{const t=(0,U.D)();let a,n=E.Z,i=E.Z;const o=new Promise(((e,t)=>{n=e,i=t})),handler=e=>{if(e.data.type===N.d.SIDE_APP_API_RESPONSE&&e.data.payload.id===t){const{serverTime:t,data:r,success:o,isApiError:s}=e.data.payload;window.removeEventListener("message",handler),a&&clearTimeout(a),(0,L.d)(t),o?n(r):(s&&i((0,R.Oz)(r)),i(r))}};if(r&&(0,k.BB)(r)){const i="signal"in e,o=function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e);i&&(delete o.signal,e.signal.onabort=()=>{(0,k.xt)({type:N.d.SIDE_APP_ABORT_REQUEST,payload:{id:t}},r)}),(0,k.xt)({type:N.d.SIDE_APP_API_REQUEST,payload:{arg:o,id:t,hasAbortController:i}},r),window.addEventListener("message",handler),a=setTimeout((()=>{n(void 0)}),m.EHb)}return o},children:t})},F=r(41392);var G,authentication_Provider=e=>{let{store:t,children:r}=e;return(0,D.jsx)(F.Z.Provider,{value:t,children:r})},z=r(44884),H=r(97647),V=r(67281),W=r(41374),q=r(72483),Y=r(94160),J=r(14454),Q=r(770),X=r(71171),$=r(1208),ee=r(43825),te=r(81813),re=r(50091),ae=r(48130),ne=r(69880),ie=r(21129);function Signout_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Signout_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Signout_ownKeys(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Signout_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var app_Signout=e=>{let{onDone:t,onLogout:r}=e;const a=(0,ae.Z)(),i=(0,ne.Z)();return(0,n.useEffect)((()=>{(async()=>{var e,t;const n=null===(e=i.getLocalID)||void 0===e?void 0:e.call(i),o=null===(t=i.getUID)||void 0===t?void 0:t.call(i);return Promise.all([(0,re.D)(200),o?a(Signout_objectSpread(Signout_objectSpread({},(0,ee.Iv)()),{},{silence:!0})):void 0,o?(0,te.Hd)(o):void 0,void 0!==n?(0,h.EN)(n,o):void 0,r()])})().finally(t)}),[]),(0,D.jsx)(ie.Z,{text:(0,$.c)("Action").t(G||(G=(0,X.Z)(["Signing out"])))})},oe=r(28391),se=r(72335),ce=r(25257);const clearCachedKeys=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];null===(e=t.forEach)||void 0===e||e.call(t,(e=>{null!=e&&e.privateKey&&oe.g.clearKey({key:e.privateKey}).catch((()=>{})),null!=e&&e.publicKey&&oe.g.clearKey({key:e.publicKey}).catch((()=>{}))}))};var clearKeyCache=e=>{const t=e.get(ce.Fn),r=e.get(se.oy);clearCachedKeys(null==t?void 0:t.value),null==r||r.forEach((e=>clearCachedKeys(null==e?void 0:e.value)))},le=r(26751);var app_loadEventID=async(e,t)=>(e=>{const t=e.get("tmpEventID");return e.delete("tmpEventID"),t})(t)||e((0,le.o)()).then((e=>{let{EventID:t}=e;return t}));function ProtonApp_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ProtonApp_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ProtonApp_ownKeys(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ProtonApp_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const getIsSSOPath=e=>{const t="/".concat((0,P.Rf)(e));return Object.values(m.J7O).some((e=>t.startsWith(e)))},getSafePath=e=>{try{const{pathname:t,hash:r,search:a}=new URL(e,window.location.origin);return getIsSSOPath(t)?"":"".concat((0,P.Rf)((0,g.GK)(t))).concat(a).concat(r)}catch(e){return""}};var app_ProtonApp=e=>{let{authentication:t,config:r,children:a,hasInitialAuth:o}=e;const s=(0,n.useRef)(),y=(0,n.useRef)();y.current||(y.current=(0,w.Z)());const[f,P]=(0,n.useState)((()=>{const e=!1===o?void 0:((e,t)=>{if(!m.VVb)return{UID:e,localID:void 0};const{pathname:r}=window.location;if(getIsSSOPath(r))return;const a=(0,g.rM)(r);if(void 0===a||void 0===t)return;const n=(0,h.SH)(t);return(null==n?void 0:n.UID)===e&&a===t?{UID:e,localID:a}:void 0})(t.getUID(),t.getLocalID()),r=(0,c.lX)({basename:(0,g.Us)(null==e?void 0:e.localID)});return ProtonApp_objectSpread(ProtonApp_objectSpread({},e),{},{history:r})})),_=(0,n.useCallback)((e=>{let{UID:r,EventID:a,keyPassword:n,User:i,Addresses:o,LocalID:l,persistent:u,trusted:d,path:p}=e;t.setUID(r),t.setPassword(n),t.setPersistent(u),t.setTrusted(d),void 0!==l&&m.VVb&&t.setLocalID(l);const f=y.current;f&&(f.clear(),f.clearListeners());const h=(0,w.Z)();var b;h.set(S.T_.key,{value:(0,S.gJ)(i),status:j.Q.RESOLVED}),o&&h.set(O.L.key,{value:o,status:j.Q.RESOLVED}),void 0!==a&&((e,t)=>{e.set("tmpEventID",t)})(h,a),y.current=h,s.current=(b=window.location.href,"/".concat(getSafePath(p||"/")||getSafePath(b)));const v=m.VVb?{UID:r,localID:l}:{UID:r,localID:void 0};P(ProtonApp_objectSpread(ProtonApp_objectSpread({},v),{},{history:(0,c.lX)({basename:(0,g.Us)(v.localID)})}))}),[]),I=(0,n.useCallback)((function(){let{clearDeviceRecoveryData:e=!1,persistedSession:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.setUID(void 0),t.setPassword(void 0),t.setPersistent(void 0),t.setLocalID(void 0),t.setTrusted(void 0);const a=y.current;return a&&(clearKeyCache(a),a.clear(),a.clearListeners()),y.current=(0,w.Z)(),s.current="/",m.VVb?(0,b.mj)(serializeLogoutURL(r?[r]:[],e).toString()):(0,b.mj)((0,g.Us)())}),[]),T=(0,d.Z)((()=>(0,v.Z)())),L=(0,n.useCallback)((function(){let{type:e,clearDeviceRecoveryData:r=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};P((a=>{if(!a.UID)return a;const n=(0,h.SH)(t.getLocalID());return"soft"===e?(I({persistedSession:n,clearDeviceRecoveryData:r}),a):ProtonApp_objectSpread(ProtonApp_objectSpread({},a),{},{consumerLogoutPromise:Promise.all(T.notify()).then(E.Z).catch(E.Z),isLoggingOut:!0,clearDeviceRecoveryData:r,persistedSession:n})}))}),[]),{UID:R,localID:N,history:U,isLoggingOut:B,consumerLogoutPromise:F}=f,G=(0,n.useMemo)((()=>R?ProtonApp_objectSpread(ProtonApp_objectSpread({UID:R,localID:N},t),{},{logout:L,onLogout:T.subscribe}):{login:_}),[R]);(0,n.useEffect)((()=>{A.qS(R)}),[R]);const[,X]=(0,n.useState)();(0,n.useEffect)((()=>{void 0!==s.current&&(U.replace(s.current),s.current=void 0,X({}))}),[s.current,U]),(0,n.useEffect)((()=>{var e;null===(e=document.querySelector(".app-root-loader"))||void 0===e||e.classList.add("hidden")}),[]);const $=window.self!==window.top,ee=(0,p.ku)(window.location.pathname),te=$&&ee&&(0,k.BB)(ee)?api_SideAppApiProvider:M.Z;return(0,D.jsx)(V.Z,{config:r,children:(0,D.jsxs)(H.Z,{children:[(0,D.jsx)(K.Z,{}),(0,D.jsx)(J.Z,{children:(0,D.jsx)(n.Fragment,{children:(0,D.jsx)(Q.ZP,{children:(0,D.jsx)(i.F0,{history:U,children:(0,D.jsx)(Z.l,{children:(0,D.jsx)(C.Z,{children:(0,D.jsx)(Y.Z,{children:(0,D.jsx)(W.Z,{children:(0,D.jsx)(te,{UID:R,config:r,onLogout:L,children:(0,D.jsx)(authentication_Provider,{store:G,children:(0,D.jsx)(z.Z,{cache:y.current,children:(0,D.jsx)(l.Z,{children:(0,D.jsx)(u.Z,{children:(0,D.jsx)(globalLoader_GlobalLoaderProvider,{children:(0,D.jsxs)(x.AC,{children:[(0,D.jsx)(globalLoader_GlobalLoader,{}),(0,D.jsx)(q.Z,{}),B?(0,D.jsx)(app_Signout,{onDone:()=>{I({clearDeviceRecoveryData:f.clearDeviceRecoveryData,persistedSession:f.persistedSession})},onLogout:()=>F}):s.current?null:a]})})})})})})})})})})})})})},R)})]})})},ue=r(47963),de=r(29295),pe=r(256),ye=r(23588),me=r(78918),fe=r(41234),ge=r(85260),he=r(50506);function SSOForkConsumer_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function SSOForkConsumer_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?SSOForkConsumer_ownKeys(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SSOForkConsumer_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var be,app_SSOForkConsumer=e=>{let{onLogin:t,onEmptyFork:r,onInvalidFork:a}=e;const[i,o]=(0,n.useState)(null),s=(0,ae.Z)(),silentApi=e=>s(SSOForkConsumer_objectSpread(SSOForkConsumer_objectSpread({},e),{},{silence:!0})),c=(0,fe.Z)();return(0,n.useEffect)((()=>{(async()=>{const{state:e,selector:n,key:i,persistent:o,trusted:s}=(0,ue.LI)();if(!e&&!n&&!i)return r();if(!e||!n||!i)return a();try{const r=await(0,ue.Mm)({selector:n,api:silentApi,state:e,key:i,persistent:o,trusted:s});return void t(r)}catch(e){if(e instanceof me.P5)return a();throw(0,ue.TV)(),e}})().catch((e=>{c(e),o({message:(0,ye.iC)(e)})}))}),[]),i?(0,D.jsx)(he.Z,{errorMessage:i.message}):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(ie.Z,{}),(0,D.jsx)(ge.Z,{})]})},we=r(83161),ve=r(30495);function SSOPublicApp_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function SSOPublicApp_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?SSOPublicApp_ownKeys(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SSOPublicApp_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ae,Pe,app_SSOPublicApp=e=>{let{onLogin:t,onInactiveSession:r}=e;const[a,i]=(0,n.useState)(null),o=(0,ae.Z)(),silentApi=e=>o(SSOPublicApp_objectSpread(SSOPublicApp_objectSpread({},e),{},{silence:!0}));return(0,n.useEffect)((()=>{(0,ve.U)((async()=>{const e=(0,g.rM)(window.location.pathname);if(void 0===e)return r(void 0);try{const r=await(0,we.aZ)(silentApi,e);return void t(r)}catch(t){if(t instanceof me.fm||(0,ye.KY)(t))return r(e);throw t}})()).catch((e=>{i({message:(0,ye.iC)(e)||(null==e?void 0:e.message)||(0,$.c)("Error").t(be||(be=(0,X.Z)(["Unknown error"])))})}))}),[]),a?(0,D.jsx)(he.Z,{errorMessage:a.message}):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(ie.Z,{}),(0,D.jsx)(ge.Z,{})]})},Oe=r(33133),je=r(34354),Se=r(59740),ke=r(42287),Ee=r(10889);const Ke=["disabled"];function PasswordInput_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function PasswordInput_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?PasswordInput_ownKeys(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PasswordInput_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var De,_e,Ie,input_PasswordInput=e=>{let{disabled:t=!1}=e,r=(0,Se.Z)(e,Ke);const[a,i]=(0,n.useState)("password");return(0,D.jsx)(Ee.Z,PasswordInput_objectSpread(PasswordInput_objectSpread({type:a,disabled:t,icon:(0,D.jsx)("button",{title:"password"===a?(0,$.c)("Label").t(Ae||(Ae=(0,X.Z)(["Reveal password"]))):(0,$.c)("Label").t(Pe||(Pe=(0,X.Z)(["Hide password"]))),className:"inline-flex flex-item-noshrink",tabIndex:-1,disabled:t,type:"button",onClick:()=>{i("password"===a?"text":"password")},children:(0,D.jsx)(ke.Z,{className:"mauto",name:"password"===a?"eye":"eye-slash"})})},r),{},{autoCapitalize:"off",autoCorrect:"off",spellCheck:"false"}))},Te=r(91277),Ce=r(70521),Ze=r(80237),xe=r(52825),Me=r(53780),Le=r(48502),Re=r(34463),Ne=r(32055),Ue=r(86601);function ChallengeError_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ChallengeError_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ChallengeError_ownKeys(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ChallengeError_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var challenge_ChallengeError=()=>{const[e,t,r]=(0,Ne.Z)(),a=(0,D.jsx)(Re.Z,{onClick:()=>window.location.reload(),children:(0,$.c)("Action").t(De||(De=(0,X.Z)(["refresh the page"])))},"refresh"),n=(0,D.jsx)(Re.Z,{title:"Contact the support team.",onClick:()=>{t(!0)},children:(0,$.c)("Info").t(_e||(_e=(0,X.Z)(["support team"])))},"support");return(0,D.jsxs)(D.Fragment,{children:[r&&(0,D.jsx)(Ue.Z,ChallengeError_objectSpread({},e)),(0,D.jsx)(Le.Z,{className:"mb1",type:"error",children:(0,$.c)("Error").jt(Ie||(Ie=(0,X.Z)(["Something went wrong, please "," in order to proceed. If you still see this error message please contact our ","."])),a,n)})]})},Be=r(51964),Fe=r(80130),Ge=r(10856),ze=r.n(Ge);const He=["onSuccess","onError","title","children","className","empty","bodyClassName","challengeRef","src","hasSizeObserver","errorTimeout","challengeTimeout"];function ChallengeFrame_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ChallengeFrame_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ChallengeFrame_ownKeys(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ChallengeFrame_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const Ve=15e3,We=9e3;var challenge_ChallengeFrame=e=>{let{onSuccess:t,onError:r,title:a,children:i,className:o,empty:s,bodyClassName:c="",challengeRef:l,src:u,hasSizeObserver:d,errorTimeout:p=Ve,challengeTimeout:y=We}=e,m=(0,Se.Z)(e,He);const f=(0,n.useRef)(null),[g,h]=(0,n.useState)(!1),b=(0,n.useRef)(null),w=(0,n.useMemo)((()=>new URL(u).origin),[u]);return(0,n.useLayoutEffect)((()=>{let e=!0,a="initialize";const setStage=e=>{a=e},n=[],i=new URL(u),addLog=(e,t,r)=>{if(n.length>20)return;const a={type:r,text:"".concat((new Date).toISOString()," ").concat(e," ").concat(i.searchParams.toString())};t&&(a.data=t),n.push(a)};let o=!1;const handleError=()=>{o||(o=!0,setStage("error"),e&&(null==r||r(n)))};let m,g=window.setTimeout((()=>{addLog("Initial iframe timeout",void 0,"error"),handleError()}),p);const v=s?Promise.resolve(""):(A=[...document.querySelectorAll("link[rel=stylesheet]")].map((e=>new URL(e.href,window.location.origin).toString())).filter((e=>e.startsWith(window.location.origin)&&e.endsWith(".css"))),Promise.all(A.map((async e=>{const t=await fetch(e),r=(await t.text()).replace(/^\s+/,"");if("<"===r[0])throw new Error("Invalid data ".concat(e," ").concat(r.slice(0,10)));return[...r.matchAll(/url\(\/(assets\/[^.]+\.(woff|woff2|jpg|png)[^)]*)\)/g)].map((e=>{const[t,r]=e;return{all:t,newUrl:new URL(r,window.location.origin).toString().toString()}})).reduce(((e,t)=>e.replace(t.all,"url(".concat(t.newUrl,")"))),r)}))).then((e=>e.join(""))));var A;const cb=r=>{const n=f.current,i=null==n?void 0:n.contentWindow;if(o||!n||!i||r.origin!==w||r.source!==i||!e)return;const l=r.data,u=null==l?void 0:l.type,y=null==l?void 0:l.payload;if("init"===u&&"initialize"===a&&(clearTimeout(g),setStage("initialized"),addLog("Initialized",void 0,"step"),v.then((t=>{var r,a,n,o;if(!e)return;clearTimeout(g),g=window.setTimeout((()=>{addLog("Load iframe error",void 0,"error"),handleError()}),p);const l=s?"":null!==(r=null===(a=document.querySelector("#".concat(Q.vD)))||void 0===a?void 0:a.innerHTML)&&void 0!==r?r:"",u=s?"":null!==(n=null===(o=document.querySelector("#".concat(K.j)))||void 0===o?void 0:o.innerHTML)&&void 0!==n?n:"";setStage("load"),addLog("Sending data",[l,t,u].map((e=>e.slice(0,30))).join(" - "),"step"),i.postMessage({type:"load",payload:{iconsRoot:"".concat(u),stylesRoot:"".concat(t,"\n").concat(l),hasSizeObserver:d,bodyClassName:c}},w)})).catch((e=>{addLog("CSS load error",{error:e},"error"),handleError()}))),"onload"===u&&"load"===a&&(clearTimeout(g),setStage("loaded"),addLog("Fully loaded",void 0,"step"),e&&(h(!0),null==t||t())),"onerror"===u&&addLog("Script error",{error:y},"message"),"event"===u&&"loaded"===a&&b.current&&((e,t)=>{if(!e)return;const{type:r,id:a}=t;if("keydown"===r&&a){const r=e.querySelector("#".concat(a));r&&ze().Simulate.keyDown(r,{key:t.key})}if("input"===r&&a){const r=e.querySelector("#".concat(a));r&&(r.value=t.value||"",ze().Simulate.change(r))}if("click"===r&&a){const t=e.querySelector("#".concat(a));t&&ze().Simulate.click(t)}})(b.current,y),"rect"===u&&"loaded"===a&&void 0!==(null==y?void 0:y.height)&&(n.classList.add("h-custom"),n.style.setProperty("--height-custom","".concat(y.height,"px"))),"child.message.data"===u&&"loaded"===a){var A;const e=l.data;if(!e)return;null===(A=m)||void 0===A||A({[e.id]:e.fingerprint})}};return l.current={focus:e=>{var t;const r=null===(t=f.current)||void 0===t?void 0:t.contentWindow;r&&"loaded"===a&&r.postMessage({type:"focus",payload:{selector:e}},w)},getChallenge:()=>new Promise(((e,t)=>{var r;const n=null===(r=f.current)||void 0===r?void 0:r.contentWindow;if(!n||"loaded"!==a)return t(new Error("No iframe available"));m=e,n.postMessage({type:"env.loaded",data:{targetOrigin:window.location.origin}},w),n.postMessage({type:"submit.broadcast"},w),g=window.setTimeout((()=>{t(new Error("Challenge timeout"))}),y)}))},addLog("Added listener",void 0,"step"),window.addEventListener("message",cb),()=>{window.removeEventListener("message",cb),clearTimeout(g),e=!1}}),[]),(0,n.useLayoutEffect)((()=>{var e;const t=null===(e=f.current)||void 0===e?void 0:e.contentWindow,r=b.current,a=f.current;if(a&&r&&(!d||!g)){const e=r.getBoundingClientRect();a.classList.add("h-custom"),a.style.setProperty("--height-custom","".concat(e.height,"px"))}r&&t&&g&&t.postMessage({type:"html",payload:"<div>".concat(r.innerHTML,"</div>")},w)}),[g,i,f.current,b.current]),(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{ref:b,style:{position:"absolute","--left-custom":"-1000px","--top-custom":"-1000px"},"aria-hidden":"true",className:"visibility-hidden top-custom left-custom",children:i}),(0,D.jsx)("iframe",ChallengeFrame_objectSpread(ChallengeFrame_objectSpread({},m),{},{src:u,ref:f,title:a,className:o,sandbox:"allow-scripts allow-same-origin allow-popups"}))]})};const qe=["children","style","onSuccess","onError","noLoader","bodyClassName","iframeClassName","loaderClassName","name","type"];function Challenge_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Challenge_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Challenge_ownKeys(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Challenge_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ye,Je,Qe,Xe,$e,challenge_Challenge=e=>{let{children:t,style:r,onSuccess:a,onError:i,noLoader:o,bodyClassName:s,iframeClassName:c,loaderClassName:l,name:u,type:d}=e,p=(0,Se.Z)(e,qe);const[y,m]=(0,n.useState)(!0),[f,g]=(0,n.useState)(!1),[h,b]=(0,n.useState)(0),w=(0,n.useRef)([]),v=(()=>{const e=(0,Be.Ft)("/challenge/v4/html");return e.searchParams.set("Type","".concat(d)),e.searchParams.set("Name",u),h&&e.searchParams.set("Retry","".concat(h)),e.toString()})(),A=(0,Fe.Z)(0,3),P=1e3*(15+5*h-A);return(0,D.jsxs)(D.Fragment,{children:[y&&!o?(0,D.jsx)(T.Z,{className:l}):null,f?(0,D.jsx)(challenge_ChallengeError,{}):(0,D.jsx)(challenge_ChallengeFrame,Challenge_objectSpread(Challenge_objectSpread({src:v,errorTimeout:P,className:c||"w100",bodyClassName:(0,U.dh)(["color-norm bg-norm",s]),style:r,onSuccess:()=>{m(!1),null==a||a(w.current)},onError:e=>{w.current=w.current.concat(e),h<2?b(h+1):(g(!0),m(!1),null==i||i(w.current))}},p),{},{children:t}),h)]})},et=r(96336),tt=r(42492),rt=r(51063);var login_AbuseModal=e=>{let{message:t,open:r,onClose:a}=e;const n=(0,D.jsx)(et.Z,{url:(0,Be.tT)(),children:(0,$.c)("Info").t(Ye||(Ye=(0,X.Z)(["here"])))},1);return(0,D.jsx)(tt.Z,{open:r,title:(0,$.c)("Title").t(Je||(Je=(0,X.Z)(["Account suspended"]))),onClose:a,buttons:(0,D.jsx)(rt.Z,{onClick:a,children:(0,$.c)("Action").t(Qe||(Qe=(0,X.Z)(["Close"])))}),children:t||(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{className:"mb1",children:(0,$.c)("Info").t(Xe||(Xe=(0,X.Z)(["This account has been suspended due to a potential policy violation."])))}),(0,D.jsx)("div",{children:(0,$.c)("Info").jt($e||($e=(0,X.Z)(["If you believe this is in error, please contact us ","."])),n)})]})})};let at;!function(e){e[e.LOGIN=0]="LOGIN",e[e.TWO_FA=1]="TWO_FA",e[e.UNLOCK=2]="UNLOCK",e[e.NEW_PASSWORD=3]="NEW_PASSWORD",e[e.GENERATE_INTERNAL=4]="GENERATE_INTERNAL",e[e.DONE=5]="DONE"}(at||(at={}));var nt=r(12147);const queryAvailableDomains=e=>({url:"domains/available",method:"get",params:{Type:e}});var it=r(35804),ot=r(32061),st=r(90495),ct=r(93829),lt=r(72669);function loginWithFallback_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function loginWithFallback_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?loginWithFallback_ownKeys(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):loginWithFallback_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var authentication_loginWithFallback=async e=>{let{api:t,credentials:r,initialAuthInfo:a,payload:n}=e,i={authInfo:a,lastAuthVersion:void 0};const{username:o}=r,s={Username:o,Payload:n};for(;;){const{authInfo:e=await t((0,ee.C5)(o)),lastAuthVersion:a}=i,{version:n,done:c}=(0,ct.OQ)(e,o,a);try{const a=c?void 0:{suppress:[ee.eZ]},i=loginWithFallback_objectSpread(loginWithFallback_objectSpread({},(0,ee.I8)(s)),a);return{authVersion:n,result:await(0,lt.mI)({api:t,credentials:r,config:i,info:e,version:n})}}catch(e){if(e.data&&e.data.Code===ee.eZ&&!c){i={lastAuthVersion:n};continue}throw e}}},ut=r(57209),dt=r(46605);const getInternalAddressSetupMode=e=>{let{User:t,keyPassword:r,loginPassword:a}=e;if(t.Keys.length>0){if(!r)throw new Error("Missing key password, should never happen");return{mode:"create",keyPassword:r}}return a?{mode:"setup",loginPassword:a}:{mode:"ask"}};var pt=r(38169),yt=r(47886),mt=r(1815),ft=r(45876),gt=r(19962),ht=r(164),bt=r(82453);function userKeys_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}const wt="not_for_email_use@domain.tld",generateUserKey=async e=>(0,ft.zo)(function userKeys_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?userKeys_ownKeys(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):userKeys_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({email:wt},e)),getResetAddressesKeys=e=>{let{addresses:t=[],passphrase:r="",encryptionConfig:a=m._Vy[m.Or5],hasAddressKeyMigrationGeneration:n}=e;return n||(0,yt.k_)(t)?(async e=>{let{addresses:t=[],passphrase:r="",encryptionConfig:a=m._Vy[m.Or5]}=e;if(!t.length)return{userKeyPayload:void 0,addressKeysPayload:void 0};const{privateKey:n,privateKeyArmored:i}=await generateUserKey({passphrase:r,encryptionConfig:a});return{userKeyPayload:i,addressKeysPayload:await Promise.all(t.map((async e=>{const{ID:t,Email:r}=e,{token:i,encryptedToken:o,signature:s}=await(0,ft.AT)(n),{privateKey:c,privateKeyArmored:l}=await(0,ft.zo)({email:r,passphrase:i,encryptionConfig:a}),u=await(0,gt.JZ)(c,{ID:"tmp",primary:1,flags:(0,ht.Zr)(e)});return{AddressID:t,PrivateKey:l,SignedKeyList:await(0,bt.lw)((0,gt.KE)(e,[u])),Token:o,Signature:s}})))}})({addresses:t,passphrase:r,encryptionConfig:a}):(async e=>{let{addresses:t=[],passphrase:r="",encryptionConfig:a=m._Vy[m.Or5]}=e;if(!t.length)return{userKeyPayload:void 0,addressKeysPayload:void 0};const n=await Promise.all(t.map((async e=>{const{ID:t,Email:n}=e,{privateKey:i,privateKeyArmored:o}=await(0,ft.zo)({email:n,passphrase:r,encryptionConfig:a}),s=await(0,gt.JZ)(i,{ID:"tmp",primary:1,flags:(0,ht.Zr)(e)});return{AddressID:t,PrivateKey:o,SignedKeyList:await(0,bt.lw)((0,gt.KE)(e,[s]))}})));return{userKeyPayload:n[0].PrivateKey,addressKeysPayload:n}})({addresses:t,passphrase:r,encryptionConfig:a})},handleSetupAddressKeys=async e=>{let{username:t,password:r,api:a,hasAddressKeyMigrationGeneration:n}=e;const[i,o]=await Promise.all([(0,nt.te)(a),a(queryAvailableDomains("signup")).then((e=>{let{Domains:t}=e;return t}))]),s=(null==i?void 0:i.length)>0?i:await(async e=>{let{api:t,username:r,domain:a}=e;if(!a)throw new Error("Missing domain");const{Address:n}=await t((0,nt.A_)({Domain:a,DisplayName:r,Signature:""}));return[n]})({api:a,domain:o[0],username:t});return(async e=>{let{api:t,addresses:r,password:a,hasAddressKeyMigrationGeneration:n}=e;if(!r.length)throw new Error("An address is required to setup keys");const{passphrase:i,salt:o}=await(0,mt.ZK)(a),{userKeyPayload:s,addressKeysPayload:c}=await getResetAddressesKeys({addresses:r,passphrase:i,hasAddressKeyMigrationGeneration:n});if(!s||!c)throw new Error("Invalid setup");return await(0,lt.Us)({api:t,credentials:{password:a},config:(0,it.Nl)({KeySalt:o,PrimaryKey:s,AddressKeys:c})}),i})({api:a,addresses:s,password:r,hasAddressKeyMigrationGeneration:n})};var vt=r(67136),At=r(76096),Pt=r(54170),Ot=r(58753);const jt="not_for_email_use@domain.tld",reformatOrganizationKey=async(e,t)=>{const r=await oe.g.reformatKey({userIDs:[{name:jt,email:jt}],privateKey:e});return{privateKey:r,privateKeyArmored:await oe.g.exportPrivateKey({privateKey:r,passphrase:t})}},getV2KeyToUpgrade=e=>e.Version<3,getV2KeysToUpgrade=e=>e?e.filter(getV2KeyToUpgrade):[],reEncryptOrReformatKey=async(e,t,r,a)=>{if(t&&getV2KeyToUpgrade(t))return(0,ft.fE)({email:r,passphrase:a,privateKey:e});return{privateKey:e,privateKeyArmored:await oe.g.exportPrivateKey({privateKey:e,passphrase:a})}},getReEncryptedKeys=(e,t,r,a)=>{const n=t.reduce(((e,t)=>(e[t.ID]=t,e)),{});return Promise.all(e.map((async e=>{let{privateKey:t,ID:i}=e;const{privateKeyArmored:o}=await reEncryptOrReformatKey(t,n[i],r,a);return{ID:i,PrivateKey:o}})))},upgradeV2KeysV2=async e=>{let{user:t,userKeys:r,addressesKeys:a,organizationKey:n,loginPassword:i,clearKeyPassword:o,isOnePasswordMode:s,api:c}=e;if(!r.length)return;const l=(0,ct.Bl)(),u=await(0,ct.zq)(o,l),[d,p]=await Promise.all([getReEncryptedKeys(r,t.Keys,wt,u),null!=n&&n.privateKey?reformatOrganizationKey(n.privateKey,u):void 0]),y=await oe.g.importPrivateKey({armoredKey:d[0].PrivateKey,passphrase:u}),m=await Promise.all(a.map((async e=>{let{address:t,keys:r}=e;const a=await((e,t,r,a)=>{const n=t.reduce(((e,t)=>(e[t.ID]=t,e)),{});return Promise.all(e.map((async e=>{let{ID:t,privateKey:i}=e;const{token:o,encryptedToken:s,signature:c}=await(0,ft.AT)(a),{privateKey:l,privateKeyArmored:u}=await reEncryptOrReformatKey(i,n[t],r,o);return{decryptedKey:{ID:t,privateKey:l,publicKey:await oe.g.importPublicKey({binaryKey:await oe.g.exportPublicKey({key:l,format:"binary"})})},Key:{ID:t,PrivateKey:u,Token:s,Signature:c}}})))})(r,t.Keys,t.Email,y),[n,i]=a.reduce(((e,t)=>(e[0].push(t.decryptedKey),e[1].push(t.Key),e)),[[],[]]),o=(0,gt.KE)(t,await(0,gt.kS)(t,t.SignedKeyList,t.Keys,n));return{address:t,addressKeys:i,signedKeyList:await(0,bt.lw)(o)}}))),f=m.map((e=>{let{addressKeys:t}=e;return t})).flat(),g=m.reduce(((e,t)=>{let{address:r,signedKeyList:a}=t;return e[r.ID]=a,e}),{}),h=(0,it.xd)({KeySalt:l,UserKeys:d,AddressKeys:f,OrganizationKey:null==p?void 0:p.privateKeyArmored,SignedKeyLists:g});return s?(await(0,lt.Us)({api:c,credentials:{password:i},config:h}),u):(await c(h),u)},upgradeV2KeysHelper=async e=>{let{user:t,addresses:r,loginPassword:a,clearKeyPassword:n,keyPassword:i,isOnePasswordMode:o,api:s}=e;const c=await(0,pt.rB)(t,i),l=await Promise.all(r.map((async e=>({address:e,keys:await(0,Pt.N)(e.Keys,t,c,i)})))),u=t.Role===m.pRz.ADMIN_ROLE?await s((0,vt.Gu)()).then((e=>(0,Ot.K)({keyPassword:i,Key:e}))):void 0;if(!n||!a)throw new Error("Password required");if(t.OrganizationPrivateKey)return;const d=(0,At.qL)(t.Keys,"ID"),p=c.some((e=>{let{privateKey:t,ID:r}=e;const a=d[r];return a&&t&&getV2KeyToUpgrade(a)})),y=l.some((e=>{let{address:t,keys:r}=e;const a=(0,At.qL)(t.Keys,"ID");return r.some((e=>{let{privateKey:t,ID:r}=e;const n=a[r];return n&&t&&getV2KeyToUpgrade(n)}))}));return p||y?(0,yt.k_)(r)?upgradeV2KeysV2({api:s,user:t,userKeys:c,addressesKeys:l,organizationKey:u,loginPassword:a,clearKeyPassword:n,isOnePasswordMode:o}):(async e=>{let{user:t,userKeys:r,addressesKeys:a,organizationKey:n,loginPassword:i,clearKeyPassword:o,isOnePasswordMode:s,api:c}=e;const l=(0,ct.Bl)(),u=await(0,ct.zq)(o,l),[d,p,y]=await Promise.all([getReEncryptedKeys(r,t.Keys,wt,u),Promise.all(a.map((e=>{let{address:t,keys:r}=e;return getReEncryptedKeys(r,t.Keys,t.Email,u)}))),null!=n&&n.privateKey?reformatOrganizationKey(n.privateKey,u):void 0]),m=[...d,...p.flat()],f=(0,it.xd)({KeySalt:l,Keys:m,OrganizationKey:null==y?void 0:y.privateKeyArmored});return s?(await(0,lt.Us)({api:c,credentials:{password:i},config:f}),u):(await c(f),u)})({api:s,user:t,userKeys:c,addressesKeys:l,organizationKey:u,loginPassword:a,clearKeyPassword:n,isOnePasswordMode:o}):void 0};var St=r(52494),kt=r(92818),Et=r(95629);const getHasTOTPEnabled=e=>(0,kt.jl)(e||0,Et.hT.OTP),getHasU2FEnabled=e=>(0,kt.jl)(e||0,Et.hT.U2F);var Kt,Dt;function loginActions_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function loginActions_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?loginActions_ownKeys(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):loginActions_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const finalizeLogin=async e=>{let{cache:t,loginPassword:r,keyPassword:a,user:n,addresses:i}=e;const{authResult:o,authVersion:s,api:c,authApi:l,persistent:u,hasInternalAddressSetup:d,appName:p,hasTrustedDeviceRecovery:y}=t;s<ct.tD&&await(0,lt.Us)({api:l,credentials:{password:r},config:(0,ot.z)()});let m=n||await l((0,st.PR)()).then((e=>{let{User:t}=e;return t}));if(d&&m.Type===dt.F.EXTERNAL){const[{Domains:e=[]},n]=await Promise.all([l(queryAvailableDomains("signup")),i||(0,nt.te)(l)]);return{to:at.GENERATE_INTERNAL,cache:loginActions_objectSpread(loginActions_objectSpread({},t),{},{internalAddressSetup:{availableDomains:e,externalEmailAddress:null==n?void 0:n[0],setup:getInternalAddressSetupMode({User:m,loginPassword:r,keyPassword:a})}})}}const f=await(0,we.WL)(c,m);if(f)return l((0,ee.Iv)()).catch(E.Z),{to:at.DONE,session:f};let g=!1;if(y&&a){const e=await(0,St.$I)({api:l,user:m,addresses:i,keyPassword:a}).catch(E.Z);if(void 0!==e&&e>0&&(m=await l((0,st.PR)()).then((e=>{let{User:t}=e;return t})),i=void 0),u){const[e,t]=await Promise.all([(0,pt.rB)(m,a),(0,nt.te)(l)]);if((0,St.IE)({user:m,addresses:t,userKeys:e,appName:p})){const t=await l((0,ot.Gw)()).then((e=>{let{UserSettings:t}=e;return t}));t.DeviceRecovery&&(await(0,St.pS)({api:l,user:m,userKeys:e}),g=!0)}}else(0,St.Kd)(m.ID)}return await(0,we.En)(loginActions_objectSpread(loginActions_objectSpread({},o),{},{User:m,keyPassword:a,api:c,persistent:u,trusted:g})),{to:at.DONE,session:loginActions_objectSpread(loginActions_objectSpread({},o),{},{User:m,Addresses:i,keyPassword:a,persistent:u,trusted:g})}},handleKeyMigration=async e=>{let{cache:t,loginPassword:r,keyPassword:a,user:n,addresses:i}=e;const{authApi:o,hasGenerateKeys:s}=t,[c,l]=await Promise.all([n||o((0,st.PR)()).then((e=>{let{User:t}=e;return t})),i||s?(0,nt.te)(o):void 0]);let u=!1;return a&&l&&(u=await(0,yt.Bx)({api:o,keyPassword:a,user:c,addresses:l}).catch((e=>{const t=(0,yt.n9)(e);return t&&(0,A.uT)("Key migration error",{extra:{error:t}}),!1}))),finalizeLogin(loginActions_objectSpread({cache:t,loginPassword:r,keyPassword:a},u?void 0:{user:c,addresses:l}))},handleKeyUpgrade=async e=>{let{cache:t,loginPassword:r,clearKeyPassword:a,keyPassword:n,user:i,isOnePasswordMode:o}=e;const{authApi:s,hasGenerateKeys:c}=t,[l,u]=await Promise.all([i||s((0,st.PR)()).then((e=>{let{User:t}=e;return t})),c?(0,nt.te)(s):void 0]);if(u&&((e,t)=>getV2KeysToUpgrade(e.Keys).length>0||t.some((e=>getV2KeysToUpgrade(e.Keys).length>0)))(l,u)){const e=await upgradeV2KeysHelper({user:l,addresses:u,loginPassword:r,keyPassword:n,clearKeyPassword:a,isOnePasswordMode:o,api:s}).catch((e=>{const t=(0,yt.n9)(e);t&&(0,A.uT)("Key upgrade error",{extra:{error:t}})}));if(void 0!==e)return handleKeyMigration({cache:t,loginPassword:r,keyPassword:e,user:void 0,addresses:void 0})}return handleKeyMigration({cache:t,loginPassword:r,keyPassword:n,user:l,addresses:u})},handleUnlock=async e=>{let{cache:t,clearKeyPassword:r,isOnePasswordMode:a}=e;const{userSaltResult:n,loginPassword:i}=t;if(!n)throw new Error("Invalid state");const[o,s]=n;await(0,re.D)(500);const c=await(async(e,t,r)=>{const{KeySalt:a,PrivateKey:n}=(0,mt.IN)(e.Keys,t);if(!n)throw new Error("Missing private key");const i=a?await(0,ct.zq)(r,a):r;return{primaryKey:await oe.g.importPrivateKey({armoredKey:n,passphrase:i}),keyPassword:i}})(o,s,r).catch((()=>{}));if(!c){const e=new Error((0,$.c)("Error").t(Kt||(Kt=(0,X.Z)(["Incorrect mailbox password. Please try again."]))));throw e.name="PasswordError",e}return handleKeyUpgrade({cache:t,loginPassword:i,clearKeyPassword:r,keyPassword:c.keyPassword,user:o,isOnePasswordMode:a})},next=async e=>{let{cache:t,from:r}=e;const{hasTotp:a,hasUnlock:n,hasU2F:i,authApi:o,authResult:s,ignoreUnlock:c,hasGenerateKeys:l,loginPassword:u}=t;if(r===at.LOGIN){if(a)return{cache:t,to:at.TWO_FA};if(i)throw new Error("U2F is not supported")}if(c)return finalizeLogin({cache:t,loginPassword:u});t.userSaltResult||(t.userSaltResult=await Promise.all([o((0,st.PR)()).then((e=>{let{User:t}=e;return t})),o((0,it.Z9)()).then((e=>{let{KeySalts:t}=e;return t}))]));const[d]=t.userSaltResult;return 0===d.Keys.length?l&&d.Type!==dt.F.EXTERNAL?s.TemporaryPassword?{cache:t,to:at.NEW_PASSWORD}:(async e=>{let{cache:t,newPassword:r}=e;const{userSaltResult:a,authApi:n,username:i}=t;if(!a)throw new Error("Invalid state");const[o]=a,s=await handleSetupAddressKeys({api:n,username:i,password:r,hasAddressKeyMigrationGeneration:1===o.ToMigrate});return finalizeLogin({cache:t,loginPassword:r,keyPassword:s,user:void 0})})({cache:t,newPassword:u}):finalizeLogin({cache:t,loginPassword:u,user:d}):n?{cache:t,to:at.UNLOCK}:handleUnlock({cache:t,clearKeyPassword:u,isOnePasswordMode:!0})},handleLogin=async e=>{let{username:t,password:r,persistent:a,api:n,ignoreUnlock:i,hasGenerateKeys:o,hasTrustedDeviceRecovery:s,appName:c,hasInternalAddressSetup:l,payload:u}=e;const d=await n((0,ee.C5)(t)),{authVersion:p,result:y}=await authentication_loginWithFallback({api:n,credentials:{username:t,password:r},initialAuthInfo:d,payload:u}),{UID:f,AccessToken:g}=y,h=loginActions_objectSpread(loginActions_objectSpread({authResult:y,authVersion:p,api:n,appName:c,authApi:e=>n((0,ut.yi)(f,g,e))},(e=>{let{"2FA":{Enabled:t},PasswordMode:r}=e;return{hasTotp:getHasTOTPEnabled(t),hasU2F:getHasU2FEnabled(t),hasUnlock:r===m.d85.TWO_PASSWORD}})(y)),{},{username:t,persistent:a,loginPassword:r,ignoreUnlock:i,hasGenerateKeys:o,hasInternalAddressSetup:l,hasTrustedDeviceRecovery:s});return next({cache:h,from:at.LOGIN})};var _t,It,Tt,Ct,Zt,xt,Mt,Lt,Rt,Nt,Ut;function MinimalLoginContainer_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function MinimalLoginContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?MinimalLoginContainer_ownKeys(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MinimalLoginContainer_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const UnlockForm=e=>{let{onSubmit:t,cancelButton:r}=e;const[a,i]=(0,xe.Z)(),[o,s]=(0,n.useState)("");return(0,D.jsxs)("form",{name:"unlockForm",onSubmit:e=>{e.preventDefault(),i(t(o)).catch(E.Z)},method:"post",children:[(0,D.jsx)(je.Z,{htmlFor:"password",children:(0,$.c)("Label").t(_t||(_t=(0,X.Z)(["Mailbox password"])))}),(0,D.jsx)("div",{className:"mb1",children:(0,D.jsx)(input_PasswordInput,{name:"password",autoFocus:!0,autoCapitalize:"off",autoCorrect:"off",id:"password",required:!0,className:"w100",value:o,placeholder:(0,$.c)("Placeholder").t(It||(It=(0,X.Z)(["Mailbox password"]))),onChange:a?E.Z:e=>{let{target:{value:t}}=e;return s(t)},"data-cy-login":"mailbox password"})}),(0,D.jsxs)("div",{className:"flex flex-justify-space-between",children:[r,(0,D.jsx)(Te.Z,{type:"submit",loading:a,"data-cy-login":"submit mailbox password",children:(0,$.c)("Action").t(Tt||(Tt=(0,X.Z)(["Submit"])))})]})]})},TOTPForm=e=>{let{onSubmit:t,cancelButton:r}=e;const[a,i]=(0,xe.Z)(),[o,s]=(0,n.useState)("");return(0,D.jsxs)("form",{name:"totpForm",onSubmit:e=>{e.preventDefault(),i(t(o)).catch(E.Z)},method:"post",children:[(0,D.jsx)(je.Z,{htmlFor:"twoFa",children:(0,$.c)("Label").t(Ct||(Ct=(0,X.Z)(["Two-factor authentication code"])))}),(0,D.jsx)("div",{className:"mb1",children:(0,D.jsx)(Ee.Z,{type:"text",name:"twoFa",autoFocus:!0,autoCapitalize:"off",autoCorrect:"off",autoComplete:"one-time-code",id:"twoFa",required:!0,value:o,className:"w100",placeholder:"123456",onChange:a?E.Z:e=>{let{target:{value:t}}=e;return s(t)},"data-cy-login":"TOTP"})}),(0,D.jsxs)("div",{className:"flex flex-justify-space-between",children:[r,(0,D.jsx)(Te.Z,{type:"submit",disabled:o.length<6,loading:a,"data-cy-login":"submit TOTP",children:(0,$.c)("Action").t(Zt||(Zt=(0,X.Z)(["Submit"])))})]})]})},LoginForm=e=>{let{onSubmit:t,hasChallenge:r,needHelp:a,footer:i}=e;const[o,s]=(0,xe.Z)(),[c,l]=(0,n.useState)(""),[u,d]=(0,n.useState)(""),p=(0,n.useRef)(),y=(0,n.useRef)(null),[f,g]=(0,n.useState)(r),[h,b]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{var e;f||null===(e=y.current)||void 0===e||e.focus()}),[f]),h?(0,D.jsx)(challenge_ChallengeError,{}):(0,D.jsxs)(D.Fragment,{children:[f&&(0,D.jsx)("div",{className:"text-center",children:(0,D.jsx)(Ce.Z,{className:"color-primary",size:"large"})}),(0,D.jsxs)("form",{name:"loginForm",className:f?"hidden":void 0,onSubmit:e=>{e.preventDefault();s((async()=>{var e;const r=await(null===(e=p.current)||void 0===e?void 0:e.getChallenge());return t(c,u,r)})()).catch(E.Z)},method:"post",children:[r&&(0,D.jsx)(challenge_Challenge,{className:"h0",tabIndex:-1,challengeRef:p,name:"login",type:0,onSuccess:()=>{g(!1)},onError:()=>{g(!1),b(!0)}}),(0,D.jsx)(je.Z,{htmlFor:"login",children:(0,$.c)("Label").t(xt||(xt=(0,X.Z)(["Username or "," address"])),m.cL1)}),(0,D.jsx)("div",{className:"mb1",children:(0,D.jsx)(Ee.Z,{type:"text",name:"login",ref:y,autoFocus:!0,autoCapitalize:"off",autoCorrect:"off",title:(0,$.c)("Title").t(Mt||(Mt=(0,X.Z)(["Enter your username or "," email address"])),m.cL1),id:"login",placeholder:m.cS4,required:!0,value:c,onChange:o?E.Z:e=>{let{target:{value:t}}=e;return l(t)},"data-cy-login":"username"})}),(0,D.jsx)(je.Z,{htmlFor:"password",children:(0,$.c)("Label").t(Lt||(Lt=(0,X.Z)(["Password"])))}),(0,D.jsx)("div",{className:"mb1",children:(0,D.jsx)(input_PasswordInput,{name:"password",autoComplete:"current-password",id:"password",title:(0,$.c)("Title").t(Rt||(Rt=(0,X.Z)(["Enter your password"]))),required:!0,value:u,onChange:o?E.Z:e=>{let{target:{value:t}}=e;return d(t)},"data-cy-login":"password"})}),(0,D.jsxs)("div",{className:"flex flex-justify-space-between",children:[a,(0,D.jsx)(Te.Z,{type:"submit",loading:o,"data-cy-login":"submit",children:(0,$.c)("Action").t(Nt||(Nt=(0,X.Z)(["Log in"])))})]}),i]})]})};var login_MinimalLoginContainer=e=>{let{onLogin:t,hasChallenge:r=!1,ignoreUnlock:a=!1,needHelp:i,footer:o}=e;const{APP_NAME:s}=(0,de.Z)(),{createNotification:c}=(0,Me.Z)(),[l,u]=(0,n.useState)(void 0),d=(0,ae.Z)(),silentApi=e=>d(MinimalLoginContainer_objectSpread(MinimalLoginContainer_objectSpread({},e),{},{silence:!0})),p=(0,fe.Z)(),y=(0,n.useRef)(void 0),[m,f]=(0,n.useState)(at.LOGIN),handleResult=e=>{if(e.to===at.DONE)return t(e.session);y.current=e.cache,f(e.to)},handleCancel=()=>{y.current=void 0,f(at.LOGIN)},handleError=e=>{var t;(null===(t=e.data)||void 0===t?void 0:t.Code)!==Oe.KI.AUTH_ACCOUNT_DISABLED?"TOTPError"!==e.name&&"PasswordError"!==e.name?((m===at.LOGIN||m===at.UNLOCK&&"PasswordError"!==e.name||m===at.TWO_FA&&"TOTPError"!==e.name)&&handleCancel(),p(e)):c({type:"error",text:e.message}):u({apiErrorMessage:(0,ye.iC)(e)})},g=(0,D.jsx)(Ze.Z,{type:"reset",onClick:handleCancel,children:(0,$.c)("Action").t(Ut||(Ut=(0,X.Z)(["Cancel"])))}),h=y.current;return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(login_AbuseModal,{message:null==l?void 0:l.apiErrorMessage,open:!!l,onClose:()=>u(void 0)}),m===at.LOGIN&&(0,D.jsx)(LoginForm,{needHelp:i,footer:o,hasChallenge:r,onSubmit:(e,t,r)=>handleLogin({appName:s,username:e,password:t,payload:r,api:silentApi,hasGenerateKeys:!1,ignoreUnlock:a,hasInternalAddressSetup:!1,hasTrustedDeviceRecovery:!1,persistent:!1}).then(handleResult).catch(handleError)}),m===at.TWO_FA&&h&&(0,D.jsx)(TOTPForm,{cancelButton:g,onSubmit:e=>(async e=>{let{cache:t,totp:r}=e;const{authApi:a}=t;return await a((0,ee.vM)({totp:r})).catch((e=>{if(e.status===Oe.VD.UNPROCESSABLE_ENTITY){const t=new Error((0,ye.iC)(e)||(0,$.c)("Error").t(Dt||(Dt=(0,X.Z)(["Incorrect login credentials. Please try again."]))));throw t.name="TOTPError",t}throw e})),next({cache:t,from:at.TWO_FA})})({cache:h,totp:e}).then(handleResult).catch(handleError)}),m===at.UNLOCK&&h&&(0,D.jsx)(UnlockForm,{cancelButton:g,onSubmit:e=>handleUnlock({cache:h,clearKeyPassword:e,isOnePasswordMode:!1}).then(handleResult).catch(handleError)})]})},Bt=r(27314);var app_StandalonePublicApp=e=>{let{onLogin:t,locales:r}=e;return(0,D.jsx)(Bt.Z,{locales:r,children:(0,D.jsx)("div",{className:"h100 flex flex-justify-center flex-align-items-center",children:(0,D.jsx)("div",{className:"w20e",children:(0,D.jsx)(login_MinimalLoginContainer,{onLogin:t})})})})};const ReplaceToBase=()=>(document.location.replace(document.location.origin),(0,D.jsx)(T.Z,{}));var app_StandardSetup=e=>{let{locales:t,PrivateApp:r}=e;const{APP_NAME:a}=(0,de.Z)(),{UID:n,logout:o,login:s,getLocalID:c}=(0,ne.Z)();if(n){const handleInactiveSession=()=>{if(m.VVb)return(0,ue.nT)(a,null==c?void 0:c());o()};return(0,D.jsx)(r,{locales:t,onLogout:handleInactiveSession})}if(m.VVb){const handleInvalidFork=()=>(0,b.mj)((0,y.fw)("/",m.eim.PROTONACCOUNT)),handleInactiveSession=e=>{(0,ue.nT)(a,e)};return(0,D.jsxs)(i.rs,{children:[(0,D.jsx)(i.AW,{path:pe.Bl,children:(0,D.jsx)(ie.Z,{})}),(0,D.jsx)(i.AW,{path:m.J7O.FORK,children:(0,D.jsx)(app_SSOForkConsumer,{onEmptyFork:handleInactiveSession,onInvalidFork:handleInvalidFork,onLogin:s})}),(0,D.jsx)(i.AW,{path:"*",children:(0,D.jsx)(app_SSOPublicApp,{onLogin:s,onInactiveSession:handleInactiveSession})})]})}return m.U02||"/"===document.location.pathname?(0,D.jsx)(app_StandalonePublicApp,{locales:t,onLogin:async e=>s(e)}):(0,D.jsx)(ReplaceToBase,{})},Ft=r(76574);var Gt=(e=>{let{set:t,get:r}=e;const getUID=()=>r(m.Wox);return{getUID:getUID,setUID:e=>t(m.Wox,e),setLocalID:e=>t(m.o44,e),getLocalID:()=>r(m.o44),hasSession:()=>!!getUID(),setPassword:e=>{t(m.cb2,void 0!==e?(0,Ft.PR)(e):e)},getPassword:()=>{const e=r(m.cb2);return void 0===e?"":(0,Ft.N9)(e)},setPersistent:e=>t(m.FPh,e),getPersistent:()=>{var e;return null===(e=r(m.FPh))||void 0===e||e},setTrusted:e=>t(m.Jfq,e),getTrusted:()=>{var e;return null!==(e=r(m.Jfq))&&void 0!==e&&e}}})((0,r(44083).Z)()),zt=r(8482),Ht=r(2631),Vt=r(87374);function eventManager_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function eventManager_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?eventManager_ownKeys(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eventManager_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}let Wt;!function(e){e.DEFAULT="EventID",e.CALENDAR="CalendarModelEventID"}(Wt||(Wt={}));var eventManager_eventManager=e=>{let{api:t,eventID:r,interval:a=m.y2h,query:n=le.v,eventIDKey:i=Wt.DEFAULT}=e;const o=(0,v.Z)();if(!r)throw new Error("eventID must be provided.");let s={retryIndex:0,lastEventID:r,timeoutHandle:void 0,abortController:void 0};const setEventID=e=>{s.lastEventID=e},getEventID=()=>s.lastEventID,setRetryIndex=e=>{s.retryIndex=e},increaseRetryIndex=()=>{const e=s.retryIndex;e<m.BQF.length-1&&setRetryIndex(e+1)},start=()=>{const{timeoutHandle:e,retryIndex:t}=s;if(e)return;const r=a*m.BQF[t];s.timeoutHandle=setTimeout(c,r)},stop=()=>{const{timeoutHandle:e,abortController:t}=s;t&&(t.abort(),delete s.abortController),e&&(clearTimeout(e),delete s.timeoutHandle)},c=(e=>{let t={};const clear=()=>{t={}},clearPromise=()=>{t.promise=void 0},next=()=>(clear(),run()),run=()=>t.queued?t.queued:t.promise?(t.queued=t.promise.then(next),t.queued):(t.promise=e(),t.promise.then(clearPromise).catch(clear),t.promise);return run})((async()=>{try{stop();const e=new AbortController;for(s.abortController=e;;){const r=getEventID();if(!r)throw new Error("EventID undefined");let a;try{a=await t(eventManager_objectSpread(eventManager_objectSpread({},n(r)),{},{signal:e.signal,silence:!0}))}catch(e){if("AbortError"===e.name)return;throw e}await Promise.all(o.notify(a));const{More:s,[i]:c}=a;if(setEventID(c),setRetryIndex(0),!s)break}delete s.abortController,start()}catch(e){throw o.notify({error:e}),delete s.abortController,increaseRetryIndex(),start(),e}}));return{setEventID:setEventID,getEventID:getEventID,start:start,stop:stop,call:c,reset:()=>{stop(),s={retryIndex:0},o.clear()},subscribe:o.subscribe}},qt=r(13185),Yt=r(19272),Jt=r(20166),Qt=r(95372),Xt=r(98065);var $t=r(32799),er=r(22569),tr=r(20635),rr=r(94969),ar=r(83517),nr=r(8958);var hooks_useLoadFeature=()=>(0,n.useContext)(nr.Ub),ir=r(10729);var or=function createLRU(e){let{max:t,onDispose:r}=e;const a=new Map;return{get size(){return a.size},forEach:(e,t)=>a.forEach(e,t),clear:()=>a.clear(),has:e=>a.has(e),delete:e=>a.delete(e),entries:()=>a.entries(),keys:()=>a.keys(),values:()=>a.values(),[Symbol.iterator]:()=>a[Symbol.iterator](),get[Symbol.toStringTag](){return a[Symbol.toStringTag]},set:(e,n)=>{if(a.has(e))a.delete(e);else if(a.size===t){const e=a.keys().next().value,t=a.get(e);a.delete(e),r&&r([e,t])}return a.set(e,n),a},get:e=>{const t=a.get(e);if(t)return a.delete(e),a.set(e,t),t}}},sr=r(43410),cr=r(75001);var contacts_ContactProvider=e=>{let{children:t}=e;const{subscribe:r}=(0,sr.Z)(),a=(0,d.Z)((()=>(0,w.Z)(or({max:10}))));return(0,n.useLayoutEffect)((()=>r((e=>{let{Contacts:t}=e;if(Array.isArray(t))for(const{ID:e,Action:r,Contact:n}of t)a.has(e)&&(r===m.PaG.DELETE&&a.delete(e),r===m.PaG.UPDATE&&a.set(e,{value:n,status:j.Q.RESOLVED}))}))),[]),(0,D.jsx)(cr.Z.Provider,{value:a,children:t})},lr=r(62994);var eventManager_EventManagerProvider=e=>{let{eventManager:t,children:r}=e;return(0,n.useEffect)((()=>(t.start(),()=>{t.stop(),t.reset()})),[]),(0,D.jsx)(lr.Z.Provider,{value:t,children:r})},ur=r(42637);function ModelEventManagerProvider_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ModelEventManagerProvider_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ModelEventManagerProvider_ownKeys(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ModelEventManagerProvider_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const dr=(0,n.createContext)(null),getOrSetRecord=(e,t,r)=>{const a=t[e];if(!a||void 0===a.eventManager&&void 0===a.promise){const a=(async(e,t)=>{const{CalendarModelEventID:r}=await e((0,ur.uw)(t)),a=eventManager_eventManager({api:e,eventID:r,query:e=>(0,ur.vV)(t,e),eventIDKey:Wt.CALENDAR});return a.start(),a})(r,e).then((r=>(t[e]={eventManager:r,promise:void 0},r))).catch((()=>{delete t[e]})),n={promise:a,eventManager:void 0};return t[e]=n,n}return a};var calendar_ModelEventManagerProvider=e=>{let{children:t}=e;const r=(0,ae.Z)(),silentApi=e=>r(ModelEventManagerProvider_objectSpread(ModelEventManagerProvider_objectSpread({},e),{},{silence:!0})),a=(0,n.useRef)({});(0,n.useEffect)((()=>()=>{const e=a.current;a.current={},Object.values(e).forEach((e=>{e&&(e.promise&&e.promise.then((e=>{e&&(e.stop(),e.reset())})),e.eventManager&&(e.eventManager.stop(),e.eventManager.reset()))}))}),[]);const i={start:e=>{const t=a.current;return e.map((e=>{var r,a;return null===(r=t[e])||void 0===r||null===(a=r.eventManager)||void 0===a?void 0:a.start()}))},stop:e=>{const t=a.current;return e.map((e=>{var r,a;return null===(r=t[e])||void 0===r||null===(a=r.eventManager)||void 0===a?void 0:a.stop()}))},reset:e=>{const t=a.current;return e.map((e=>{var r,a;return null===(r=t[e])||void 0===r||null===(a=r.eventManager)||void 0===a?void 0:a.reset()}))},call:e=>{const t=a.current;return Promise.all(e.map((e=>{var r,a;return null===(r=t[e])||void 0===r||null===(a=r.eventManager)||void 0===a?void 0:a.call()})))},subscribe:(e,t)=>{let r=!0;const notify=e=>{t(e)},n=e.reduce(((e,t)=>{const n=getOrSetRecord(t,a.current,silentApi);return n.promise?(n.promise.then((t=>{r&&t&&e.push(t.subscribe(notify))})),e):(e.push(n.eventManager.subscribe(notify)),e)}),[]);return()=>{n.forEach((e=>null==e?void 0:e())),r=!1}}};return(0,D.jsx)(dr.Provider,{value:i,children:t})},pr=r(13980),yr=r.n(pr),mr=r(55704),fr=r(47169),gr=r(88468),hr=r(51983);const br={key:"Domains",get:e=>(0,gr.Z)(((t,r)=>e({url:"domains",method:"get",params:{Page:t,PageSize:r}}))).then((e=>e.flatMap((e=>{let{Domains:t}=e;return t})))),update:(e,t)=>(0,hr.Z)({model:e,events:t,item:e=>{let{Domain:t}=e;return t}})};const wr={key:"Members",get:r(3587).Ux,update:(e,t)=>(0,hr.Z)({model:e,events:t,item:e=>{let{Member:t}=e;return t}})};var vr=r(52528),Ar=r(98903);const Pr="ADDRESSES_KEYS";function EventModelListener_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function EventModelListener_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?EventModelListener_ownKeys(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EventModelListener_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const EventModelListener=e=>{let{models:t}=e;const{subscribe:r}=(0,sr.Z)(),a=(0,ar.Z)();return(0,n.useEffect)((()=>{const e=t.reduce(((e,t)=>EventModelListener_objectSpread(EventModelListener_objectSpread({},e),{},{[t.key]:t})),{});return r((t=>{for(const r of Object.keys(t)){const n=e[r];if(!n)continue;const{value:i,status:o}=a.get(r)||{};o===j.Q.RESOLVED&&a.set(r,{status:j.Q.RESOLVED,value:n.update(i,t[r])})}if((0,kt.jl)(t.Refresh,Oe.fb.CONTACTS)&&(a.delete(mr.o.key),a.delete(fr.i.key)),t[S.T_.key]){const{value:e}=a.get(S.T_.key);e.isFree&&(a.delete(Ar.H.key),a.delete(vr.w.key),a.delete(br.key),a.delete(wr.key)),a.delete(ce.Fn)}if(t[O.L.key]&&(a.delete(se.oy),a.delete(Pr)),void 0!==t.UsedSpace){const e=a.get(S.T_.key);a.set(S.T_.key,EventModelListener_objectSpread(EventModelListener_objectSpread({},e),{},{value:EventModelListener_objectSpread(EventModelListener_objectSpread({},e.value),{},{UsedSpace:t.UsedSpace})}))}}))}),[]),null};EventModelListener.propTypes={models:yr().array.isRequired};var Or=EventModelListener,jr=r(11696),Sr=r(57297);var eventManager_EventNotices=()=>{const{subscribe:e}=(0,sr.Z)(),{createNotification:t}=(0,Me.Z)(),[r]=(0,Sr.ZP)();return(0,n.useEffect)((()=>{const handleNotice=async e=>{const a=await(async e=>{const t=(0,Ft.uG)(await oe.g.computeHash({algorithm:"unsafeMD5",data:(0,Ft.h6)((0,Ft.lz)(e))}));return"NOTICE-".concat(t)})("".concat(r.ID).concat(e)),n=(e=>e?+e:0)((0,jr.rV)(a)),i=Date.now();(!n||i>n)&&((e=>{t({type:"info",text:e,expiration:-1})})(e),(0,jr.LS)(a,"".concat(i+12096e5)))};return e((e=>{let{Notices:t}=e;Array.isArray(t)&&t.forEach((e=>{handleNotice(e)}))}))}),[]),null},kr=r(1445);var Er=(0,n.forwardRef)(((e,t)=>{let{children:r}=e;const[a,i]=(0,n.useState)(1),o=(0,n.useCallback)((()=>i((e=>e+1))),[]);return(0,n.useImperativeHandle)(t,(()=>o)),(0,D.jsx)(kr.Z.Provider,{value:o,children:r},a)})),Kr=r(23105);const{COMPACT:Dr,COMFORTABLE:_r}=m.pw7,Ir={[Dr]:"is-compact",[_r]:"is-comfortable"};var layouts_DensityInjector=()=>{const[{Density:e}={Density:_r}]=(0,Kr.Z)();return(0,n.useLayoutEffect)((()=>(document.body.classList.add(Ir[e]),()=>{document.body.classList.remove(Ir[e])})),[e]),null};var themes_ThemeInjector=()=>{const[e]=(0,Kr.Z)(),[,t]=(0,Q.Fg)(),r=null==e?void 0:e.ThemeType;return(0,n.useLayoutEffect)((()=>{t(r)}),[r]),null},Tr=r(65048);var app_DelinquentContainer=()=>(0,D.jsx)("div",{className:"h100 ui-prominent",children:(0,D.jsx)(Tr.Z,{open:!0})}),Cr=r(54036);function addAddressKeyHelper_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function addAddressKeyHelper_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?addAddressKeyHelper_ownKeys(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):addAddressKeyHelper_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const removePrimary=e=>e.primary?addAddressKeyHelper_objectSpread(addAddressKeyHelper_objectSpread({},e),{},{primary:0}):e,generateAllPrivateMemberKeys=async e=>{let{addresses:t,addressesToGenerate:r,userKeys:a,keyPassword:n,api:i}=e;if(!n)throw new Error("Password required to generate keys");if((0,yt.k_)(t)){var o;const e=null===(o=(0,Cr.x)(a))||void 0===o?void 0:o.privateKey;if(!e)throw new Error("Missing primary user key");return Promise.all(r.map((t=>(async e=>{let{api:t,userKey:r,encryptionConfig:a=m._Vy[m.Or5],address:n,activeKeys:i}=e;const{token:o,encryptedToken:s,signature:c}=await(0,ft.AT)(r),{privateKey:l,privateKeyArmored:u}=await(0,ft.zo)({email:n.Email,passphrase:o,encryptionConfig:a}),d=await(0,gt.JZ)(l,{ID:"tmp",primary:1,flags:(0,ht.Zr)(n)}),p=(0,gt.KE)(n,[d,...i.map(removePrimary)]),y=await(0,bt.lw)(p),{Key:f}=await t((0,it.RR)({AddressID:n.ID,Primary:d.primary,PrivateKey:u,SignedKeyList:y,Signature:c,Token:s}));return d.ID=f.ID,[d,p]})({api:i,userKey:e,address:t,activeKeys:[]}))))}return Promise.all(r.map((e=>(async e=>{let{api:t,address:r,encryptionConfig:a=m._Vy[m.Or5],passphrase:n,activeKeys:i}=e;const{privateKey:o,privateKeyArmored:s}=await(0,ft.zo)({email:r.Email,passphrase:n,encryptionConfig:a}),c=await(0,gt.JZ)(o,{ID:"tmp",primary:1,flags:(0,ht.Zr)(r)}),l=(0,gt.KE)(r,[c,...i.map(removePrimary)]),u=await(0,bt.lw)(l),{Key:d}=await t((0,it.SH)({AddressID:r.ID,Primary:c.primary,PrivateKey:s,SignedKeyList:u}));return c.ID=d.ID,[c,l]})({api:i,address:e,passphrase:n,activeKeys:[]}))))};var Zr=r(33562),xr=r(34528);function KeyBackgroundManager_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function KeyBackgroundManager_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?KeyBackgroundManager_ownKeys(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KeyBackgroundManager_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var app_KeyBackgroundManager=e=>{let{hasPrivateMemberKeyGeneration:t=!1,hasReadableMemberKeyActivation:r=!1,hasMemberKeyMigration:a=!1}=e;const i=(0,Sr.pg)(),o=(0,ce.df)(),s=(0,Zr._2)(),c=(0,se.ZP)(),l=(0,xr.$)(),u=(0,ne.Z)(),{subscribe:d,call:p}=(0,sr.Z)(),y=(0,ae.Z)(),silentApi=e=>y(KeyBackgroundManager_objectSpread(KeyBackgroundManager_objectSpread({},e),{},{silence:!0}));return(0,n.useEffect)((()=>{const runBrokenSKLRestoration=async()=>{const[e,t]=await Promise.all([i(),l()]);t.BrokenSKL&&await(0,yt.ss)({api:silentApi,user:e,keyPassword:u.getPassword()})};(a||t||r)&&(async()=>{const[e,a,n]=await Promise.all([i(),o(),s()]),l=u.getPassword(),d=r?((e,t)=>e&&t&&!e.OrganizationPrivateKey&&e.Private===m.oeR.READABLE?t.filter((e=>{let{Keys:t=[]}=e;return t.some((e=>{let{Activation:t}=e;return!!t}))})):[])(e,n):[],y=d.length?Promise.all(d.map((async e=>{const t=await c(e.ID);return(async e=>{var t;let{addresses:r,address:a,addressKeys:n,userKeys:i,keyPassword:o,api:s}=e;if(!n.length)return;if(!o)throw new Error("Password required to generate keys");const c=(0,gt.KE)(a,await(0,gt.kS)(a,a.SignedKeyList,a.Keys,n)),l=null===(t=(0,Cr.x)(i))||void 0===t?void 0:t.privateKey;if(!l)throw new Error("Missing primary user key");const u=(0,yt.k_)(r);for(const e of n){const{ID:t,privateKey:r}=e,n=a.Keys.find((e=>{let{ID:r}=e;return r===t}));if(null!=n&&n.Activation&&r)if(u){const{token:e,encryptedToken:a,signature:n}=await(0,ft.AT)(l),i=await oe.g.exportPrivateKey({privateKey:r,passphrase:e}),o=await(0,bt.lw)(c);await s((0,it.Cj)({ID:t,PrivateKey:i,SignedKeyList:o,Token:a,Signature:n}))}else{const e=await oe.g.exportPrivateKey({privateKey:r,passphrase:o}),a=await(0,bt.lw)(c);await s((0,it.vb)({ID:t,PrivateKey:e,SignedKeyList:a}))}}})({address:e,addresses:n,addressKeys:t,userKeys:a,keyPassword:l,api:silentApi})}))).then(p).catch(A.hI):void 0,f=t?((e,t)=>e&&t&&!e.OrganizationPrivateKey&&e.Private===m.oeR.UNREADABLE?t.filter((e=>{let{Status:t,Keys:r=[]}=e;return t===m.bwo.STATUS_ENABLED&&!r.length})):[])(e,n):[],g=f.length?generateAllPrivateMemberKeys({addresses:n,addressesToGenerate:f,userKeys:a,keyPassword:l,api:silentApi}).then(p).catch(A.hI):void 0;return Promise.all([y,g])})().then((()=>a?(async()=>{const[e,t,r]=await Promise.all([i(),l(),s()]);if(1!==e.ToMigrate&&1!==t.ToMigrate)return;const a=u.getPassword();let n=(0,yt.k_)(r);await(0,yt.Bx)({api:silentApi,user:e,keyPassword:a,addresses:r})&&(await p(),n=!0),n&&await(0,yt.j6)({api:silentApi,user:e,organization:t,keyPassword:a})})().catch((e=>{const t=(0,yt.n9)(e);t&&(0,A.uT)("Key migration error",{extra:{error:t}})})).then(runBrokenSKLRestoration).catch((e=>{const t=(0,yt.n9)(e);t&&(0,A.uT)("Key SKL restoration error",{extra:{error:t}})})):void 0)).catch(E.Z)}),[]),(0,n.useEffect)((()=>d((e=>{let{User:t}=e;(async e=>{var t;if(null==e||null===(t=e.Keys)||void 0===t||!t.length)return;const r=KeyBackgroundManager_objectSpread(KeyBackgroundManager_objectSpread({},e),{},{Keys:[e.Keys[0]]});(await(0,pt.rB)(r,u.getPassword())).length||u.logout()})(t).catch(E.Z)}))),[]),(0,D.jsx)(D.Fragment,{children:null})};const Mr="cte";let Lr;const getIsSelf=e=>e===Lr;var Rr,app_StorageListener=()=>{const e=(0,ne.Z)();return(0,n.useEffect)((()=>{const cb=t=>{var r;const a=(e=>{if(e.key===Mr&&e.newValue)try{const t=JSON.parse(e.newValue);if(null==t||!t.type)return;return{id:t.id,type:t.type,data:t.data}}catch(e){return}})(t);if(!a)return;const{id:n,type:i,data:o}=a;"password-change"!==i||(null==o?void 0:o.localID)!==(null===(r=e.getLocalID)||void 0===r?void 0:r.call(e))||getIsSelf(n)||e.logout({type:"soft"})};return window.addEventListener("storage",cb),()=>{window.removeEventListener("storage",cb)}}),[]),(0,D.jsx)(D.Fragment,{children:null})};function StandardPrivateApp_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function StandardPrivateApp_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?StandardPrivateApp_ownKeys(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):StandardPrivateApp_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var app_StandardPrivateApp=e=>{let{locales:t={},onLogout:r,onInit:a,fallback:i,preloadModels:o=[],preloadFeatures:s=[],eventModels:c=[],noModals:l=!1,hasPrivateMemberKeyGeneration:u=!1,hasReadableMemberKeyActivation:d=!1,hasMemberKeyMigration:p=!1,app:y,eventQuery:f}=e;const{APP_NAME:g}=(0,de.Z)(),[h,b]=(0,n.useState)(!0),[w,v]=(0,n.useState)(null),P=(0,n.useRef)(),O=(0,ae.Z)(),silentApi=e=>O(StandardPrivateApp_objectSpread(StandardPrivateApp_objectSpread({},e),{},{silence:!0})),k=(0,ar.Z)(),E=(0,n.useRef)(null),K=(0,n.useRef)(!1),_=(0,tr.Z)(),I=hooks_useLoadFeature();if((0,n.useEffect)((()=>{const e=app_loadEventID(silentApi,k).then((e=>{P.current=eventManager_eventManager({api:silentApi,eventID:e,query:f})})),n={api:silentApi,cache:k},i=m.WGw.includes(g),c=I([nr.Pk.EarlyAccessScope,...s]),l=(0,er.Z)([Xt.L,S.T_,...o]);let u,d=!1;const p=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],{api:t,cache:r,useCache:a=!0}=arguments.length>1?arguments[1]:void 0;const n=await Promise.all(e.map((e=>a&&r.has(e.key)?r.get(e.key).value:e.get(t))));return e.forEach(((e,t)=>{r.set(e.key,{value:n[t],status:j.Q.RESOLVED})})),n}(l,n).then((e=>{const[r,a]=e;k.set(ir.iR,(0,ir.ry)(r)),(0,A.qb)(!!r.CrashReports),(0,qt.Hv)(!!r.Telemetry);const n=m.Mcv.includes(g),o=(0,$t.i5)(a);K.current=n&&!o,d=i&&a.Type===dt.F.EXTERNAL;const s=(0,Jt.Q3)(),l=(0,Jt.vk)(r.Locale,t);return Promise.all([c.then((async e=>{let[t]=e;u=(0,rr.y)({userSettings:r,earlyAccessScope:t,appName:g})})),(0,Qt.H)(l,t),(0,Qt.u)(l,s,r)])})),h=y().then((e=>{E.current=e.default}));return(0,ve.U)(Promise.all([e,p,null==a?void 0:a(),(0,Yt.F)(),h]).catch((e=>{throw(0,ye.KY)(e)&&r(),e}))).then((()=>{u?u():d?_("/setup-internal-address?app=".concat(g),m.eim.PROTONACCOUNT):b(!1)})).catch((e=>{(0,ye.KY)(e)||v({message:(0,ye.iC)(e)||(null==e?void 0:e.message)||(0,$.c)("Error").t(Rr||(Rr=(0,X.Z)(["Unknown error"])))})})),()=>{(0,Yt.z)()}}),[]),w)return(0,D.jsx)(he.Z,{errorMessage:w.message});const T=E.current;return h||!P.current||null===T?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(ge.Z,{}),i||(0,D.jsx)(ie.Z,{})]}):K.current?(0,D.jsx)(app_DelinquentContainer,{}):(0,D.jsx)(eventManager_EventManagerProvider,{eventManager:P.current,children:(0,D.jsx)(calendar_ModelEventManagerProvider,{children:(0,D.jsxs)(contacts_ContactProvider,{children:[(0,D.jsx)(Or,{models:c}),(0,D.jsx)(eventManager_EventNotices,{}),(0,D.jsx)(themes_ThemeInjector,{}),(0,D.jsx)(layouts_DensityInjector,{}),!l&&(0,D.jsx)(ge.Z,{}),(0,D.jsx)(app_KeyBackgroundManager,{hasPrivateMemberKeyGeneration:u,hasReadableMemberKeyActivation:d,hasMemberKeyMigration:p}),(0,D.jsx)(app_StorageListener,{}),(0,D.jsx)(Er,{children:(0,D.jsx)(T,{})})]})})})},Nr=r(77113),Ur=r(42779),Br=r(43860),Fr=r(55022),Gr=r(91626),zr=r(42770),Hr=r(76881);const Vr={key:"PaymentMethods",get:e=>e((0,Hr.CL)()).then((e=>{let{PaymentMethods:t}=e;return t})),update:(e,t)=>(0,hr.Z)({model:e,events:t,item:e=>{let{PaymentMethod:t}=e;return t}})};var Wr=r(5802);const qr={key:"Imports",get:e=>e((0,Wr.Db)()).then((e=>{let{Importers:t}=e;return t})).catch((()=>[])),update:(e,t)=>(0,hr.Z)({model:e,events:t,item:e=>{let{Importer:t}=e;return t},merge:(e,t)=>t})};function PrivateApp_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function PrivateApp_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?PrivateApp_ownKeys(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PrivateApp_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const getAppContainer=()=>Promise.all([r.e(2416),r.e(8567),r.e(5522),r.e(6442),r.e(9552),r.e(1393)]).then(r.bind(r,97537));var app_PrivateApp=e=>{let{onLogout:t,locales:r}=e;const a=(0,ae.Z)(),silentApi=e=>a(PrivateApp_objectSpread(PrivateApp_objectSpread({},e),{},{silence:!0}));return(0,D.jsx)(app_StandardPrivateApp,{noModals:!0,fallback:!1,onLogout:t,onInit:()=>{(0,Nr.u)(silentApi).catch(E.Z)},locales:r,preloadModels:[S.T_,Xt.L,Ur.G,O.L,Br.N9,fr.i],eventModels:[S.T_,O.L,Fr.E,Gr.L,Br.N9,Xt.L,Ur.G,Ar.H,vr.w,mr.o,fr.i,br,zr.t,wr,Vr,qr],eventQuery:e=>(0,le.v)(e,{ConversationCounts:1,MessageCounts:1}),hasPrivateMemberKeyGeneration:!0,hasReadableMemberKeyActivation:!0,hasMemberKeyMigration:!0,app:getAppContainer})},Yr=r(65760),Jr=r(14826);r(93477);const Qr=(0,Vt.cW)(r(41068));(0,zt.Mf)(Yr),(0,A.ZP)({config:Yr,uid:Gt.getUID(),sessionTracking:(0,o.W)()}),(0,Ht.Ey)((0,Ht.P_)(Yr)),"chrome"in window&&(0,Jr.S0)();var app_App=()=>{const[e]=(0,n.useState)((()=>!window.location.pathname.startsWith(pe.Bl)));return(0,D.jsx)(app_ProtonApp,{authentication:Gt,config:Yr,hasInitialAuth:e,children:(0,D.jsxs)(i.rs,{children:[(0,D.jsx)(i.AW,{path:pe.Bl,children:(0,D.jsx)(ie.Z,{})}),(0,D.jsx)(i.AW,{path:"*",children:(0,D.jsx)(app_StandardSetup,{PrivateApp:app_PrivateApp,locales:Qr})})]})})};a.render((0,D.jsx)(app_App,{}),document.querySelector(".app-root"))},80237:function(e,t,r){var a=r(56666),n=r(2784),i=r(51063),o=r(52322);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}const UnderlineButton=(e,t)=>(0,o.jsx)(i.Z,function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({shape:"underline",color:"norm",ref:t},e));t.Z=(0,n.forwardRef)(UnderlineButton)},5509:function(e,t,r){var a=r(56666),n=r(59740),i=r(2784),o=r(75664),s=r(88379),c=r(72881),l=r(52322);const u=["expandByDefault","children"];function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}t.Z=e=>{let{expandByDefault:t=!1,children:r}=e,a=(0,n.Z)(e,u);const[d,p]=(0,i.useState)(t),[y,m]=i.Children.toArray(r),f=(0,s.D)("collapsible"),g={isExpanded:d,toggle:()=>{p((e=>!e))},headerId:(0,s.D)("collapsible"),contentId:f};return(0,l.jsx)(c.Z.Provider,{value:g,children:(0,l.jsxs)(o.x,_objectSpread(_objectSpread({as:"div"},a),{},{children:[y,m]}))})}},80474:function(e,t,r){var a=r(56666),n=r(2784),i=r(75664),o=r(72881),s=r(52322);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}t.Z=e=>{const{isExpanded:t,contentId:r,headerId:a}=(0,n.useContext)(o.Z);return(0,s.jsx)(i.x,_objectSpread(_objectSpread({as:"div"},e),{},{id:r,role:"region","aria-labelledby":a,hidden:!t,"aria-hidden":!t,"data-testid":"collapsible-content"}))}},72881:function(e,t,r){const a=(0,r(2784).createContext)({});t.Z=a},81260:function(e,t,r){r.d(t,{Z:function(){return collapsible_CollapsibleHeader}});var a=r(56666),n=r(59740),i=r(2784),o=r(75664),s=r(89358),c=r(72881),l=r(52322);const u=["suffix","disableFullWidth","disableContainerToggle","className","children","onClick"];function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var collapsible_CollapsibleHeader=e=>{let{suffix:t,disableFullWidth:r,disableContainerToggle:a,className:d,children:p,onClick:y}=e,m=(0,n.Z)(e,u);const{toggle:f,headerId:g}=(0,i.useContext)(c.Z);return(0,l.jsxs)(o.x,_objectSpread(_objectSpread({as:"header"},m),{},{onClick:()=>{a||f(),null==y||y()},className:(0,s.Z)(d,"flex flex-nowrap flex-align-items-center",!a&&"collapsible-header--clickable"),children:[(0,l.jsx)("div",{id:g,className:(0,s.Z)(!r&&"flex-item-fluid"),"data-testid":"collapsible-header",children:p}),t&&(0,l.jsx)("div",{className:"flex flex-item-noshrink ml0-5",children:t})]}))}},10679:function(e,t,r){r.d(t,{Z:function(){return collapsible_CollapsibleHeaderIconButton}});var a,n,i=r(56666),o=r(59740),s=r(89358),c=r(71171),l=r(2784),u=r(1208),d=r(51063),p=r(7043),y=r(72881),m=r(52322);const f=["expandText","collapseText","children","onClick"];function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var collapsible_CollapsibleHeaderButton=e=>{let{expandText:t=(0,u.c)("Collapsible tooltip").t(a||(a=(0,c.Z)(["Expand"]))),collapseText:r=(0,u.c)("Collapsible tooltip").t(n||(n=(0,c.Z)(["Collapse"]))),children:i,onClick:s}=e,g=(0,o.Z)(e,f);const{isExpanded:h,toggle:b,headerId:w,contentId:v}=(0,l.useContext)(y.Z),A=h?r:t;return(0,m.jsx)(p.Z,{title:A,children:(0,m.jsxs)(d.Z,_objectSpread(_objectSpread({},g),{},{"aria-expanded":h,"aria-describedby":w,"aria-controls":v,onClick:e=>{e.stopPropagation(),e.preventDefault(),b(),null==s||s(e)},children:[i,(0,m.jsx)("span",{className:"sr-only",children:A})]}))})};const g=["children","className"];function CollapsibleHeaderIconButton_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function CollapsibleHeaderIconButton_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?CollapsibleHeaderIconButton_ownKeys(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CollapsibleHeaderIconButton_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var collapsible_CollapsibleHeaderIconButton=e=>{let{children:t,className:r}=e,a=(0,o.Z)(e,g);return(0,m.jsx)(collapsible_CollapsibleHeaderButton,CollapsibleHeaderIconButton_objectSpread(CollapsibleHeaderIconButton_objectSpread({className:(0,s.Z)("collapsible-header-icon-button",r),shape:"ghost",color:"weak"},a),{},{icon:!0,children:t}))}},87052:function(e,t,r){var a=r(56666),n=r(59740),i=r(2784),o=r(41991),s=r(86638),c=r(52322);const l=["children","id","className","onChange","disabled","shape","color","loading"];function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const FileInput=(e,t)=>{let{children:r,id:a="fileInput",className:u,onChange:d,disabled:p,shape:y,color:m,loading:f}=e,g=(0,n.Z)(e,l);const h=(0,i.useRef)(null),b=(0,o.Z)(h,t);return(0,c.jsxs)(s.Z,{as:"label",htmlFor:a,className:u,disabled:p,shape:y,color:m,loading:f,children:[(0,c.jsx)("input",_objectSpread(_objectSpread({id:a,type:"file",className:"sr-only",onChange:e=>{d(e),h.current&&(h.current.value="")}},g),{},{ref:b})),r]})};t.Z=(0,i.forwardRef)(FileInput)},70199:function(e,t,r){var a,n=r(56666),i=r(71171),o=r(59740),s=r(2784),c=r(1208),l=r(70606),u=r(88379),d=r(42287),p=r(61432),y=r(87403),m=r(82015),f=r(60182),g=r(52322);const h=["originalPlacement","url","title","buttonClass","buttonTabIndex","className","questionMark","colorPrimary"];function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}t.Z=e=>{let{originalPlacement:t="top",url:r,title:n,buttonClass:b="inline-flex color-inherit",buttonTabIndex:w,className:v="",questionMark:A=!1,colorPrimary:P=!0}=e,O=(0,o.Z)(e,h);const[j]=(0,s.useState)((0,u.D)("tooltip")),[S]=(0,l.Z)(),k=t.includes("right")?t.replace("right","left"):t.replace("left","right"),[E,K]=(0,s.useState)(null),{anchorRef:D,open:_,close:I,isOpen:T}=(0,p.Z)(),{position:C,placement:Z}=(0,y.Z)({popperEl:E,anchorEl:null==D?void 0:D.current,isOpen:T,originalPlacement:S?k:t}),x=(0,f.Z)(_,I,T),M=n||"";return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("button",_objectSpread(_objectSpread({tabIndex:w,className:b,onClick:e=>{e.preventDefault(),r&&window.open(r)},ref:D},x),{},{"aria-describedby":j,type:"button",role:r?"link":void 0,children:(0,g.jsx)(d.Z,_objectSpread({className:(0,u.dh)(["icon-16p",P&&"color-primary",v]),name:A?"question-circle":"info-circle",alt:(0,c.c)("Action").t(a||(a=(0,i.Z)(["More info: ",""])),M)},O))})),n&&T?(0,g.jsx)(m.Z,{divRef:K,id:j,isOpen:T,style:C,className:(0,u.dh)(["tooltip","tooltip--".concat(Z)]),children:n}):null]})}},20635:function(e,t,r){var a=r(2784),n=r(4517),i=r(34489),o=r(1350),s=r(29295),c=r(69880);const safeOpenNewTab=e=>{const t=window.open();t&&(t.location.href=e)};t.Z=()=>{const{APP_NAME:e}=(0,s.Z)(),t=(0,c.Z)(),r=(0,n.k6)();return(0,a.useCallback)(((a,n,s)=>{if(n&&n!==e){if(o.VVb){var c;const e=null===(c=t.getLocalID)||void 0===c?void 0:c.call(t),r=(0,i.fw)(a,n,e);return s?safeOpenNewTab(r):document.location.assign(r)}if(e===o.eim.PROTONVPN_SETTINGS){const e=(0,i.fw)(a,n);return safeOpenNewTab(e)}if(o.U02)return;return document.location.assign((0,i.YB)(a,n))}return r.push(a)}),[t])}},72551:function(e,t,r){r.d(t,{T:function(){return o}});var a=r(2784),n=r(24955),i=r(52322);const o=(0,a.createContext)({addSpotlight:n.Z});t.Z=e=>{let{children:t}=e;const[r,n]=(0,a.useState)();return(0,i.jsx)(o.Provider,{value:{spotlight:r,addSpotlight:e=>{n((t=>t||e))}},children:t})}},87101:function(e,t,r){var a=r(56666),n=r(59740),i=r(2784),o=r(41991),s=r(88379),c=r(13984),l=r(52322);const u=["error","className","onValue","disableChange","rows","minRows","autoGrow"];function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const TextAreaTwo=(e,t)=>{const r=(0,i.useRef)(null),{error:a,className:d,onValue:p,disableChange:y,rows:m=5,minRows:f=1,autoGrow:g=!1}=e,h=(0,n.Z)(e,u),b=(0,s.dh)([d,"w100 textarea",Boolean(a)&&"error"]),{rows:w,updateTextArea:v}=(0,c.Z)({maxRows:m,minRows:f,autoGrow:g});return(0,i.useEffect)((()=>{r.current&&(null==v||v(r.current))}),[v]),(0,l.jsx)("textarea",_objectSpread(_objectSpread({"aria-invalid":!!a},h),{},{ref:(0,o.Z)(r,t),onChange:e=>{var t;y||(null==p||p(e.target.value),null===(t=h.onChange)||void 0===t||t.call(h,e),null==v||v(r.current))},rows:w,className:b}))};t.Z=(0,i.forwardRef)(TextAreaTwo)},75001:function(e,t,r){var a=r(2784);t.Z=(0,a.createContext)(new Map)},256:function(e,t,r){r.d(t,{$n:function(){return v},Ai:function(){return p},Ak:function(){return A},Bl:function(){return d},Ck:function(){return b},Ee:function(){return getTimeUnitLabels},QY:function(){return w},Ut:function(){return y},gi:function(){return h},mR:function(){return f},oq:function(){return g},pk:function(){return m}});var a,n,i,o,s=r(71171),c=r(1208),l=r(1350),u=r(78599);const d="/oauth/callback",p=["email","openid"],y=["https://mail.google.com/"],m=["https://www.googleapis.com/auth/gmail.readonly"],f=["https://www.googleapis.com/auth/contacts.readonly"],g=["https://www.googleapis.com/auth/calendar.readonly"],h=/\/easy-switch/,b=Object.values(u.W4),getTimeUnitLabels=()=>({[u.L.BIG_BANG]:(0,c.c)("Label").t(a||(a=(0,s.Z)(["Import all messages"]))),[u.L.LAST_YEAR]:(0,c.c)("Label").t(n||(n=(0,s.Z)(["Last 12 months only"]))),[u.L.LAST_3_MONTHS]:(0,c.c)("Label").t(i||(i=(0,s.Z)(["Last 3 months only"]))),[u.L.LAST_MONTH]:(0,c.c)("Label").t(o||(o=(0,s.Z)(["Last month only"])))}),w=2e4,v={[u.h3.GOOGLE]:"imap.gmail.com",[u.us.YAHOO]:"imap.mail.yahoo.com",[u.us.OUTLOOK]:"outlook.office365.com"},A=(u.h3.GOOGLE,u.us.YAHOO,u.us.OUTLOOK,u.us.YAHOO,"".concat(l.TaG,"@yahoo.com"),u.us.OUTLOOK,"".concat(l.TaG,"@outlook.com"),u.us.DEFAULT,l.cS4,"###TO_BE_CREATED###")},6440:function(e,t){t.Z=(e,t)=>{var r;return(null==e||null===(r=e.Keys)||void 0===r?void 0:r.some((e=>!e.Active)))||(null==t?void 0:t.some((e=>{var t;return null===(t=e.Keys)||void 0===t?void 0:t.some((e=>!e.Active))})))}},86601:function(e,t,r){r.d(t,{Z:function(){return support_BugModal}});var a=r(56666),n=r(71171),i=r(2784),o=r(4517),s=r(1208),c=r(63995),l=r(1350),u=r(4221),d=r(76096),p=r(51964),y=r(24955),m=r(24242),f=r(96336),g=r(42145),h=r(58216),b=r(90598),w=r(3335),v=r(1568),A=r(39682),P=r(71427),O=r(87101),j=r(5509),S=r(81260),k=r(10679),E=r(42287),K=r(80474),D=r(18716),_=r(51063),I=r(55097);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const getArtificialOSName=e=>{if(navigator.maxTouchPoints>1)return"Mac OS"===e?"iOS":"Linux"===e?"Android":void 0},getReportInfo=()=>{const e=(0,I.qs)(),t=(0,I._v)(),r=(()=>{const e=(0,I.Ij)(),t=getArtificialOSName(e.name);return t?{name:t,version:"",artificial:!0}:_objectSpread(_objectSpread({},e),{},{artificial:!1})})();return{OS:r.name,OSVersion:r.version||"",OSArtificial:r.artificial,Browser:e.name,BrowserVersion:e.version,Resolution:"".concat(window.innerHeight," x ").concat(window.innerWidth),DeviceName:t.vendor,DeviceModel:t.model}};var T=r(48130),C=r(29295),Z=r(53780),x=r(34458);var M,L,R,N,utils_removeIndex=(e,t)=>e.filter(((e,r)=>r!==t)),U=r(70199),B=r(87052),F=r(40849),G=r(52249),z=r(4398),H=r(94246),V=r(52322);var W,q,Y,J,Q,X,$,ee,te,re,ae,ne,ie,oe,se,ce,le,ue,de,pe,ye,me,fe,ge,he,be,we,ve,Ae,Pe,Oe,je,Se,ke,Ee,Ke,De,_e,Ie,Te,Ce,Ze,xe,Me,Le,Re,Ne,Ue,Be,Fe,Ge,ze,He,support_AttachScreenshot=e=>{let{id:t,screenshots:r,setScreenshots:a,uploading:i,setUploading:o,disabled:c}=e;const{createNotification:u}=(0,Z.Z)();return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)("label",{className:"text-semibold block",htmlFor:t,children:[(0,V.jsx)("span",{className:"mr0-5 align-middle",children:(0,s.c)("Label").t(L||(L=(0,n.Z)(["Attach screenshot(s)"])))}),(0,V.jsx)(U.Z,{url:(0,p.Jn)("/screenshot-reporting-bugs")})]}),(0,V.jsx)("div",{children:(0,V.jsx)(B.Z,{multiple:!0,accept:"image/bmp, image/apng, image/png, image/jpeg, image/gif, image/tiff, image/webp",id:t,onChange:async e=>{let{target:t}=e;o(!0);try{const e=t.files?[...t.files].filter((e=>{let{type:t}=e;return/^image\//i.test(t)})):[];if(!e.length)return u({type:"error",text:(0,s.c)("Error notification in the bug report modal when the user upload file").t(M||(M=(0,n.Z)(["No image selected"])))});const r=await Promise.all(e.map((e=>(0,x.SI)(e,l.MR_).then((t=>({name:e.name,blob:(0,x.SE)(t)}))))));a(r)}finally{o(!1)}},disabled:i||c,loading:i,color:"norm",shape:"underline",children:(0,s.c)("Action").t(R||(R=(0,n.Z)(["Attach screenshot(s)"])))})}),r.length>0&&(0,V.jsx)(F.Z,{className:"simple-table--has-actions",children:(0,V.jsx)(G.Z,{children:r.map((e=>(0,V.jsxs)(z.Z,{children:[(0,V.jsx)(H.Z,{children:(0,V.jsx)("div",{className:"text-ellipsis",title:e.name,children:e.name},1)}),(0,V.jsx)(H.Z,{className:"w4e",children:(0,V.jsx)(_.Z,{icon:!0,color:"weak",shape:"outline",onClick:()=>(e=>{const t=r.indexOf(e);-1!==t&&a((e=>utils_removeIndex(e,t)))})(e),children:(0,V.jsx)(E.Z,{name:"trash",alt:(0,s.c)("Label").t(N||(N=(0,n.Z)(["Delete"])))})})})]},e.name)))})})]})};function BugModal_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function BugModal_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?BugModal_ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BugModal_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var support_BugModal=e=>{let{username:t="",email:r,mode:a,open:I,onClose:x,onExit:M}=e;const L=(0,T.Z)(),R=(0,o.TH)(),[N,U]=(0,i.useState)(!1),B=N?y.Z:x,{APP_VERSION:F,CLIENT_TYPE:G,APP_NAME:z}=(0,C.Z)(),H=z===l.eim.PROTONVPN_SETTINGS,Ve=z===l.eim.PROTONDRIVE,We=H?"https://protonvpn.com/support/clear-browser-cache-cookies/":(0,p.Jn)("/how-to-clean-cache-and-cookies"),qe=(Ye=z,"Web ".concat(l.mNm[Ye].bareName));var Ye;const Je=!Ve,{createNotification:Qe}=(0,Z.Z)(),Xe=[{type:"label",value:(0,s.c)("Group").t(W||(W=(0,n.Z)(["Account"])))},{type:"option",value:"Sign in problem",title:(0,s.c)("Bug category").t(q||(q=(0,n.Z)(["Sign in problem"])))},{type:"option",value:"Sign up problem",title:(0,s.c)("Bug category").t(Y||(Y=(0,n.Z)(["Sign up problem"])))},{type:"option",value:"Payments problem",title:(0,s.c)("Bug category").t(J||(J=(0,n.Z)(["Payments problem"])))},{type:"option",value:"Custom domain problem",title:(0,s.c)("Bug category").t(Q||(Q=(0,n.Z)(["Custom domain problem"])))},{type:"label",value:(0,s.c)("Group").t(X||(X=(0,n.Z)(["Apps"])))},{type:"option",value:"Bridge problem",title:(0,s.c)("Bug category").t($||($=(0,n.Z)(["Bridge problem"])))},{type:"option",value:"Import / export problem",title:(0,s.c)("Bug category").t(ee||(ee=(0,n.Z)(["Import / export problem"])))},{type:"label",value:(0,s.c)("Group").t(te||(te=(0,n.Z)(["Network"])))},{type:"option",value:"Connection problem",title:(0,s.c)("Bug category").t(re||(re=(0,n.Z)(["Connection problem"])))},{type:"option",value:"Slow speed problem",title:(0,s.c)("Bug category").t(ae||(ae=(0,n.Z)(["Slow speed problem"])))},{type:"label",value:(0,s.c)("Group").t(ne||(ne=(0,n.Z)(["Services"])))},{type:"option",value:"Calendar problem",title:(0,s.c)("Bug category").t(ie||(ie=(0,n.Z)(["Calendar problem"])))},{type:"option",value:"Contacts problem",title:(0,s.c)("Bug category").t(oe||(oe=(0,n.Z)(["Contacts problem"])))},{type:"option",value:"Drive problem",title:(0,s.c)("Bug category").t(se||(se=(0,n.Z)(["Drive problem"])))},{type:"option",value:"Mail problem",title:(0,s.c)("Bug category").t(ce||(ce=(0,n.Z)(["Mail problem"])))},{type:"option",value:"VPN problem",title:(0,s.c)("Bug category").t(le||(le=(0,n.Z)(["VPN problem"])))},{type:"label",value:(0,s.c)("Group").t(ue||(ue=(0,n.Z)(["Other category"])))},{type:"option",value:"Feature request",title:(0,s.c)("Bug category").t(de||(de=(0,n.Z)(["Feature request"])))},{type:"option",value:"Other",title:(0,s.c)("Bug category").t(pe||(pe=(0,n.Z)(["Other"])))}],$e=[{type:"option",value:"Login problem",title:(0,s.c)("Bug category").t(ye||(ye=(0,n.Z)(["Sign in problem"])))},{type:"option",value:"Signup problem",title:(0,s.c)("Bug category").t(me||(me=(0,n.Z)(["Signup problem"])))},{type:"option",value:"Payments problem",title:(0,s.c)("Bug category").t(fe||(fe=(0,n.Z)(["Payments problem"])))},{type:"option",value:"Installation problem",title:(0,s.c)("Bug category").t(ge||(ge=(0,n.Z)(["Installation problem"])))},{type:"option",value:"Update problem",title:(0,s.c)("Bug category").t(he||(he=(0,n.Z)(["Update problem"])))},{type:"option",value:"Application problem",title:(0,s.c)("Bug category").t(be||(be=(0,n.Z)(["Application problem"])))},{type:"option",value:"Connection problem",title:(0,s.c)("Bug category").t(we||(we=(0,n.Z)(["Connection problem"])))},{type:"option",value:"Speed problem",title:(0,s.c)("Bug category").t(ve||(ve=(0,n.Z)(["Speed problem"])))},{type:"option",value:"Manual setup problem",title:(0,s.c)("Bug category").t(Ae||(Ae=(0,n.Z)(["Manual setup problem"])))},{type:"option",value:"Website access problem",title:(0,s.c)("Bug category").t(Pe||(Pe=(0,n.Z)(["Website access problem"])))},{type:"option",value:"Streaming problem",title:(0,s.c)("Bug category").t(Oe||(Oe=(0,n.Z)(["Streaming problem"])))},{type:"option",value:"Feature request",title:(0,s.c)("Bug category").t(je||(je=(0,n.Z)(["Feature request"])))}],et=(H?$e:Xe).map((e=>{const{type:t,value:r}=e;if("label"===t)return(0,V.jsx)("label",{className:"text-semibold px0-5 py0-25 block",children:r},r);const{title:a}=e;return(0,V.jsx)(m.Z,{title:a,value:r},r)})),[tt,rt]=(0,i.useState)((()=>BugModal_objectSpread(BugModal_objectSpread({},getReportInfo()),{},{Title:"",Description:"",Email:r||"",Username:t||""}))),[at,nt]=(0,i.useState)([]),[it,ot]=(0,i.useState)(!1),st=(0,V.jsx)(f.Z,{url:We,children:(0,s.c)("Link").t(Se||(Se=(0,n.Z)(["clearing your browser cache"])))},"linkClearCache"),{validator:ct,onFormSubmit:lt}=(0,g.Z)(),handleChange=e=>t=>rt(BugModal_objectSpread(BugModal_objectSpread({},tt),{},{[e]:t}));(0,i.useEffect)((()=>{!tt.Email&&r&&rt(BugModal_objectSpread(BugModal_objectSpread({},tt),{},{Email:r}))}),[r]);const ut=(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(h.ZP,{id:"OS",label:(0,s.c)("Label").t(Ee||(Ee=(0,n.Z)(["Operating system"]))),value:tt.OS,onValue:handleChange("OS"),disabled:N}),(0,V.jsx)(h.ZP,{id:"OSVersion",label:(0,s.c)("Label").t(Ke||(Ke=(0,n.Z)(["Operating system version"]))),value:tt.OSVersion,onValue:handleChange("OSVersion"),disabled:N})]}),dt="chat-unavailable"===a?(0,V.jsx)("p",{children:(0,s.c)("Warning").t(De||(De=(0,n.Z)(["Live chat is a premium feature available only to those with paid "," plans. Please open a ticket instead."])),l.Dx3)}):"chat-no-agents"===a?(0,V.jsx)("p",{children:(0,s.c)("Warning").t(_e||(_e=(0,n.Z)(["Unfortunately, we’re not online at the moment. Please complete the form below to describe your issue, and we will look into it and be in touch when we’re back online."])))}):(0,V.jsx)(V.Fragment,{children:(0,V.jsxs)("p",{children:[(0,s.c)("Info").jt(Ie||(Ie=(0,n.Z)(["Refreshing the page or "," will automatically resolve most issues."])),st),(0,V.jsx)("br",{}),(0,V.jsx)("br",{}),(0,s.c)("Warning").t(Te||(Te=(0,n.Z)(["Reports are not end-to-end encrypted, please do not send any sensitive information."])))]})});return(0,V.jsxs)(b.Z,{as:w.Z,open:I,onClose:B,onExit:M,onSubmit:async()=>{if(!lt())return;U(!0);try{await L((0,c.Ry)((()=>{const e=at.reduce(((e,t)=>{let{name:r,blob:a}=t;return e[r]=a,e}),{}),t=[!H&&"[V5]","[".concat(qe,"] Bug [").concat(R.pathname,"]"),tt.Title].filter(Boolean).join(" ");return BugModal_objectSpread(BugModal_objectSpread(BugModal_objectSpread({},e),(0,d.CE)(tt,["OSArtificial"])),{},{Client:qe,ClientVersion:F,ClientType:G,Title:t})})(),"form")),null==x||x(),Qe({text:(0,s.c)("Success").t(ke||(ke=(0,n.Z)(["Bug reported"])))})}catch(e){U(!1)}},children:[(0,V.jsx)(v.Z,{title:(0,s.c)("Title").t(Ce||(Ce=(0,n.Z)(["Report a problem"])))}),(0,V.jsxs)(A.Z,{children:[dt,t?null:(0,V.jsx)(h.ZP,{autoFocus:!0,id:"Username",label:(0,s.c)("Label").t(Ze||(Ze=(0,n.Z)(["Proton username"]))),value:tt.Username,onValue:handleChange("Username"),disabled:N}),(0,V.jsx)(h.ZP,{id:"Email",label:(0,s.c)("Label").t(xe||(xe=(0,n.Z)(["Email address"]))),placeholder:(0,s.c)("Placeholder").t(Me||(Me=(0,n.Z)(["A way to contact you"]))),value:tt.Email,onValue:handleChange("Email"),error:ct([(0,u.np)(tt.Email)]),disabled:N}),Je&&(0,V.jsx)(h.ZP,{as:P.Z,label:(0,s.c)("Label").t(Le||(Le=(0,n.Z)(["Category"]))),placeholder:(0,s.c)("Placeholder").t(Re||(Re=(0,n.Z)(["Select"]))),id:"Title",value:tt.Title,onValue:handleChange("Title"),error:ct([(0,u.np)(tt.Title)]),disabled:N,children:et}),(0,V.jsx)(h.ZP,{as:O.Z,id:"Description",label:(0,s.c)("Label").t(Ne||(Ne=(0,n.Z)(["What happened?"]))),placeholder:(0,s.c)("Placeholder").t(Ue||(Ue=(0,n.Z)(["Please describe the problem and include any error messages"]))),value:tt.Description,onValue:handleChange("Description"),error:ct([(0,u.np)(tt.Description)]),rows:5,disabled:N}),(0,V.jsx)(support_AttachScreenshot,{id:"Attachments",screenshots:at,setScreenshots:nt,uploading:it,setUploading:ot,disabled:N}),tt.OSArtificial&&ut,(0,V.jsxs)(j.Z,{className:"mt1",children:[(0,V.jsx)(S.Z,{disableFullWidth:!0,suffix:(0,V.jsx)(k.Z,{size:"small",children:(0,V.jsx)(E.Z,{name:"chevron-down"})}),children:(0,V.jsx)("label",{className:"text-semibold",children:(0,s.c)("Label").t(Be||(Be=(0,n.Z)(["System information"])))})}),(0,V.jsxs)(K.Z,{className:"mt1",children:[!tt.OSArtificial&&ut,(0,V.jsx)(h.ZP,{id:"Browser",label:(0,s.c)("Label").t(Fe||(Fe=(0,n.Z)(["Browser"]))),value:tt.Browser,onValue:handleChange("Browser"),disabled:N}),(0,V.jsx)(h.ZP,{id:"BrowserVersion",label:(0,s.c)("Label").t(Ge||(Ge=(0,n.Z)(["Browser version"]))),value:tt.BrowserVersion,onValue:handleChange("BrowserVersion"),disabled:N})]})]})]}),(0,V.jsxs)(D.Z,{children:[(0,V.jsx)(_.Z,{onClick:B,disabled:N,children:(0,s.c)("Action").t(ze||(ze=(0,n.Z)(["Cancel"])))}),(0,V.jsx)(_.Z,{loading:N,disabled:it,type:"submit",color:"norm",children:(0,s.c)("Action").t(He||(He=(0,n.Z)(["Submit"])))})]})]})}},13984:function(e,t,r){var a=r(2784);t.Z=e=>{let{maxRows:t=5,minRows:r=1,autoGrow:n=!1}=e;const[i,o]=(0,a.useState)(r),s=(0,a.useCallback)((e=>{o((e=>{let{el:t,minRows:r,maxRows:a}=e;const n=+getComputedStyle(t).lineHeight.replace("px",""),i=t.rows;t.rows=r;const o=Math.min(a,Math.max(r,~~(t.scrollHeight/n)));return o===i&&(t.rows=o),o})({el:e,minRows:r,maxRows:t}))}),[r,t]);return n?{rows:i,updateTextArea:s}:{rows:t}}},41234:function(e,t,r){var a,n=r(71171),i=r(2784),o=r(1208),s=r(23588),c=r(29711),l=r(53780);const u=["InactiveSession","AppVersionBadError","OfflineError"];t.Z=()=>{const{createNotification:e}=(0,l.Z)();return(0,i.useCallback)((function(t){let{notify:r=!0,trace:i=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const l=(0,s.iC)(t),d=t.message||(0,o.c)("Error").t(a||(a=(0,n.Z)(["Unknown error"]))),p=r&&!t.cancel&&!u.includes(t.name)&&!(0,s.Ui)(t);p&&e({type:"error",text:l||d});const y=i&&!l;y&&(0,c.hI)(t)}),[])}},34528:function(e,t,r){r.d(t,{$:function(){return useGetOrganization},o:function(){return useOrganization}});var a=r(2784),n=r(1350),i=r(52528),o=r(48130),s=r(83517),c=r(22994),l=r(57297);const useGetOrganization=()=>{const e=(0,o.Z)(),t=(0,s.Z)(),r=(0,l.pg)(),u=(0,a.useCallback)((async()=>(await r()).isPaid?i.w.get(e):Promise.resolve(n.y2I)),[e,t]);return(0,a.useCallback)((()=>(0,c.NC)(t,i.w.key,u)),[t,u])},useOrganization=()=>{const e=(0,s.Z)(),t=useGetOrganization();return(0,c.ZP)(e,i.w.key,t)}},21182:function(e,t,r){r.d(t,{AC:function(){return SideAppUrlProvider},ZP:function(){return useSideApp}});var a=r(56666),n=r(2784),i=r(27959),o=r(57964),s=r(34489),c=r(2979),l=r(74009),u=r(1350),d=r(31608),p=r(64220),y=r(60332),m=r(30416),f=r(69880),g=r(48130),h=r(57297),b=r(26805),w=r(29295),v=r(52322);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const A=(0,n.createContext)({});function useSideApp(){const{sideAppUrl:e,setSideAppUrl:t,sideAppOpenedUrls:r,parentApp:a,showSideApp:i,setShowSideApp:o,currentlyOpenedApp:c}=(0,n.useContext)(A)||{sideAppUrl:void 0,setSideAppUrl:void 0,sideAppOpenedUrls:void 0,parentApp:void 0,showSideApp:void 0,setShowSideApp:void 0,currentlyOpenedApp:void 0},{offline:u}=(0,b.Z)(),d=(0,m.Z)(),f=!u&&d,g=window.self!==window.top;return{sideAppUrl:e,setSideAppUrl:t,handleClickSideApp:function(a){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/";return()=>{var o;if(!(0,p.BB)(a))return;const u=(0,l.rM)(window.location.pathname),d=(null==r||null===(o=r.find((e=>e.app===a)))||void 0===o?void 0:o.url)||(0,s.fw)(n,a,u),m=void 0!==e&&c!==a&&f;e===d&&i?(0,p.fm)({type:y.d.SIDE_APP_CLOSE_FROM_OUTSIDE},a):m?(0,p.fm)({type:y.d.SIDE_APP_SWITCH_FROM_OUTSIDE,payload:{nextUrl:d}},a):f&&(null==t||t(d))}},parentApp:a,isSideApp:!!a&&g,showSideApp:i,setShowSideApp:o}}const SideAppUrlProvider=e=>{let{children:t}=e;const{APP_NAME:r}=(0,w.Z)(),[a,s]=(0,n.useState)(),[l,m]=(0,n.useState)(!1),[b,P]=(0,n.useState)([]),{getUID:O,getPersistent:j,getPassword:S,getTrusted:k}=(0,f.Z)(),E=(0,g.Z)(),K=(0,h.pg)(),[D,_]=(0,n.useState)(),[I,T]=(0,n.useState)([]),C=a?(0,c._G)(new URL(a).hostname):void 0,handleSetSideAppUrl=(e,t)=>{const n=(0,p.IB)(e||"",r,t),i=(0,c._G)(new URL(n).hostname);C===i&&!l||n===a||s(n),m(!0)},updateOpenedUrls=(e,t)=>{e&&t&&P([...b.filter((e=>e.app===t)),{app:t,url:e}])},removeAbortController=e=>{T((t=>t.filter((t=>t.id===e))))},Z=(0,n.useCallback)((async e=>{var t;const r=e.origin;if((0,p.C)(r))switch(e.data.type){case y.d.SIDE_APP_CLOSE:if(e.data.payload){const{url:t,app:r}=e.data.payload;updateOpenedUrls(t,r),e.data.payload.closeDefinitely&&s(void 0)}m(!1);break;case y.d.SIDE_APP_SWITCH:{const{url:t,app:r,nextUrl:a}=e.data.payload;updateOpenedUrls(t,r),handleSetSideAppUrl(a)}break;case y.d.SIDE_APP_READY:{const e=(0,c._G)(new URL(a||"").hostname);if(e){const t=await K();(0,p.fm)({type:y.d.SIDE_APP_SESSION,payload:{UID:O(),keyPassword:S(),persistent:j(),trusted:k(),User:t,tag:i.No}},e)}}break;case y.d.SIDE_APP_API_REQUEST:{const t=(0,c._G)(new URL(a||"").hostname),{arg:r,id:n,hasAbortController:i}=e.data.payload;if(t)try{let e=r;if(i){const t=new AbortController;T((e=>[...e,{id:n,abortController:t}])),e=_objectSpread(_objectSpread({},r),{},{signal:t.signal})}const a=await E(e);i&&removeAbortController(n),(0,p.fm)({type:y.d.SIDE_APP_API_RESPONSE,payload:{id:n,success:!0,data:a,serverTime:(0,o.u)()}},t)}catch(e){i&&removeAbortController(n);const r=e instanceof d.MS;(0,p.fm)({type:y.d.SIDE_APP_API_RESPONSE,payload:{id:n,success:!1,isApiError:r,data:r?(0,d.iv)(e):e,serverTime:(0,o.u)()}},t)}}break;case y.d.SIDE_APP_ABORT_REQUEST:const{id:r}=e.data.payload,n=null===(t=I.find((e=>e.id===r)))||void 0===t?void 0:t.abortController;n&&(n.abort(),removeAbortController(r))}}),[a]);(0,n.useEffect)((()=>(window.addEventListener("message",Z),()=>{window.removeEventListener("message",Z)})),[a]);const x=(0,n.useRef)(0);return(0,n.useEffect)((()=>{if(!l&&C){const e=Date.now()+3*u.x42;x.current=window.setInterval((()=>{Date.now()>e&&(0,p.fm)({type:y.d.SIDE_APP_CLOSE_FROM_OUTSIDE,payload:{closeDefinitely:!0}},C)}),5*u.EBY)}return()=>{x.current&&clearInterval(x.current)}}),[l,C]),(0,v.jsx)(A.Provider,{value:{sideAppUrl:a,setSideAppUrl:handleSetSideAppUrl,sideAppOpenedUrls:b,parentApp:D,setParentApp:_,showSideApp:l,setShowSideApp:m,currentlyOpenedApp:C},children:t})}},63889:function(e,t,r){r.d(t,{E:function(){return getMatchingSigningKey},y:function(){return toPublicKeyReference}});var a=r(28391);async function getMatchingSigningKey(e){const{binarySignature:t,armoredSignature:r,keys:n}=e,{signingKeyIDs:i}=t?await a.g.getSignatureInfo({binarySignature:t}):await a.g.getSignatureInfo({armoredSignature:r});for(const e of i){const t=n.find((t=>t.getKeyIDs().indexOf(e)>=0));if(t)return t}}async function toPublicKeyReference(e){return a.g.importPublicKey({binaryKey:await a.g.exportPublicKey({key:e,format:"binary"})})}},42637:function(e,t,r){r.d(t,{$K:function(){return getAllCalendarKeys},BQ:function(){return getVtimezones},CA:function(){return reactivateCalendarKey},CE:function(){return getPassphrases},EY:function(){return getEvent},Fo:function(){return queryMembers},Hx:function(){return updatePersonalEventPart},OV:function(){return setupCalendar},Ul:function(){return syncMultipleEvents},YR:function(){return createCalendar},nA:function(){return updateAttendeePartstat},oo:function(){return getCalendarUserSettings},rU:function(){return updateCalendarUserSettings},uw:function(){return queryLatestModelEventID},vO:function(){return getFullCalendar},vV:function(){return queryModelEvents},vW:function(){return upgradeP2PInvite},vh:function(){return getAllowedTimeZones},vz:function(){return removeCalendar},xd:function(){return getEventByUID},yJ:function(){return queryCalendars}});const a="calendar/v1",queryLatestModelEventID=e=>({url:"".concat(a,"/").concat(e,"/modelevents/latest"),method:"get"}),queryModelEvents=(e,t)=>({url:"".concat(a,"/").concat(e,"/modelevents/").concat(t),method:"get"}),queryCalendars=()=>({url:"".concat(a),method:"get"}),createCalendar=e=>({url:"".concat(a),method:"post",data:e}),setupCalendar=(e,t)=>({url:"".concat(a,"/").concat(e,"/keys"),method:"post",data:t}),getFullCalendar=e=>({url:"".concat(a,"/").concat(e,"/bootstrap"),method:"get"}),getAllCalendarKeys=e=>({url:"".concat(a,"/").concat(e,"/keys/all"),method:"get"}),getPassphrases=e=>({url:"".concat(a,"/").concat(e,"/passphrases"),method:"get"}),reactivateCalendarKey=(e,t,r)=>({url:"".concat(a,"/").concat(e,"/keys/").concat(t),method:"put",data:r}),removeCalendar=e=>({url:"".concat(a,"/").concat(e),method:"delete"}),queryMembers=(e,t)=>({url:"".concat(a,"/").concat(e,"/members"),method:"get",params:t}),getEvent=(e,t)=>({url:"".concat(a,"/").concat(e,"/events/").concat(t),method:"get"}),getEventByUID=e=>({url:"".concat(a,"/events"),method:"get",params:e}),updatePersonalEventPart=(e,t,r)=>({url:"".concat(a,"/").concat(e,"/events/").concat(t,"/personal"),method:"put",data:r}),updateAttendeePartstat=(e,t,r,n)=>({url:"".concat(a,"/").concat(e,"/events/").concat(t,"/attendees/").concat(r),method:"put",data:n}),upgradeP2PInvite=(e,t,r)=>({url:"".concat(a,"/").concat(e,"/events/").concat(t,"/upgrade"),method:"put",data:r}),getCalendarUserSettings=()=>({url:"settings/calendar",method:"get"}),updateCalendarUserSettings=e=>({url:"settings/calendar",method:"put",data:e}),getAllowedTimeZones=()=>({url:"".concat(a,"/timezones"),method:"get"}),getVtimezones=e=>({url:"".concat(a,"/vtimezones?").concat(e.map((e=>"Timezones[]=".concat(e))).join("&")),method:"get"}),syncMultipleEvents=(e,t)=>({url:"".concat(a,"/").concat(e,"/events/sync"),method:"put",data:t})},5802:function(e,t,r){r.d(t,{CJ:function(){return getMailImportData},Db:function(){return getImportsList},V3:function(){return createToken},VJ:function(){return getContactsImportData},b2:function(){return getImportReportsList},iW:function(){return getCalendarImportData},mt:function(){return startImportTask},sj:function(){return createImport}});const createToken=e=>({url:"importer/v1/tokens",method:"post",data:e}),createImport=e=>({url:"importer/v1/importers",method:"post",data:e}),startImportTask=e=>({url:"importer/v1/importers/start",method:"post",data:e}),getImportsList=()=>({url:"importer/v1/importers",method:"get"}),getImportReportsList=()=>({url:"importer/v1/reports",method:"get"}),getMailImportData=(e,t)=>({url:"importer/v1/mail/importers/".concat(e),method:"get",params:t}),getCalendarImportData=e=>({url:"importer/v1/calendar/importers/".concat(e),method:"get"}),getContactsImportData=e=>({url:"importer/v1/contacts/importers/".concat(e),method:"get"})},94593:function(e,t,r){r.d(t,{O:function(){return applyFilters},a8:function(){return updateFilter},kh:function(){return deleteFilter},sI:function(){return addTreeFilter},vP:function(){return queryFilters}});const addTreeFilter=(e,t)=>{let{ID:r,Name:a,Status:n,Version:i,Simple:o,Tree:s,Sieve:c}=e;return{method:"post",url:"mail/v4/filters",data:{ID:r,Name:a,Status:n,Version:i,Simple:o,Tree:s,Sieve:c},params:{Source:t}}},queryFilters=()=>({method:"get",url:"mail/v4/filters"}),updateFilter=(e,t)=>{let{Name:r,Status:a,Version:n,Sieve:i,Simple:o,Tree:s}=t;return{method:"put",url:"mail/v4/filters/".concat(e),data:{Name:r,Status:a,Version:n,Simple:o,Tree:s,Sieve:i}}},deleteFilter=e=>({method:"delete",url:"mail/v4/filters/".concat(e)}),applyFilters=function(e){let{AllowList:t=0,BlockList:r=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{method:"post",url:"mail/v4/messages/apply-filters",data:{AllFilters:0,FilterIDs:e,AllowList:t,BlockList:r}}}},35804:function(e,t,r){r.d(t,{Bg:function(){return reactivateKeyRoute},Cj:function(){return activateKeyRouteV2},En:function(){return reactiveLegacyAddressKeyRouteV2},KZ:function(){return getPublicKeys},Nl:function(){return setupKeys},RR:function(){return createAddressKeyRouteV2},SH:function(){return createAddressKeyRoute},Z9:function(){return getKeySalts},lL:function(){return migrateAddressKeysRoute},vb:function(){return activateKeyRoute},xd:function(){return upgradeKeysRoute},yI:function(){return reactivateUserKeyRouteV2}});var a=r(59740);const n=["ID"],i=["ID"],o=["ID"],s=["ID"],getPublicKeys=e=>({url:"keys",method:"get",params:e}),getKeySalts=()=>({url:"keys/salts",method:"get"}),createAddressKeyRoute=e=>({url:"keys",method:"post",data:e}),createAddressKeyRouteV2=e=>({url:"keys/address",method:"post",data:e}),setupKeys=e=>({url:"keys/setup",method:"post",data:e}),activateKeyRoute=e=>{let{ID:t}=e,r=(0,a.Z)(e,n);return{url:"keys/".concat(t,"/activate"),method:"put",data:r}},activateKeyRouteV2=e=>{let{ID:t}=e,r=(0,a.Z)(e,i);return{url:"keys/address/".concat(t),method:"put",data:r}},reactiveLegacyAddressKeyRouteV2=e=>{let{ID:t}=e,r=(0,a.Z)(e,o);return{url:"keys/address/".concat(t),method:"put",data:r}},reactivateKeyRoute=e=>{let{ID:t,PrivateKey:r,SignedKeyList:a}=e;return{url:"keys/".concat(t),method:"put",data:{PrivateKey:r,SignedKeyList:a}}},reactivateUserKeyRouteV2=e=>{let{ID:t}=e,r=(0,a.Z)(e,s);return{url:"keys/user/".concat(t),method:"put",data:r}},upgradeKeysRoute=e=>({url:"keys/private/upgrade",method:"post",data:e}),migrateAddressKeysRoute=e=>({url:"keys/migrate",method:"post",data:e})},83959:function(e,t,r){r.d(t,{HW:function(){return getContactGroup},R7:function(){return createContactGroup},Ue:function(){return create},bd:function(){return deleteLabels},dQ:function(){return checkLabelAvailability},g7:function(){return getLabels},rK:function(){return updateLabel},xh:function(){return getFolders}});var a=r(56666),n=r(1350);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const{MESSAGE_LABEL:i,MESSAGE_FOLDER:o,CONTACT_GROUP:s}=n.L7k,get=e=>({url:"v4/labels",method:"get",params:{Type:e}}),create=e=>{let{Name:t,Color:r,Type:a,Notify:n,ParentID:i,Expanded:o}=e;return{method:"post",url:"v4/labels",data:{Name:t,Color:r,Type:a,Notify:n,ParentID:i,Expanded:o}}},updateLabel=(e,t)=>{let{Name:r,Color:a,Notify:n,ParentID:i,Sticky:o,Expanded:s}=t;return{method:"put",url:"v4/labels/".concat(e),data:{Name:r,Color:a,Notify:n,ParentID:i,Sticky:o,Expanded:s}}},deleteLabels=e=>({method:"delete",url:"v4/labels",data:{LabelIDs:e}}),checkLabelAvailability=e=>({method:"get",url:"v4/labels/available",params:e}),getLabels=()=>get(i),getFolders=()=>get(o),getContactGroup=()=>get(s),createContactGroup=e=>create(_objectSpread(_objectSpread({},e),{},{Type:s}))},3587:function(e,t,r){r.d(t,{L:function(){return getMember},TL:function(){return getAllMemberAddresses},Ux:function(){return getAllMembers}});var a=r(56666),n=r(88468);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const getAllMembers=e=>(0,n.Z)(((t,r)=>e({method:"get",url:"members",params:_objectSpread(_objectSpread({},{Page:t,PageSize:r}),{},{IncludeAddresses:1})}))).then((e=>e.flatMap((e=>{let{Members:t}=e;return t})))),getMember=e=>({method:"get",url:"members/".concat(e)}),getAllMemberAddresses=(e,t)=>(0,n.Z)(((r,a)=>e(((e,t)=>({method:"get",url:"members/".concat(e,"/addresses"),params:t}))(t,{Page:r,PageSize:a})))).then((e=>e.flatMap((e=>{let{Addresses:t=[]}=e;return t}))))},67136:function(e,t,r){r.d(t,{Gu:function(){return getOrganizationKeys},Xu:function(){return getOrganization}});const getOrganization=()=>({url:"organizations",method:"get"}),getOrganizationKeys=()=>({url:"organizations/keys",method:"get"})},76881:function(e,t,r){r.d(t,{CL:function(){return queryPaymentMethods},P3:function(){return getLastCancelledSubscription},Q:function(){return queryPlans},bM:function(){return checkSubscription},pI:function(){return getSubscription}});const getSubscription=()=>({url:"payments/subscription",method:"get"}),checkSubscription=e=>({url:"payments/subscription/check",method:"post",data:e}),queryPlans=e=>({url:"payments/plans",method:"get",params:e}),queryPaymentMethods=()=>({url:"payments/methods",method:"get"}),getLastCancelledSubscription=()=>({url:"payments/subscription/latest",method:"get"})},63995:function(e,t,r){r.d(t,{Ry:function(){return reportBug},_j:function(){return reportPhishing}});const reportBug=(e,t)=>({method:"post",url:"reports/bug",input:t,data:e}),reportPhishing=e=>{let{MessageID:t,MIMEType:r,Body:a}=e;return{method:"post",url:"reports/phishing",data:{MessageID:t,MIMEType:r,Body:a}}}},78918:function(e,t,r){r.d(t,{P5:function(){return InvalidForkConsumeError},fm:function(){return InvalidPersistentSessionError}});class InvalidPersistentSessionError extends Error{constructor(e){super(["Invalid persistent session",e].filter(Boolean).join(":")),Object.setPrototypeOf(this,InvalidPersistentSessionError.prototype)}}Error;class InvalidForkConsumeError extends Error{constructor(e){super(["Invalid fork consumption",e].filter(Boolean).join(":")),Object.setPrototypeOf(this,InvalidForkConsumeError.prototype)}}},83161:function(e,t,r){r.d(t,{En:function(){return persistSession},WL:function(){return maybeResumeSessionByUser},aZ:function(){return resumeSession}});var a=r(27959),n=r(92925),i=r(43825),o=r(23588),s=r(10252),c=r(90495),l=r(2979),u=r(1350),d=r(57209),p=r(39300),y=r(64220),m=r(60332),f=r(61882),g=r(78918),h=r(42370);const resumeSession=async(e,t,r)=>{const n=await(e=>{let t,resolve=()=>{};const r=new Promise((e=>{resolve=e})),n=window.self!==window.top,i=(0,l.ku)(window.location.pathname),handler=r=>{if(r.data.type===m.d.SIDE_APP_SESSION){const{UID:n,keyPassword:i,User:o,persistent:s,trusted:c,tag:l}=r.data.payload;window.removeEventListener("message",handler),t&&clearTimeout(t),l&&a.No!==l&&((0,a.v2)(l,void 0),window.location.reload()),resolve({UID:n,keyPassword:i,User:o,persistent:s,trusted:c,LocalID:e})}};return i&&(0,y.BB)(i)&&n?((0,y.xt)({type:m.d.SIDE_APP_READY},i),window.addEventListener("message",handler),t=setTimeout((()=>{resolve(void 0)}),u.sh2)):resolve(void 0),r})(t);if(n)return n;const b=(0,h.SH)(t);if(!b)throw new g.fm("Missing persisted session or UID");const{UID:w,UserID:v,blob:A,persistent:P,trusted:O}=b;if(A)try{const[a,n]=await Promise.all([e((0,d.cK)(w,(0,i._M)())).then((e=>{let{ClientKey:t}=e;return t})),r||e((0,d.cK)(w,(0,c.PR)())).then((e=>{let{User:t}=e;return t}))]),o=(0,p.bh)(a),l=await(0,f.km)(o),{keyPassword:u}=await(0,h.m$)(l,A);if(v!==n.ID)throw(0,s.g1)();return{UID:w,LocalID:t,keyPassword:u,User:n,persistent:P,trusted:O}}catch(e){if((0,o.KY)(e))throw(0,h.EN)(t,w),new g.fm("Session invalid");if(e instanceof g.fm)throw(0,h.EN)(t,w),e;throw e}try{const{User:r}=await e((0,d.cK)(w,(0,c.PR)()));if(v!==r.ID)throw(0,s.g1)();return{UID:w,LocalID:t,User:r,persistent:P,trusted:O}}catch(e){if((0,o.KY)(e))throw(0,h.EN)(t,w),new g.fm("Session invalid");throw e}},persistSession=async e=>{let{api:t,keyPassword:r,User:a,UID:o,LocalID:s,AccessToken:c,RefreshToken:l,persistent:y,trusted:m}=e;const authApi=e=>t((0,d.yi)(o,c,e));u.VVb&&(r?await(async e=>{let{api:t,keyPassword:r,User:a,UID:n,LocalID:o,persistent:s,trusted:c}=e;const l=crypto.getRandomValues(new Uint8Array(32)),u=await(0,f.km)(l),d=(0,p.oG)(l);await t((0,i.Df)(d)),await(0,h.eu)(o,u,{UID:n,UserID:a.ID,keyPassword:r,isSubUser:!!a.OrganizationPrivateKey,persistent:s,trusted:c})})({api:authApi,UID:o,User:a,LocalID:s,keyPassword:r,persistent:y,trusted:m}):(0,h.Y)(s,{UID:o,UserID:a.ID,persistent:y,trusted:m})),await authApi((0,i.lE)({UID:o,RefreshToken:l,State:(0,n.Z)(24),Persistent:y}))},getActiveSessionByUserID=(e,t)=>(0,h.xd)().find((r=>{const a=r.UserID===e,n=r.isSubUser===t;return a&&n})),maybeResumeSessionByUser=async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!!t.OrganizationPrivateKey;const a=getActiveSessionByUserID(t.ID,r);if(a)try{return await resumeSession(e,a.localID,t)}catch(e){if(!(e instanceof g.fm))throw e}}},42370:function(e,t,r){r.d(t,{EN:function(){return removePersistedSession},SH:function(){return getPersistedSession},Y:function(){return setPersistedSession},eu:function(){return setPersistedSessionWithBlob},m$:function(){return getDecryptedPersistedSessionBlob},xd:function(){return getPersistedSessions}});var a=r(56666),n=r(38795),i=r(81813),o=r(11696),s=r(78918),c=r(74555),l=r(46440);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const u="ps-",getKey=e=>"".concat(u).concat(e),getPersistedSession=e=>{const t=(0,o.rV)(getKey(e));if(t)try{const e=JSON.parse(t);return{UserID:e.UserID||"",UID:e.UID||"",blob:e.blob||"",isSubUser:e.isSubUser||!1,persistent:"boolean"!=typeof e.persistent||e.persistent,trusted:e.trusted||!1}}catch(e){return}},removePersistedSession=(e,t)=>{const r=getPersistedSession(e);null!=r&&r.UID&&(0,i.Hd)(r.UID),null!=r&&r.UID&&t!==r.UID||(0,o.cl)(getKey(e))},getPersistedSessions=()=>Object.keys(localStorage).filter((e=>e.startsWith(u))).map((e=>{const t=(0,l.v0)(e.slice(u.length));if(void 0===t)return;const r=getPersistedSession(t);return r?_objectSpread(_objectSpread({},r),{},{localID:t}):void 0})).filter(n.Z),getDecryptedPersistedSessionBlob=async(e,t)=>{const r=(e=>{try{return{keyPassword:JSON.parse(e).keyPassword||""}}catch(e){return}})(await(0,c.o)(e,t).catch((()=>{throw new s.fm("Failed to decrypt persisted blob")})));if(!r)throw new s.fm("Failed to parse persisted blob");return r},setPersistedSessionWithBlob=async(e,t,r)=>{const a={UserID:r.UserID,UID:r.UID,isSubUser:r.isSubUser,blob:await(0,c.D)(t,JSON.stringify({keyPassword:r.keyPassword})),persistent:r.persistent,trusted:r.trusted};(0,o.LS)(getKey(e),JSON.stringify(a))},setPersistedSession=(e,t)=>{const r={UserID:t.UserID,UID:t.UID,isSubUser:!1,persistent:t.persistent,trusted:t.trusted};(0,o.LS)(getKey(e),JSON.stringify(r))}},74555:function(e,t,r){r.d(t,{D:function(){return getEncryptedBlob},o:function(){return getDecryptedBlob}});var a=r(39300),n=r(61882);const getEncryptedBlob=async(e,t)=>{const r=await(0,n.q6)(e,(0,a.sy)(t));return(0,a.oG)(r)},getDecryptedBlob=async(e,t)=>{const r=await(0,n.ow)(e,(0,a.bh)(t));return(0,a.DA)(r)}},47963:function(e,t,r){r.d(t,{Mm:function(){return consumeFork},LI:function(){return getConsumeForkParameters},TV:function(){return removeHashParameters},nT:function(){return requestFork}});var a=r(56666),n=r(43825),i=r(90495),o=r(34489),s=r(1350),c=r(57209),l=r(55097),u=r(39300),d=r(70106),p=r(61882),y=r(78918),m=r(83161),f=r(74555);var g=r(46440);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const requestFork=(e,t,r)=>{const a=(0,u.I0)((0,u.DA)(crypto.getRandomValues(new Uint8Array(32)))),n=new URLSearchParams;n.append("app",e),n.append("state",a),void 0!==t&&n.append("u","".concat(t)),void 0!==r&&n.append("t",r);const i={url:r===d.c.SWITCH?(0,o.fw)("/",e):window.location.href};return sessionStorage.setItem("f".concat(a),JSON.stringify(i)),(0,l.mj)((0,o.fw)("".concat(s.J7O.AUTHORIZE,"?").concat(n.toString()),s.eim.PROTONACCOUNT))},getConsumeForkParameters=()=>{const e=new URLSearchParams(window.location.hash.slice(1)),t=e.get("selector")||"",r=e.get("state")||"",a=e.get("sk")||"",n=e.get("t")||"",i=e.get("p")||"",o=e.get("tr")||"";return{state:r.slice(0,100),selector:t,key:a.length?(0,g.E6)(a):void 0,type:(0,g.fO)(n),persistent:"1"===i,trusted:"1"===o}},removeHashParameters=()=>{window.location.hash=""},consumeFork=async e=>{let{selector:t,api:r,state:a,key:o,persistent:s,trusted:l}=e;const u=(e=>{if(e)try{const{url:t}=JSON.parse(e);return{url:t}}catch(e){return}})(sessionStorage.getItem("f".concat(a)));if(!u)throw new y.P5("Missing state ".concat(a));const{url:d}=u;if(!d)throw new y.P5("Missing url");const g=new URL(d),h="".concat(g.pathname).concat(g.search).concat(g.hash),{UID:b,RefreshToken:w,Payload:v,LocalID:A}=await r((0,n.uj)(t));try{return _objectSpread(_objectSpread({},await(0,m.aZ)(r,A)),{},{path:h})}catch(e){if(!(e instanceof y.fm))throw e}let P;if(v)try{const e=await(async(e,t)=>{const r=await(0,f.o)(e,t);return{keyPassword:JSON.parse(r).keyPassword||""}})(await(0,p.km)(o),v);P=null==e?void 0:e.keyPassword}catch(e){throw new y.P5("Failed to decrypt payload")}const{AccessToken:O,RefreshToken:j}=await r((0,c.cK)(b,(0,n.XK)({RefreshToken:w}))),S={User:await r((0,c.yi)(b,O,(0,i.PR)())).then((e=>{let{User:t}=e;return t})),UID:b,LocalID:A,keyPassword:P,persistent:s,trusted:l,AccessToken:O,RefreshToken:j};return await(0,m.En)(_objectSpread({api:r},S)),_objectSpread(_objectSpread({},S),{},{path:h})}},77113:function(e,t,r){r.d(t,{Tx:function(){return convertUTCDateTimeToZone},OC:function(){return convertZonedDateTimeToUTC},Ze:function(){return formatTimezoneOffset},Dn:function(){return fromUTCDate},yJ:function(){return getSupportedTimezone},EP:function(){return getTimezone},pQ:function(){return getTimezoneOffset},u:function(){return loadAllowedTimeZones},Bx:function(){return toLocalDate},uq:function(){return toUTCDate}});var a=r(56666),n=r(61795),i=r(42637),o=r(38795);const s=["Africa/Abidjan","Africa/Accra","Africa/Nairobi","Africa/Algiers","Africa/Lagos","Africa/Bissau","Africa/Maputo","Africa/Cairo","Africa/Casablanca","Africa/Ceuta","Africa/El_Aaiun","Africa/Johannesburg","Africa/Juba","Africa/Khartoum","Africa/Monrovia","Africa/Ndjamena","Africa/Sao_Tome","Africa/Tripoli","Africa/Tunis","Africa/Windhoek","America/Adak","America/Anchorage","America/Port_of_Spain","America/Araguaina","America/Argentina/Buenos_Aires","America/Argentina/Catamarca","America/Argentina/Cordoba","America/Argentina/Jujuy","America/Argentina/La_Rioja","America/Argentina/Mendoza","America/Argentina/Rio_Gallegos","America/Argentina/Salta","America/Argentina/San_Juan","America/Argentina/San_Luis","America/Argentina/Tucuman","America/Argentina/Ushuaia","America/Curacao","America/Asuncion","America/Atikokan","America/Bahia_Banderas","America/Bahia","America/Barbados","America/Belem","America/Belize","America/Blanc-Sablon","America/Boa_Vista","America/Bogota","America/Boise","America/Cambridge_Bay","America/Campo_Grande","America/Cancun","America/Caracas","America/Cayenne","America/Panama","America/Chicago","America/Chihuahua","America/Costa_Rica","America/Creston","America/Cuiaba","America/Danmarkshavn","America/Dawson_Creek","America/Dawson","America/Denver","America/Detroit","America/Edmonton","America/Eirunepe","America/El_Salvador","America/Tijuana","America/Fort_Nelson","America/Fortaleza","America/Glace_Bay","America/Goose_Bay","America/Grand_Turk","America/Guatemala","America/Guayaquil","America/Guyana","America/Halifax","America/Havana","America/Hermosillo","America/Indiana/Knox","America/Indiana/Marengo","America/Indiana/Petersburg","America/Indiana/Tell_City","America/Indiana/Vevay","America/Indiana/Vincennes","America/Indiana/Winamac","America/Inuvik","America/Iqaluit","America/Jamaica","America/Juneau","America/Kentucky/Louisville","America/Kentucky/Monticello","America/La_Paz","America/Lima","America/Los_Angeles","America/Maceio","America/Managua","America/Manaus","America/Martinique","America/Matamoros","America/Mazatlan","America/Menominee","America/Merida","America/Metlakatla","America/Mexico_City","America/Miquelon","America/Moncton","America/Monterrey","America/Montevideo","America/Toronto","America/Nassau","America/New_York","America/Nipigon","America/Nome","America/Noronha","America/North_Dakota/Beulah","America/North_Dakota/Center","America/North_Dakota/New_Salem","America/Ojinaga","America/Pangnirtung","America/Paramaribo","America/Phoenix","America/Port-au-Prince","America/Rio_Branco","America/Porto_Velho","America/Puerto_Rico","America/Punta_Arenas","America/Rainy_River","America/Rankin_Inlet","America/Recife","America/Regina","America/Resolute","America/Santarem","America/Santiago","America/Santo_Domingo","America/Sao_Paulo","America/Scoresbysund","America/Sitka","America/St_Johns","America/Swift_Current","America/Tegucigalpa","America/Thule","America/Thunder_Bay","America/Vancouver","America/Whitehorse","America/Winnipeg","America/Yakutat","America/Yellowknife","Antarctica/Casey","Antarctica/Davis","Antarctica/DumontDUrville","Antarctica/Macquarie","Antarctica/Mawson","Pacific/Auckland","Antarctica/Palmer","Antarctica/Rothera","Antarctica/Syowa","Antarctica/Troll","Antarctica/Vostok","Europe/Oslo","Asia/Riyadh","Asia/Almaty","Asia/Amman","Asia/Anadyr","Asia/Aqtau","Asia/Aqtobe","Asia/Ashgabat","Asia/Atyrau","Asia/Baghdad","Asia/Qatar","Asia/Baku","Asia/Bangkok","Asia/Barnaul","Asia/Beirut","Asia/Bishkek","Asia/Brunei","Asia/Kolkata","Asia/Chita","Asia/Choibalsan","Asia/Shanghai","Asia/Colombo","Asia/Dhaka","Asia/Damascus","Asia/Dili","Asia/Dubai","Asia/Dushanbe","Asia/Famagusta","Asia/Gaza","Asia/Hebron","Asia/Ho_Chi_Minh","Asia/Hong_Kong","Asia/Hovd","Asia/Irkutsk","Europe/Istanbul","Asia/Jakarta","Asia/Jayapura","Asia/Jerusalem","Asia/Kabul","Asia/Kamchatka","Asia/Karachi","Asia/Urumqi","Asia/Kathmandu","Asia/Khandyga","Asia/Krasnoyarsk","Asia/Kuala_Lumpur","Asia/Kuching","Asia/Macau","Asia/Magadan","Asia/Makassar","Asia/Manila","Asia/Nicosia","Asia/Novokuznetsk","Asia/Novosibirsk","Asia/Omsk","Asia/Oral","Asia/Pontianak","Asia/Pyongyang","Asia/Qostanay","Asia/Qyzylorda","Asia/Sakhalin","Asia/Samarkand","Asia/Seoul","Asia/Srednekolymsk","Asia/Taipei","Asia/Tashkent","Asia/Tbilisi","Asia/Tehran","Asia/Thimphu","Asia/Tokyo","Asia/Tomsk","Asia/Ulaanbaatar","Asia/Ust-Nera","Asia/Vladivostok","Asia/Yakutsk","Asia/Yekaterinburg","Asia/Yerevan","Atlantic/Azores","Atlantic/Bermuda","Atlantic/Canary","Atlantic/Cape_Verde","Atlantic/Faroe","Atlantic/Madeira","Atlantic/Reykjavik","Atlantic/South_Georgia","Atlantic/Stanley","Australia/Sydney","Australia/Adelaide","Australia/Brisbane","Australia/Broken_Hill","Australia/Currie","Australia/Darwin","Australia/Eucla","Australia/Hobart","Australia/Lord_Howe","Australia/Lindeman","Australia/Melbourne","Australia/Perth","Pacific/Easter","Europe/Dublin","Pacific/Port_Moresby","Pacific/Tarawa","Indian/Christmas","Pacific/Palau","Europe/Amsterdam","Europe/Andorra","Europe/Astrakhan","Europe/Athens","Europe/London","Europe/Belgrade","Europe/Berlin","Europe/Prague","Europe/Brussels","Europe/Bucharest","Europe/Budapest","Europe/Zurich","Europe/Chisinau","Europe/Copenhagen","Europe/Gibraltar","Europe/Helsinki","Europe/Kaliningrad","Europe/Kiev","Europe/Kirov","Europe/Lisbon","Europe/Luxembourg","Europe/Madrid","Europe/Malta","Europe/Minsk","Europe/Monaco","Europe/Moscow","Europe/Paris","Europe/Riga","Europe/Rome","Europe/Samara","Europe/Saratov","Europe/Simferopol","Europe/Sofia","Europe/Stockholm","Europe/Tallinn","Europe/Tirane","Europe/Ulyanovsk","Europe/Uzhgorod","Europe/Vienna","Europe/Vilnius","Europe/Volgograd","Europe/Warsaw","Europe/Zaporozhye","Indian/Chagos","Indian/Cocos","Indian/Kerguelen","Indian/Mahe","Indian/Maldives","Indian/Mauritius","Indian/Reunion","Pacific/Kwajalein","Pacific/Chatham","Pacific/Apia","Pacific/Bougainville","Pacific/Chuuk","Pacific/Efate","Pacific/Enderbury","Pacific/Fakaofo","Pacific/Fiji","Pacific/Galapagos","Pacific/Gambier","Pacific/Guadalcanal","Pacific/Guam","Pacific/Honolulu","Pacific/Kiritimati","Pacific/Kosrae","Pacific/Majuro","Pacific/Marquesas","Pacific/Pago_Pago","Pacific/Nauru","Pacific/Niue","Pacific/Norfolk","Pacific/Noumea","Pacific/Pitcairn","Pacific/Pohnpei","Pacific/Rarotonga","Pacific/Tahiti","Pacific/Tongatapu","UTC"],c={"America/Indiana/Indianapolis":"America/New_York","America/Fort_Wayne":"America/New_York","America/Godthab":"Atlantic/Stanley","Asia/Singapore":"Asia/Shanghai","Asia/Rangoon":"Indian/Cocos","Asia/Yangon":"Indian/Cocos","Pacific/Funafuti":"Asia/Kamchatka","Pacific/Wake":"Asia/Kamchatka","Pacific/Wallis":"Asia/Kamchatka",CET:"Europe/Paris",CST6CDT:"America/Chicago",EET:"Europe/Istanbul",EST:"America/New_York",EST5EDT:"America/New_York","Etc/GMT+1":"Atlantic/Cape_Verde","Etc/GMT+10":"Pacific/Tahiti","Etc/GMT+11":"Pacific/Niue","Etc/GMT+12":"Pacific/Niue","Etc/GMT+2":"America/Noronha","Etc/GMT+3":"America/Sao_Paulo","Etc/GMT+4":"America/Caracas","Etc/GMT+5":"America/Lima","Etc/GMT+6":"America/Managua","Etc/GMT+7":"America/Phoenix","Etc/GMT+8":"Pacific/Pitcairn","Etc/GMT+9":"Pacific/Gambier","Etc/GMT-0":"UTC","Etc/GMT-1":"Europe/Paris","Etc/GMT-10":"Australia/Brisbane","Etc/GMT-11":"Australia/Sydney","Etc/GMT-12":"Pacific/Auckland","Etc/GMT-13":"Pacific/Fakaofo","Etc/GMT-14":"Pacific/Kiritimati","Etc/GMT-2":"Africa/Cairo","Etc/GMT-3":"Asia/Baghdad","Etc/GMT-4":"Asia/Dubai","Etc/GMT-5":"Asia/Tashkent","Etc/GMT-6":"Asia/Dhaka","Etc/GMT-7":"Asia/Jakarta","Etc/GMT-8":"Asia/Shanghai","Etc/GMT-9":"Asia/Tokyo","Etc/UTC":"UTC",HST:"Pacific/Honolulu",MET:"Europe/Paris",MST:"Europe/Paris",MST7MDT:"America/Denver",PST8PDT:"America/Los_Angeles",WET:"Europe/Lisbon"},l={"abu dhabi, muscat":"Asia/Muscat",acre:"America/Rio_Branco","adelaide, central australia":"Australia/Adelaide",afghanistan:"Asia/Kabul","afghanistan standard time":"Asia/Kabul","africa central":"Africa/Maputo","africa eastern":"Africa/Nairobi","africa farwestern":"Africa/El_Aaiun","africa southern":"Africa/Johannesburg","africa western":"Africa/Lagos",aktyubinsk:"Asia/Aqtobe",alaska:"America/Anchorage","alaska hawaii":"America/Anchorage",alaskan:"America/Anchorage","alaskan standard time":"America/Anchorage","aleutian standard time":"America/Adak",almaty:"Asia/Almaty","almaty, novosibirsk, north central asia":"Asia/Almaty","altai standard time":"Asia/Barnaul",amazon:"America/Manaus","america central":"America/Chicago","america eastern":"America/New_York","america mountain":"America/Denver","america pacific":"America/Los_Angeles","america/nuuk":"Atlantic/Stanley","amsterdam, berlin, bern, rome, stockholm, vienna":"Europe/Berlin",anadyr:"Asia/Anadyr",apia:"Pacific/Apia",aqtau:"Asia/Aqtau",aqtobe:"Asia/Aqtobe",arab:"Asia/Kuwait","arab standard time":"Asia/Riyadh","arab, kuwait, riyadh":"Asia/Kuwait",arabian:"Asia/Muscat","arabian standard time":"Asia/Dubai",arabic:"Asia/Baghdad","arabic standard time":"Asia/Baghdad",argentina:"America/Argentina/Buenos_Aires","argentina standard time":"America/Argentina/Buenos_Aires","argentina western":"America/Argentina/San_Luis",arizona:"America/Phoenix",armenia:"Asia/Yerevan",armenian:"Asia/Yerevan","armenian standard time":"Asia/Yerevan",ashkhabad:"Asia/Ashgabat","astana, dhaka":"Asia/Dhaka","astrakhan standard time":"Europe/Astrakhan","athens, istanbul, minsk":"Europe/Athens",atlantic:"America/Halifax","atlantic standard time":"America/Halifax","atlantic time (canada)":"America/Halifax","auckland, wellington":"Pacific/Auckland","aus central":"Australia/Darwin","aus central standard time":"Australia/Darwin","aus central w standard time":"Australia/Eucla","aus eastern":"Australia/Sydney","aus eastern standard time":"Australia/Sydney","australia central":"Australia/Adelaide","australia centralwestern":"Australia/Eucla","australia eastern":"Australia/Sydney","australia western":"Australia/Perth",azerbaijan:"Asia/Baku","azerbaijan standard time":"Asia/Baku",azerbijan:"Asia/Baku",azores:"Atlantic/Azores","azores standard time":"Atlantic/Azores",baghdad:"Asia/Baghdad","bahia standard time":"America/Bahia",baku:"Asia/Baku","baku, tbilisi, yerevan":"Asia/Baku","bangkok, hanoi, jakarta":"Asia/Bangkok",bangladesh:"Asia/Dhaka","bangladesh standard time":"Asia/Dhaka","beijing, chongqing, hong kong sar, urumqi":"Asia/Shanghai","belarus standard time":"Europe/Minsk","belgrade, pozsony, budapest, ljubljana, prague":"Europe/Prague",bering:"America/Adak",bhutan:"Asia/Thimphu","bogota, lima, quito":"America/Bogota",bolivia:"America/La_Paz",borneo:"Asia/Kuching","bougainville standard time":"Pacific/Bougainville",brasilia:"America/Sao_Paulo","brisbane, east australia":"Australia/Brisbane",british:"Europe/London",brunei:"Asia/Brunei","brussels, copenhagen, madrid, paris":"Europe/Paris",bucharest:"Europe/Bucharest","buenos aires":"America/Argentina/Buenos_Aires",cairo:"Africa/Cairo","canada central":"America/Edmonton","canada central standard time":"America/Regina","canberra, melbourne, sydney, hobart (year 2000 only)":"Australia/Sydney","cape verde":"Atlantic/Cape_Verde","cape verde is":"Atlantic/Cape_Verde","cape verde standard time":"Atlantic/Cape_Verde","caracas, la paz":"America/Caracas","casablanca, monrovia":"Africa/Casablanca",casey:"Antarctica/Casey",caucasus:"Asia/Yerevan","caucasus standard time":"Asia/Yerevan","cen australia":"Australia/Adelaide","cen australia standard time":"Australia/Adelaide",central:"America/Chicago","central america":"America/Guatemala","central america standard time":"America/Guatemala","central asia":"Asia/Dhaka","central asia standard time":"Asia/Almaty","central brazilian":"America/Manaus","central brazilian standard time":"America/Cuiaba","central europe":"Europe/Prague","central europe standard time":"Europe/Budapest","central european":"Europe/Sarajevo","central european standard time":"Europe/Warsaw","central pacific":"Asia/Magadan","central pacific standard time":"Pacific/Guadalcanal","central standard time":"America/Chicago","central standard time (mexico)":"America/Mexico_City","central time (us & canada)":"America/Chicago",chamorro:"Pacific/Saipan",chatham:"Pacific/Chatham","chatham islands standard time":"Pacific/Chatham",chile:"America/Santiago",china:"Asia/Shanghai","china standard time":"Asia/Shanghai",choibalsan:"Asia/Choibalsan",christmas:"Indian/Christmas",cocos:"Indian/Cocos",colombia:"America/Bogota",cook:"Pacific/Rarotonga",cuba:"America/Havana","cuba standard time":"America/Havana",dacca:"Asia/Dhaka",darwin:"Australia/Darwin",dateline:"Pacific/Auckland","dateline standard time":"Pacific/Niue",davis:"Antarctica/Davis",dominican:"America/Santo_Domingo",dumontdurville:"Antarctica/DumontDUrville",dushanbe:"Asia/Dushanbe","dutch guiana":"America/Paramaribo","e africa":"Africa/Nairobi","e africa standard time":"Africa/Nairobi","e australia":"Australia/Brisbane","e australia standard time":"Australia/Brisbane","e europe":"Europe/Minsk","e europe standard time":"Europe/Chisinau","e south america":"America/Belem","e south america standard time":"America/Sao_Paulo","east africa, nairobi":"Africa/Nairobi","east timor":"Asia/Dili",easter:"Pacific/Easter","easter island standard time":"Pacific/Easter",eastern:"America/New_York","eastern standard time":"America/New_York","eastern standard time (mexico)":"America/Cancun","eastern time (us & canada)":"America/New_York",ecuador:"America/Guayaquil",egypt:"Africa/Cairo","egypt standard time":"Africa/Cairo",ekaterinburg:"Asia/Yekaterinburg","ekaterinburg standard time":"Asia/Yekaterinburg","eniwetok, kwajalein, dateline time":"Pacific/Kwajalein","europe central":"Europe/Paris","europe eastern":"Europe/Bucharest","europe further eastern":"Europe/Minsk","europe western":"Atlantic/Canary",falkland:"Atlantic/Stanley",fiji:"Pacific/Fiji","fiji islands standard time":"Pacific/Fiji","fiji islands, kamchatka, marshall is":"Pacific/Fiji","fiji standard time":"Pacific/Fiji",fle:"Europe/Helsinki","fle standard time":"Europe/Kiev","french guiana":"America/Cayenne","french southern":"Indian/Kerguelen",frunze:"Asia/Bishkek",galapagos:"Pacific/Galapagos",gambier:"Pacific/Gambier",georgia:"Asia/Tbilisi",georgian:"Asia/Tbilisi","georgian standard time":"Asia/Tbilisi","gilbert islands":"Pacific/Tarawa",gmt:"Europe/London","gmt standard time":"Europe/London","goose bay":"America/Goose_Bay",greenland:"Atlantic/Stanley","greenland central":"America/Scoresbysund","greenland eastern":"America/Scoresbysund","greenland standard time":"Atlantic/Stanley","greenland western":"Atlantic/Stanley",greenwich:"Atlantic/Reykjavik","greenwich mean time; dublin, edinburgh, london":"Europe/London","greenwich mean time: dublin, edinburgh, lisbon, london":"Europe/Lisbon","greenwich standard time":"Atlantic/Reykjavik",gtb:"Europe/Athens","gtb standard time":"Europe/Bucharest",guam:"Pacific/Guam","guam, port moresby":"Pacific/Guam",gulf:"Asia/Dubai",guyana:"America/Guyana","haiti standard time":"America/Port-au-Prince","harare, pretoria":"Africa/Harare",hawaii:"Pacific/Honolulu","hawaii aleutian":"Pacific/Honolulu",hawaiian:"Pacific/Honolulu","hawaiian standard time":"Pacific/Honolulu","helsinki, riga, tallinn":"Europe/Helsinki","hobart, tasmania":"Australia/Hobart","hong kong":"Asia/Hong_Kong",hovd:"Asia/Hovd",india:"Asia/Kolkata","india standard time":"Asia/Kolkata","indian ocean":"Indian/Chagos","indiana (east)":"America/Indiana/Indianapolis",indochina:"Asia/Bangkok","indonesia central":"Asia/Makassar","indonesia eastern":"Asia/Jayapura","indonesia western":"Asia/Jakarta",iran:"Asia/Tehran","iran standard time":"Asia/Tehran",irish:"Europe/Dublin",irkutsk:"Asia/Irkutsk","irkutsk, ulaan bataar":"Asia/Irkutsk","islamabad, karachi, tashkent":"Asia/Karachi",israel:"Asia/Jerusalem","israel standard time":"Asia/Jerusalem","israel, jerusalem standard time":"Asia/Jerusalem",japan:"Asia/Tokyo",jordan:"Asia/Amman","jordan standard time":"Asia/Amman",kabul:"Asia/Kabul","kaliningrad standard time":"Europe/Kaliningrad",kamchatka:"Asia/Kamchatka","kamchatka standard time":"Asia/Kamchatka",karachi:"Asia/Karachi","kathmandu, nepal":"Asia/Kathmandu","kazakhstan eastern":"Asia/Almaty","kazakhstan western":"Asia/Aqtobe",kizilorda:"Asia/Qyzylorda","kolkata, chennai, mumbai, new delhi, india standard time":"Asia/Kolkata",korea:"Asia/Seoul","korea standard time":"Asia/Seoul",kosrae:"Pacific/Kosrae",krasnoyarsk:"Asia/Krasnoyarsk","kuala lumpur, singapore":"Asia/Shanghai",kuybyshev:"Europe/Samara",kwajalein:"Pacific/Kwajalein",kyrgystan:"Asia/Bishkek",lanka:"Asia/Colombo",liberia:"Africa/Monrovia","libya standard time":"Africa/Tripoli","line islands":"Pacific/Kiritimati","line islands standard time":"Pacific/Kiritimati","lord howe":"Australia/Lord_Howe","lord howe standard time":"Australia/Lord_Howe",macau:"Asia/Macau",macquarie:"Antarctica/Macquarie",magadan:"Asia/Magadan","magadan standard time":"Asia/Magadan","magadan, solomon is, new caledonia":"Asia/Magadan","magallanes standard time":"America/Punta_Arenas",malaya:"Asia/Kuala_Lumpur",malaysia:"Asia/Kuching",maldives:"Indian/Maldives",marquesas:"Pacific/Marquesas","marquesas standard time":"Pacific/Marquesas","marshall islands":"Pacific/Majuro",mauritius:"Indian/Mauritius","mauritius standard time":"Indian/Mauritius",mawson:"Antarctica/Mawson",mexico:"America/Mexico_City","mexico city, tegucigalpa":"America/Mexico_City","mexico pacific":"America/Mazatlan","mexico standard time":"America/Mexico_City","mexico standard time 2":"America/Chihuahua","mid-atlantic":"America/Noronha","mid-atlantic standard time":"Atlantic/Cape_Verde","middle east":"Asia/Beirut","middle east standard time":"Asia/Beirut","midway island, samoa":"Pacific/Midway",mongolia:"Asia/Ulaanbaatar",montevideo:"America/Montevideo","montevideo standard time":"America/Montevideo",morocco:"Africa/Casablanca","morocco standard time":"Africa/Casablanca",moscow:"Europe/Moscow","moscow, st petersburg, volgograd":"Europe/Moscow",mountain:"America/Denver","mountain standard time":"America/Denver","mountain standard time (mexico)":"America/Chihuahua","mountain time (us & canada)":"America/Denver",myanmar:"Indian/Cocos","myanmar standard time":"Indian/Cocos","n central asia":"Asia/Almaty","n central asia standard time":"Asia/Novosibirsk",namibia:"Africa/Windhoek","namibia standard time":"Africa/Windhoek",nauru:"Pacific/Nauru",nepal:"Asia/Kathmandu","nepal standard time":"Asia/Kathmandu","new caledonia":"Pacific/Noumea","new zealand":"Pacific/Auckland","new zealand standard time":"Pacific/Auckland",newfoundland:"America/St_Johns","newfoundland and labrador standard time":"America/St_Johns","newfoundland standard time":"America/St_Johns",niue:"Pacific/Niue",norfolk:"Pacific/Norfolk","norfolk standard time":"Pacific/Norfolk",noronha:"America/Noronha","north asia":"Asia/Krasnoyarsk","north asia east":"Asia/Irkutsk","north asia east standard time":"Asia/Irkutsk","north asia standard time":"Asia/Krasnoyarsk","north korea standard time":"Asia/Pyongyang","north mariana":"Pacific/Saipan",novosibirsk:"Asia/Novosibirsk","nuku'alofa, tonga":"Pacific/Tongatapu",omsk:"Asia/Omsk","omsk standard time":"Asia/Omsk",oral:"Asia/Oral","osaka, sapporo, tokyo":"Asia/Tokyo",pacific:"America/Los_Angeles","pacific sa":"America/Santiago","pacific sa standard time":"America/Santiago","pacific standard time":"America/Los_Angeles","pacific standard time (mexico)":"America/Tijuana","pacific time (us & canada)":"America/Los_Angeles","pacific time (us & canada); tijuana":"America/Los_Angeles",pakistan:"Asia/Karachi","pakistan standard time":"Asia/Karachi",palau:"Pacific/Palau","papua new guinea":"Pacific/Port_Moresby",paraguay:"America/Asuncion","paraguay standard time":"America/Asuncion","paris, madrid, brussels, copenhagen":"Europe/Paris","perth, western australia":"Australia/Perth",peru:"America/Lima",philippines:"Asia/Manila","phoenix islands":"Pacific/Enderbury","pierre miquelon":"America/Miquelon",pitcairn:"Pacific/Pitcairn","prague, central europe":"Europe/Prague",pyongyang:"Asia/Pyongyang",qyzylorda:"Asia/Qyzylorda","qyzylorda standard time":"Asia/Qyzylorda",rangoon:"Indian/Cocos",reunion:"Indian/Reunion",romance:"Europe/Paris","romance standard time":"Europe/Paris",rothera:"Antarctica/Rothera","russia time zone 10":"Asia/Srednekolymsk","russia time zone 11":"Asia/Kamchatka","russia time zone 3":"Europe/Samara",russian:"Europe/Moscow","russian standard time":"Europe/Moscow","sa eastern":"America/Belem","sa eastern standard time":"America/Cayenne","sa pacific":"America/Bogota","sa pacific standard time":"America/Bogota","sa western":"America/La_Paz","sa western standard time":"America/La_Paz","saint pierre standard time":"America/Miquelon",sakhalin:"Asia/Sakhalin","sakhalin standard time":"Asia/Sakhalin",samara:"Europe/Samara",samarkand:"Asia/Samarkand",samoa:"Pacific/Apia","samoa standard time":"Pacific/Apia",santiago:"America/Santiago","sao tome standard time":"Africa/Sao_Tome","sarajevo, skopje, sofija, vilnius, warsaw, zagreb":"Europe/Sarajevo","saratov standard time":"Europe/Saratov",saskatchewan:"America/Edmonton","se asia":"Asia/Bangkok","se asia standard time":"Asia/Bangkok","seoul, korea standard time":"Asia/Seoul",seychelles:"Indian/Mahe",shevchenko:"Asia/Aqtau",singapore:"Asia/Shanghai","singapore standard time":"Asia/Shanghai",solomon:"Pacific/Guadalcanal","south africa":"Africa/Harare","south africa standard time":"Africa/Johannesburg","south georgia":"Atlantic/South_Georgia","sri jayawardenepura, sri lanka":"Asia/Colombo","sri lanka":"Asia/Colombo","sri lanka standard time":"Asia/Colombo","sudan standard time":"Africa/Khartoum",suriname:"America/Paramaribo",sverdlovsk:"Asia/Yekaterinburg",syowa:"Antarctica/Syowa","syria standard time":"Asia/Damascus",tahiti:"Pacific/Tahiti",taipei:"Asia/Taipei","taipei standard time":"Asia/Taipei",tajikistan:"Asia/Dushanbe",tashkent:"Asia/Tashkent",tasmania:"Australia/Hobart","tasmania standard time":"Australia/Hobart",tbilisi:"Asia/Tbilisi",tehran:"Asia/Tehran","tocantins standard time":"America/Araguaina",tokelau:"Pacific/Fakaofo",tokyo:"Asia/Tokyo","tokyo standard time":"Asia/Tokyo","tomsk standard time":"Asia/Tomsk",tonga:"Pacific/Tongatapu","tonga standard time":"Pacific/Tongatapu","transbaikal standard time":"Asia/Chita","transitional islamic state of afghanistan standard time":"Asia/Kabul",turkey:"Europe/Istanbul","turkey standard time":"Europe/Istanbul",turkmenistan:"Asia/Ashgabat","turks and caicos standard time":"America/Grand_Turk",tuvalu:"Pacific/Funafuti","ulaanbaatar standard time":"Asia/Ulaanbaatar","universal coordinated time":"UTC",uralsk:"Asia/Oral",uruguay:"America/Montevideo",urumqi:"Asia/Urumqi","us eastern":"America/Indiana/Indianapolis","us eastern standard time":"America/New_York","us mountain":"America/Phoenix","us mountain standard time":"America/Phoenix",utc:"UTC","utc-02":"America/Noronha","utc-08":"Pacific/Pitcairn","utc-09":"Pacific/Gambier","utc-11":"Pacific/Niue","utc+12":"Pacific/Auckland",uzbekistan:"Asia/Tashkent",vanuatu:"Pacific/Efate",venezuela:"America/Caracas","venezuela standard time":"America/Caracas",vladivostok:"Asia/Vladivostok","vladivostok standard time":"Asia/Vladivostok",volgograd:"Europe/Volgograd","volgograd standard time":"Europe/Volgograd",vostok:"Antarctica/Vostok","w australia":"Australia/Perth","w australia standard time":"Australia/Perth","w central africa":"Africa/Lagos","w central africa standard time":"Africa/Lagos","w europe":"Europe/Amsterdam","w europe standard time":"Europe/Berlin","w mongolia standard time":"Asia/Hovd",wake:"Pacific/Wake",wallis:"Pacific/Wallis","west asia":"Asia/Tashkent","west asia standard time":"Asia/Tashkent","west bank standard time":"Asia/Hebron","west central africa":"Africa/Luanda","west pacific":"Pacific/Guam","west pacific standard time":"Pacific/Port_Moresby",yakutsk:"Asia/Yakutsk","yakutsk standard time":"Asia/Yakutsk",yekaterinburg:"Asia/Yekaterinburg",yerevan:"Asia/Yerevan",yukon:"America/Yakutat","coordinated universal time-11":"Pacific/Pago_Pago","aleutian islands":"America/Adak","marquesas islands":"Pacific/Marquesas","coordinated universal time-09":"America/Anchorage","baja california":"America/Tijuana","coordinated universal time-08":"Pacific/Pitcairn","chihuahua, la paz, mazatlan":"America/Chihuahua","easter island":"Pacific/Easter","guadalajara, mexico city, monterrey":"America/Mexico_City","bogota, lima, quito, rio branco":"America/Bogota",chetumal:"America/Cancun",haiti:"America/Port-au-Prince",havana:"America/Havana","turks and caicos":"America/Grand_Turk",asuncion:"America/Asuncion",caracas:"America/Caracas",cuiaba:"America/Cuiaba","georgetown, la paz, manaus, san juan":"America/La_Paz",araguaina:"America/Araguaina","cayenne, fortaleza":"America/Cayenne","city of buenos aires":"America/Argentina/Buenos_Aires","punta arenas":"America/Punta_Arenas","saint pierre and miquelon":"America/Miquelon",salvador:"America/Bahia","coordinated universal time-02":"America/Noronha","mid-atlantic - old":"America/Noronha","cabo verde is":"Atlantic/Cape_Verde","coordinated universal time":"UTC","dublin, edinburgh, lisbon, london":"Europe/London","monrovia, reykjavik":"Atlantic/Reykjavik","belgrade, bratislava, budapest, ljubljana, prague":"Europe/Budapest",casablanca:"Africa/Casablanca","sao tome":"Africa/Sao_Tome","sarajevo, skopje, warsaw, zagreb":"Europe/Warsaw",amman:"Asia/Amman","athens, bucharest":"Europe/Bucharest",beirut:"Asia/Beirut",chisinau:"Europe/Chisinau",damascus:"Asia/Damascus","gaza, hebron":"Asia/Hebron",jerusalem:"Asia/Jerusalem",kaliningrad:"Europe/Kaliningrad",khartoum:"Africa/Khartoum",tripoli:"Africa/Tripoli",windhoek:"Africa/Windhoek",istanbul:"Europe/Istanbul","kuwait, riyadh":"Asia/Riyadh",minsk:"Europe/Minsk","moscow, st petersburg":"Europe/Moscow",nairobi:"Africa/Nairobi","astrakhan, ulyanovsk":"Europe/Astrakhan","izhevsk, samara":"Europe/Samara","port louis":"Indian/Mauritius",saratov:"Europe/Saratov","ashgabat, tashkent":"Asia/Tashkent","islamabad, karachi":"Asia/Karachi","chennai, kolkata, mumbai, new delhi":"Asia/Kolkata","sri jayawardenepura":"Asia/Colombo",kathmandu:"Asia/Kathmandu",astana:"Asia/Almaty",dhaka:"Asia/Dhaka","yangon (rangoon)":"Indian/Cocos","barnaul, gorno-altaysk":"Asia/Barnaul",tomsk:"Asia/Tomsk","beijing, chongqing, hong kong, urumqi":"Asia/Shanghai",perth:"Australia/Perth",ulaanbaatar:"Asia/Ulaanbaatar",eucla:"Australia/Eucla",chita:"Asia/Chita",seoul:"Asia/Seoul",adelaide:"Australia/Adelaide",brisbane:"Australia/Brisbane","canberra, melbourne, sydney":"Australia/Sydney",hobart:"Australia/Hobart","lord howe island":"Australia/Lord_Howe","bougainville island":"Pacific/Bougainville",chokurdakh:"Asia/Srednekolymsk","norfolk island":"Pacific/Norfolk","solomon is, new caledonia":"Pacific/Guadalcanal","anadyr, petropavlovsk-kamchatsky":"Asia/Kamchatka","coordinated universal time+12":"Pacific/Tarawa","petropavlovsk-kamchatsky - old":"Asia/Anadyr","chatham islands":"Pacific/Chatham","coordinated universal time+13":"Pacific/Enderbury","nuku'alofa":"Pacific/Tongatapu","kiritimati island":"Pacific/Kiritimati","helsinki, kyiv, riga, sofia, tallinn, vilnius":"Europe/Helsinki"};function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const toLocalDate=e=>{let{year:t=0,month:r=1,day:a=0,hours:n=0,minutes:i=0,seconds:o=0}=e;return new Date(t,r-1,a,n,i,o)},toUTCDate=e=>{let{year:t=0,month:r=1,day:a=0,hours:n=0,minutes:i=0,seconds:o=0}=e;return new Date(Date.UTC(t,r-1,a,n,i,o))},fromUTCDate=e=>({year:e.getUTCFullYear(),month:e.getUTCMonth()+1,day:e.getUTCDate(),hours:e.getUTCHours(),minutes:e.getUTCMinutes(),seconds:e.getUTCSeconds()});let u=[...s];const loadAllowedTimeZones=async e=>{const{Timezones:t}=await e((0,i.vh)()),r=t.map((e=>{try{return(0,n.yQ)(e),e}catch(t){console.error("".concat(e," not supported"))}})).filter(o.Z);u=r},getTimezone=()=>{const e=(e=>{try{const e=Intl.DateTimeFormat().resolvedOptions().timeZone;return(0,n.yQ)(e).name}catch(t){const r=new Date,a=r.getTimezoneOffset();return e.find((e=>{const{zone:t}=(0,n.iN)(r,(0,n.yQ)(e));return!!t&&t.offset===a}))}})((0,n.iu)());return"Etc/UTC"===e?"UTC":e?(e=>{const t=c[e]||s.find((t=>t===e));if(!t)throw new Error("Unrecognized time zone");return t})(e):u[0]},getTimezoneOffset=(e,t)=>(0,n.u2)(e,(0,n.yQ)(t)),formatTimezoneOffset=e=>{const t=1===Math.sign(e)?"-":"+",r=Math.abs(e%60),a=(Math.abs(e)-r)/60;if(r>0){const e=r<10?"0".concat(r):"".concat(r);return"".concat(t).concat(a,":").concat(e)}return"".concat(t).concat(a)},getSupportedTimezone=e=>{try{const t=(0,n.yQ)(e).name;return c[t]||t}catch(t){const r=/^\((?:UTC|GMT).*\) (.*)$|^(.*) \((?:UTC|GMT).*\)/i.exec(e),a=r?r[1]||r[2]:e,i=a.toLowerCase().replace(/\./g,""),o=l[i];if(o)return o;const s=a.toLowerCase(),c=u.find((e=>s.includes(e.toLowerCase())));if(c)return c;const d=(0,n.g6)(),p=Object.keys(d).sort(((e,t)=>t.length-e.length));for(const e of p)if(s.includes(e.toLowerCase()))return d[e]}},convertZonedDateTimeToUTC=(e,t,r)=>{const a=(0,n.yQ)(t),i=Date.UTC(e.year,e.month-1,e.day,e.hours,e.minutes,e.seconds||0),o=(e=>{let{unixTime:t,untils:r,offsets:a,moveAmbiguousForward:n=!0,moveInvalidForward:i=!0}=e;const o=r.length-1;for(let e=0;e<o;e++){const o=a[e+1],s=a[e?e-1:e];let c=a[e];if(c<o&&n?c=o:c>s&&i&&(c=s),t<r[e]-6e4*c)return e}return o})(_objectSpread(_objectSpread({},r),{},{unixTime:i,untils:a.untils,offsets:a.offsets})),s=a.offsets[o],c=new Date(i+6e4*s);return fromUTCDate(c)},convertUTCDateTimeToZone=(e,t)=>{const r=(0,n.yQ)(t),a=Date.UTC(e.year,e.month-1,e.day,e.hours,e.minutes,e.seconds||0),i=(e=>{let{unixTime:t,untils:r}=e;const a=r.length-1;for(let e=0;e<a;e++)if(t<r[e])return e;return a})({unixTime:a,untils:r.untils}),o=r.offsets[i],s=new Date(a-6e4*o);return fromUTCDate(s)}},34458:function(e,t,r){r.d(t,{Co:function(){return formatImage},Np:function(){return toImage},SE:function(){return toBlob},SI:function(){return resize},tg:function(){return resizeImage}});var a=r(1350),n=r(2661);const toImage=e=>new Promise(((t,r)=>{if(!e)return r(new Error("url required"));const a=new Image;a.onload=()=>{t(a)},a.onerror=r,a.crossOrigin="anonymous",a.referrerPolicy="no-referrer",a.src=e})),resizeImage=async e=>{var t;let{original:r,maxWidth:a=0,maxHeight:n=0,finalMimeType:i="image/jpeg",encoderOptions:o=1,bigResize:s=!1}=e;const c=await toImage(r);let{width:l,height:u}=c;const d=document.createElement("canvas"),[p,y]=[a&&l/a,n&&u/n].map(Number);if(p<=1&&y<=1)return c.src;return p>=y==!(a&&n&&s)?(u/=p,l=a):(l/=y,u=n),d.width=l,d.height=u,null===(t=d.getContext("2d"))||void 0===t||t.drawImage(c,0,0,l,u),d.toDataURL(i,o)},extractBase64Image=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const[t="",r=""]=(e||"").split(","),[,a=""]=t.match(/:(.*?);/)||[];return{mime:a,base64:r}},toUint8Array=e=>{const t=atob(e);let r=t.length;const a=new Uint8Array(r);for(;r--;)a[r]=t.charCodeAt(r);return a},toBlob=e=>{const{base64:t,mime:r}=extractBase64Image(e);return new Blob([toUint8Array(t)],{type:r})},resize=async(e,t)=>async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/jpeg",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const process=async(e,n,i)=>{const o=await resizeImage({original:e,maxWidth:n,maxHeight:i,finalMimeType:r,encoderOptions:a}),{size:s}=new Blob([o]);return s<=t?o:process(o,Math.round(.9*n),Math.round(.9*i))},{height:n,width:i}=await toImage(e);return process(e,i,n)}(await(0,n.s3)(e),t,e.type),formatImage=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return!e||a.wmg.test(e)||e.startsWith("data:")||e.startsWith("http://")||e.startsWith("https://")?e:"data:image/png;base64,".concat(e)}},78599:function(e,t,r){let a,n,i,o,s,c,l,u,d,p,y,m,f,g,h;var b;let w;r.d(t,{AT:function(){return m},IZ:function(){return y},L:function(){return l},NA:function(){return s},P1:function(){return w},PJ:function(){return f},W4:function(){return d},cK:function(){return p},h3:function(){return a},us:function(){return n},xc:function(){return o},yF:function(){return c},yY:function(){return i}}),function(e){e[e.GOOGLE=1]="GOOGLE"}(a||(a={})),function(e){e.YAHOO="yahoo",e.OUTLOOK="outlook",e.DEFAULT="default"}(n||(n={})),function(e){e[e.AUTHENTICATION=0]="AUTHENTICATION",e[e.SELECT_IMPORT_TYPE=1]="SELECT_IMPORT_TYPE",e[e.SUCCESS=2]="SUCCESS",e[e.OAUTH_INSTRUCTIONS=3]="OAUTH_INSTRUCTIONS"}(i||(i={})),function(e){e.MAIL="Mail",e.CALENDAR="Calendar",e.CONTACTS="Contacts"}(o||(o={})),function(e){e.PLAIN="PLAIN",e.OAUTH="XOAUTH2"}(s||(s={})),function(e){e.INBOX="Inbox",e.ALL_DRAFTS="All Drafts",e.ALL_SENT="All Sent",e.TRASH="Trash",e.SPAM="Spam",e.ALL_MAIL="All Mail",e.STARRED="Starred",e.ARCHIVE="Archive",e.SENT="Sent",e.DRAFTS="Drafts"}(c||(c={})),function(e){e.BIG_BANG="big_bang",e.LAST_YEAR="last_year",e.LAST_3_MONTHS="last_3_months",e.LAST_MONTH="last_month"}(l||(l={})),function(e){e[e.IMAP_CONNECTION_ERROR=2900]="IMAP_CONNECTION_ERROR",e[e.AUTHENTICATION_ERROR=2901]="AUTHENTICATION_ERROR",e[e.ALREADY_EXISTS=2500]="ALREADY_EXISTS",e[e.OAUTH_INSUFFICIENT_SCOPES=2027]="OAUTH_INSUFFICIENT_SCOPES",e[e.BANDWIDTH_LIMIT=2902]="BANDWIDTH_LIMIT",e[e.TEMP_PROVIDER_ERROR=2902]="TEMP_PROVIDER_ERROR",e[e.RATE_LIMIT_EXCEEDED=429]="RATE_LIMIT_EXCEEDED"}(u||(u={})),function(e){e.FORUMS="Forums",e.PROMOTIONS="Promotions",e.SOCIAL="Social",e.UPDATES="Updates"}(d||(d={})),function(e){e.MAX_FOLDERS_LIMIT_REACHED="Max folders limit reached",e.FOLDER_NAMES_TOO_LONG="Folder names too long",e.LABEL_NAMES_TOO_LONG="Label names too long",e.UNAVAILABLE_NAMES="Unavailable names",e.RESERVED_NAMES="Reserved names"}(p||(p={})),function(e){e[e.Mapping=1]="Mapping",e[e.Label=2]="Label",e[e.Period=4]="Period"}(y||(y={})),function(e){e[e.TRUE=1]="TRUE",e[e.FALSE=0]="FALSE"}(m||(m={})),function(e){e.MAX_CALENDARS_LIMIT_REACHED="Max calendars limit reached"}(f||(f={})),function(e){e[e.ERROR_CODE_IMAP_CONNECTION=1]="ERROR_CODE_IMAP_CONNECTION",e[e.ERROR_CODE_QUOTA_LIMIT=2]="ERROR_CODE_QUOTA_LIMIT"}(g||(g={})),function(e){e[e.QUEUED=0]="QUEUED",e[e.RUNNING=1]="RUNNING",e[e.DONE=2]="DONE",e[e.FAILED=3]="FAILED",e[e.PAUSED=4]="PAUSED",e[e.CANCELED=5]="CANCELED",e[e.DELAYED=6]="DELAYED"}(h||(h={})),function(e){e[e.UNSENT=0]="UNSENT",e[e.SENT=1]="SENT"}(b||(b={})),function(e){e.EASY_SWITCH_SETTINGS="easy-switch-settings",e.IMPORT_CONTACT_SETTINGS="import-contacts-settings",e.CONTACTS_WIDGET_SETTINGS="contacts-widget-settings",e.IMPORT_CALENDAR_SETTINGS="import-calendar-settings",e.RECONNECT_IMPORT="reconnect-import",e.IMPORT_CONTACTS_BUTTON="import-contacts-button"}(w||(w={}))},46605:function(e,t,r){let a,n;r.d(t,{F:function(){return n},a:function(){return a}}),function(e){e[e.DISABLED=0]="DISABLED",e[e.ENABLED=1]="ENABLED",e[e.OUTDATED=2]="OUTDATED",e[e.SET=3]="SET",e[e.PROMPT=4]="PROMPT"}(a||(a={})),function(e){e[e.PROTON=1]="PROTON",e[e.MANAGED=2]="MANAGED",e[e.EXTERNAL=3]="EXTERNAL"}(n||(n={}))},19962:function(e,t,r){r.d(t,{JZ:function(){return getActiveKeyObject},KE:function(){return getNormalizedActiveKeys},d4:function(){return getPrimaryFlag},kS:function(){return getActiveKeys},y3:function(){return getReactivatedKeyFlag}});var a=r(56666),n=r(28391),i=r(38795),o=r(1350),s=r(92818),c=r(164),l=r(82453);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const getPrimaryFlag=e=>e.length?0:1,getReactivatedKeyFlag=(e,t)=>(0,s.oD)(null!=t?t:(0,c.Zr)(e),o.TqO.FLAG_NOT_OBSOLETE),getActiveKeyObject=async(e,t)=>_objectSpread({privateKey:e,publicKey:await n.g.importPublicKey({binaryKey:await n.g.exportPublicKey({key:e,format:"binary"})}),primary:0,fingerprint:e.getFingerprint(),sha256Fingerprints:await n.g.getSHA256Fingerprints({key:e})},t),getActiveKeys=async(e,t,r,a)=>{if(!a.length)return[];const n=(0,l.yw)((0,l.uU)(null==t?void 0:t.Data)),o=r.reduce(((e,t)=>(e[t.ID]=t,e)),{});return(await Promise.all(a.map((async(t,r)=>{var a,i,s,l;let{ID:u,privateKey:d}=t;const p=d.getFingerprint(),y=o[u],m=n[p];return getActiveKeyObject(d,{ID:u,primary:(null!==(a=null!==(i=null==m?void 0:m.Primary)&&void 0!==i?i:null==y?void 0:y.Primary)&&void 0!==a?a:0===r)?1:0,flags:null!==(s=null!==(l=null==m?void 0:m.Flags)&&void 0!==l?l:null==y?void 0:y.Flags)&&void 0!==s?s:(0,c.Zr)(e)})})))).filter(i.Z)},getNormalizedActiveKeys=(e,t)=>t.sort(((e,t)=>t.primary-e.primary)).map(((t,r)=>{let a=t.flags;return a=(null==e?void 0:e.Type)===o.Ted.TYPE_EXTERNAL?(0,s.ft)(a,o.TqO.FLAG_EXTERNAL):(0,s.oD)(a,o.TqO.FLAG_EXTERNAL),_objectSpread(_objectSpread({},t),{},{primary:0===r?1:0,flags:a})}))},54036:function(e,t,r){r.d(t,{x:function(){return getPrimaryKey}});const getPrimaryKey=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e[0]}},47886:function(e,t,r){r.d(t,{GG:function(){return getHasMigratedAddressKey},k_:function(){return getHasMigratedAddressKeys},n9:function(){return getSentryError},j6:function(){return migrateMemberAddressKeys},Bx:function(){return migrateUser},ss:function(){return restoreBrokenSKL}});var a=r(56666),n=r(28391),i=r(63889),o=r(38795),s=r(24955),c=r(43825),l=r(23588),u=r(35804),d=r(59740);const p=["MemberID"],y=["MemberID"],migrateMembersAddressKeysRoute=e=>{let{MemberID:t}=e,r=(0,d.Z)(e,p);return{url:"members/".concat(t,"/keys/migrate"),method:"post",data:r}},restoreBrokenSKLRoute=e=>{let{MemberID:t}=e,r=(0,d.Z)(e,y);return{url:"members/".concat(t,"/keys/signedkeylists"),method:"post",data:r}};var m=r(3587),f=r(67136),g=r(1350),h=r(31608),b=r(45876),w=r(19962),v=r(54170),A=r(58753),P=r(38169),O=r(54036),j=r(82453);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const getSentryError=e=>{if(e instanceof h.MS){const{message:t,code:r}=(0,l.tf)(e);return t&&r>=400&&r<500?t:null}return e},getHasMigratedAddressKey=e=>{let{Token:t,Signature:r}=e;return!!t&&!!r},getHasMigratedAddressKeys=e=>e.some((e=>{var t;return null===(t=e.Keys)||void 0===t?void 0:t.some(getHasMigratedAddressKey)}));async function getAddressKeysMigrationPayload(e,t,r){const a=await Promise.all(e.map((async e=>{let{address:a,keys:o}=e;const s=await Promise.all(o.map((async e=>{let{ID:a,privateKey:i}=e;const{token:o,encryptedToken:s,signature:c,organizationSignature:l}=await(0,b.AT)(t,r);return{encryptedToken:s,signature:c,organizationSignature:l,privateKey:i,privateKeyArmored:await n.g.exportPrivateKey({privateKey:i,passphrase:o}),ID:a}}))),c=await Promise.all(s.map((async e=>{let{ID:t,privateKey:r}=e;return{ID:t,privateKey:r,publicKey:await(0,i.y)(r)}}))),l=(0,w.KE)(a,await(0,w.kS)(a,a.SignedKeyList,a.Keys,c));return{Address:a,SignedKeyList:l.length>0?await(0,j.lw)(l):void 0,AddressKeys:s.map((e=>_objectSpread({ID:e.ID,PrivateKey:e.privateKeyArmored,Token:e.encryptedToken,Signature:e.signature},e.organizationSignature?{OrgSignature:e.organizationSignature}:void 0)))}})));return a.reduce(((e,t)=>{let{AddressKeys:r,Address:a,SignedKeyList:n}=t;return r.length>0&&(e.AddressKeys=e.AddressKeys.concat(r),e.SignedKeyLists[a.ID]=n),e}),{AddressKeys:[],SignedKeyLists:{}})}async function migrateAddressKeys(e){var t;let{user:r,addresses:a,keyPassword:n,organizationKey:i}=e;const o=await(0,P.rB)(r,n),c=null===(t=(0,O.x)(o))||void 0===t?void 0:t.privateKey;if(!c)throw new Error("Missing primary private user key");const l=await Promise.all(a.map((async e=>({address:e,keys:await(0,v.N)(e.Keys,r,o,n)}))));if(!i)return getAddressKeysMigrationPayload(l,c);const u=await(0,A.m)((null==i?void 0:i.PrivateKey)||"",n).catch(s.Z);if(!u)throw new Error("Failed to decrypt organization key");return getAddressKeysMigrationPayload(l,c,u.privateKey)}async function migrateMemberAddressKeys(e){var t;let{api:r,keyPassword:a,timeout:n=12e4,user:i,organization:l}=e;if(1!==l.ToMigrate)return!1;if(i.Role!==g.pRz.ADMIN_ROLE)return;const{Scopes:u}=await r((0,c.GP)());if(!u.includes("organization"))return;const d=await r((0,f.Gu)()),p=await(0,A.m)(null!==(t=null==d?void 0:d.PrivateKey)&&void 0!==t?t:"",a).catch(s.Z);if(null==p||!p.privateKey)return;const y=(await(0,m.Ux)(r)).filter((e=>{let{ToMigrate:t,Private:r,Self:a}=e;return!a&&1===t&&r===g.oeR.READABLE}));if(y.length)for(const e of y){var h,b;if(null===(h=e.Keys)||void 0===h||!h.length)continue;const t=await(0,m.TL)(r,e.ID),a=await(0,P.DD)(e.Keys,"",p),i=null===(b=(0,O.x)(a))||void 0===b?void 0:b.privateKey;if(!i)throw new Error("Not able to decrypt the primary member user key");const s=(await Promise.all(t.map((async e=>{const t={address:e,keys:await(0,v.f)(e.Keys,a,"",p)};if(t.keys.length)return t})))).filter(o.Z);if(!s.length)continue;const c=await getAddressKeysMigrationPayload(s,i,p.privateKey);c&&await r(_objectSpread(_objectSpread({},migrateMembersAddressKeysRoute(_objectSpread({MemberID:e.ID},c))),{},{timeout:n}))}}const migrateUser=async e=>{let{api:t,user:r,addresses:a,keyPassword:n,timeout:i=12e4}=e;if(1!==r.ToMigrate||getHasMigratedAddressKeys(a))return!1;if(r.Private===g.oeR.READABLE&&r.Role===g.pRz.MEMBER_ROLE)return!1;if(r.Private===g.oeR.READABLE&&r.Role===g.pRz.ADMIN_ROLE){const[e,o]=await Promise.all([t((0,m.L)("me")).then((e=>{let{Member:t}=e;return t})),t((0,f.Gu)())]),s=await migrateAddressKeys({user:r,organizationKey:o,addresses:a,keyPassword:n});return await t(_objectSpread(_objectSpread({},migrateMembersAddressKeysRoute(_objectSpread({MemberID:e.ID},s))),{},{timeout:i})),!0}const o=await migrateAddressKeys({user:r,addresses:a,keyPassword:n});return await t(_objectSpread(_objectSpread({},(0,u.lL)(o)),{},{timeout:i})),!0};async function restoreBrokenSKL(e){var t;let{api:r,keyPassword:a,timeout:n=12e4,user:i}=e;if(i.Role!==g.pRz.ADMIN_ROLE)return;const{Scopes:l}=await r((0,c.GP)());if(!l.includes("organization"))return;const u=await r((0,f.Gu)()),d=await(0,A.m)(null!==(t=null==u?void 0:u.PrivateKey)&&void 0!==t?t:"",a).catch(s.Z);if(null==d||!d.privateKey)return;const p=(await(0,m.Ux)(r)).filter((e=>{let{BrokenSKL:t}=e;return 1===t}));if(p.length)for(const e of p){var y,h;if(null===(y=e.Keys)||void 0===y||!y.length)continue;const t=await(0,m.TL)(r,e.ID),a=await(0,P.DD)(e.Keys,"",d);if(!(null===(h=(0,O.x)(a))||void 0===h?void 0:h.privateKey))throw new Error("Not able to decrypt the primary member user key");const i=(await Promise.all(t.map((async e=>{const t={address:e,keys:await(0,v.f)(e.Keys,a,"",d)};if(t.keys.length)return t})))).filter(o.Z);if(!i.length)continue;const s=await Promise.all(i.map((async e=>{let{address:t,keys:r}=e;const a=(0,w.KE)(t,await(0,w.kS)(t,null,t.Keys,r));return{Address:t,SignedKeyList:a.length>0?await(0,j.lw)(a):void 0}}))),c=s.reduce(((e,t)=>(t.SignedKeyList&&(e[t.Address.ID]=t.SignedKeyList),e)),{});Object.keys(c).length>0&&await r(_objectSpread(_objectSpread({},restoreBrokenSKLRoute({MemberID:e.ID,SignedKeyLists:c})),{},{timeout:n}))}}},82453:function(e,t,r){r.d(t,{lw:function(){return getSignedKeyList},uU:function(){return getParsedSignedKeyList},yw:function(){return getSignedKeyListMap}});var a=r(28391);const getSignature=async(e,t)=>await a.g.signMessage({textData:e,stripTrailingSpaces:!0,signingKeys:[t],detached:!0}),getSignedKeyList=async e=>{var t;const r=await Promise.all(e.map((async e=>{let{flags:t,primary:r,sha256Fingerprints:a,fingerprint:n}=e;return{Primary:r,Flags:t,Fingerprint:n,SHA256Fingerprints:a}}))),a=JSON.stringify(r),n=null===(t=e[0])||void 0===t?void 0:t.privateKey;if(!n)throw new Error("Missing primary signing key");return{Data:a,Signature:await getSignature(a,n)}},getParsedSignedKeyList=e=>{if(e)try{const t=JSON.parse(e);if(!Array.isArray(t))return;if(!t.every((e=>Array.isArray(e.SHA256Fingerprints))))return;return t}catch(e){return}},getSignedKeyListMap=e=>e?e.reduce(((e,t)=>(e[t.Fingerprint]=t,e)),{}):{}},47169:function(e,t,r){r.d(t,{i:function(){return s}});var a=r(64852),n=r(88468),i=r(1350),o=r(51983);const s={key:"ContactEmails",get:e=>(0,n.Z)(((t,r)=>e((0,a.fn)({Page:t,PageSize:r}))),{pageSize:i.mLX,pagesPerChunk:i.hQY,delayPerChunk:1e3}).then((e=>e.flatMap((e=>{let{ContactEmails:t}=e;return t})))),update:(e,t)=>(0,o.Z)({model:e,events:t,item:e=>{let{ContactEmail:t}=e;return t}})}},55704:function(e,t,r){r.d(t,{o:function(){return s}});var a=r(64852),n=r(88468),i=r(1350),o=r(51983);const pick=e=>{let{ID:t,Name:r,LabelIDs:a}=e;return{ID:t,Name:r,LabelIDs:a}},compareName=(e,t)=>e.Name.localeCompare(t.Name),mergeModel=(e,t)=>t,s={key:"Contacts",get:e=>(0,n.Z)(((t,r)=>e((0,a.NY)({Page:t,PageSize:r}))),{pageSize:i.DNW,pagesPerChunk:i.hQY}).then((e=>e.flatMap((e=>{let{Contacts:t}=e;return t.map(pick)})).sort(compareName))),update:(e,t)=>(0,o.Z)({model:e,events:t,item:e=>{let{Contact:t}=e;return pick(t)},merge:mergeModel}).sort(compareName)}},42770:function(e,t,r){r.d(t,{t:function(){return i}});var a=r(94593),n=r(51983);const i={key:"Filters",get:e=>e((0,a.vP)()).then((e=>{let{Filters:t}=e;return t})),update:(e,t)=>(0,n.Z)({model:e,events:t,item:e=>{let{Filter:t}=e;return t}})}},42779:function(e,t,r){r.d(t,{G:function(){return i}});var a=r(83959),n=r(51983);const extractLabels=e=>{let{Labels:t=[]}=e;return t},i={key:"Labels",get:async e=>{const[t=[],r=[],n=[]]=await Promise.all([e((0,a.g7)()).then(extractLabels),e((0,a.xh)()).then(extractLabels),e((0,a.HW)()).then(extractLabels)]);return[...t,...r,...n]},update:(e,t)=>(0,n.Z)({model:e,events:t,item:e=>{let{Label:t}=e;return t},merge:(e,t)=>t})}},52528:function(e,t,r){r.d(t,{w:function(){return n}});var a=r(67136);const n={key:"Organization",get:e=>e((0,a.Xu)()).then((e=>{let{Organization:t}=e;return t})),update:r(12772).Z}},98903:function(e,t,r){r.d(t,{H:function(){return o}});var a=r(76881),n=r(12772),i=r(56666);const isManagedByMozilla=function(){let{CouponCode:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e||"";return t.startsWith("MOZILLA")||t.startsWith("MOZTEST")};function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var subscription_format=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _objectSpread(_objectSpread({},e),{},{isManagedByMozilla:isManagedByMozilla(e)})};const o={key:"Subscription",get:e=>e((0,a.pI)()).then((e=>{let{Subscription:t}=e;return subscription_format(t)})),update:(e,t)=>subscription_format((0,n.Z)(e,t))}},52494:function(e,t,r){r.d(t,{$I:function(){return attemptDeviceRecovery},yk:function(){return getHasRecoveryMessage},IE:function(){return j},Kd:function(){return removeDeviceRecovery},pS:function(){return storeDeviceRecovery}});var a=r(56666),n=r(38795);const getKeysToReactivate=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const r=new Set(t.map((e=>{let{ID:t}=e;return t})));return e.filter((e=>!r.has(e.ID)))};var i=r(6440),o=r(28391),s=r(92925);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c=r(24955),l=r(12505);var u=r(11696),d=r(38169),p=r(54170),y=r(47886),m=r(164),f=r(35804),g=r(19962),h=r(82453),b=r(22569);function reactivateKeyHelper_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function reactivateKeyHelper_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?reactivateKeyHelper_ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):reactivateKeyHelper_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const getReactivatedAddressesKeys=async e=>{let{addresses:t,oldUserKeys:r,newUserKeys:a,user:n,keyPassword:i}=e;const o=t.map((e=>(async e=>{let{address:t,user:r,oldUserKeys:a,newUserKeys:n,keyPassword:i}=e;const o={address:t,reactivatedKeys:void 0,signedKeyList:void 0},s=await(0,p.N)(t.Keys,r,a,i);if(s.length===t.Keys.length)return o;const c=await(0,p.N)(t.Keys,r,n,i);if(s.length===c.length)return o;if(c.length<s.length)throw new Error("More old decryptable keys than new, should never happen");const l=new Set(s.map((e=>{let{ID:t}=e;return t}))),u=c.filter((e=>{let{ID:t}=e;return!l.has(t)})),d=new Set(u.map((e=>{let{ID:t}=e;return t})));if(!d.size)return o;const y=new Map(t.Keys.map((e=>[e.ID,e]))),m=await(0,g.kS)(t,t.SignedKeyList,t.Keys,c),f=(0,g.KE)(t,m.map((e=>{var r;return d.has(e.ID)?reactivateKeyHelper_objectSpread(reactivateKeyHelper_objectSpread({},e),{},{flags:(0,g.y3)(t,null===(r=y.get(e.ID))||void 0===r?void 0:r.Flags)}):e})));return{address:t,reactivatedKeys:u,signedKeyList:await(0,h.lw)(f)}})({address:e,oldUserKeys:r,newUserKeys:a,user:n,keyPassword:i})));return(await Promise.all(o)).filter((e=>{let{reactivatedKeys:t}=e;return!!t&&t.length>0}))},resetUserId=async(e,t)=>{const r=await o.g.importPublicKey({armoredKey:e.PrivateKey});await o.g.replaceUserIDs({sourceKey:r,targetKey:t})},reactivateKeysProcess=async e=>{let{api:t,keyPassword:r,keysToReactivate:a,address:n,onReactivation:i,keys:s,Keys:c}=e;let l=await(0,g.kS)(n,null==n?void 0:n.SignedKeyList,c,s);for(const e of a){const{id:a,Key:s,privateKey:c}=e,{ID:u}=s;try{if(!c)throw new Error("Missing key");await resetUserId(s,c);const e=await o.g.exportPrivateKey({privateKey:c,passphrase:r}),d=await(0,g.JZ)(c,{ID:u,primary:(0,g.d4)(l),flags:(0,m.Zr)(n)}),p=(0,g.KE)(n,[...l,d]),y=n?await(0,h.lw)(p):void 0;await t((0,f.Bg)({ID:u,PrivateKey:e,SignedKeyList:y})),l=p,i(a,"ok")}catch(e){i(a,e)}}};var reactivation_reactivateKeysProcessLegacy=async e=>{let{keyReactivationRecords:t,api:r,onReactivation:a,keyPassword:n}=e;for(const e of t){const{user:t,address:i,keysToReactivate:o,keys:s}=e;try{const e=i?i.Keys:(null==t?void 0:t.Keys)||[];await reactivateKeysProcess({api:r,keyPassword:n,keysToReactivate:o,address:i,onReactivation:a,keys:s,Keys:e})}catch(e){o.forEach((t=>{let{id:r}=t;return a(r,e)}))}}},w=r(23588),v=r(1350),A=r(45876),P=r(54036);function reactivateKeysProcessV2_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function reactivateKeysProcessV2_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?reactivateKeysProcessV2_ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):reactivateKeysProcessV2_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const reactivateAddressKeysV2=async e=>{let{api:t,address:r,activeKeys:a,keysToReactivate:n,onReactivation:i,userKey:s}=e,c=a;for(const e of n){const{id:a,Key:n,privateKey:l}=e,{ID:u,Flags:d}=n;try{if(!l)throw new Error("Missing key");await resetUserId(n,l);const{token:e,encryptedToken:p,signature:y}=await(0,A.AT)(s),m=await o.g.exportPrivateKey({privateKey:l,passphrase:e}),b=await(0,g.JZ)(l,{ID:u,primary:(0,g.d4)(c),flags:(0,g.y3)(r,d)}),w=(0,g.KE)(r,[...c,b]);await t((0,f.En)({ID:u,PrivateKey:m,SignedKeyList:await(0,h.lw)(w),Token:p,Signature:y})),c=w,i(a,"ok")}catch(e){i(a,e)}}return c};var reactivation_reactivateKeysProcessV2=async e=>{var t;let{api:r,user:a,keyReactivationRecords:n,onReactivation:i,keyPassword:s,addresses:c,userKeys:l}=e;const{userRecord:u,addressRecordsInV2Format:d,addressRecordsInLegacyFormatOrWithBackup:h}=n.reduce(((e,t)=>{const{user:r,address:a,keysToReactivate:n,keys:i}=t;if(r&&(e.userRecord=t),a){const t=n.filter((e=>{let{privateKey:t,Key:r}=e;return!t&&(0,y.GG)(r)})),r=n.filter((e=>{let{privateKey:t,Key:r}=e;return t||!(0,y.GG)(r)}));t.length&&e.addressRecordsInV2Format.push({address:a,keys:i,keysToReactivate:t}),r.length&&e.addressRecordsInLegacyFormatOrWithBackup.push({address:a,keys:i,keysToReactivate:r})}return e}),{addressRecordsInV2Format:[],addressRecordsInLegacyFormatOrWithBackup:[],userRecord:void 0});let A=l,O=c,j={};if(u)try{const e=await(0,g.kS)(void 0,null,a.Keys,A),t=await(async e=>{let{addressRecordsInV2Format:t,api:r,addresses:a,user:n,activeKeys:i,keysToReactivate:s,onReactivation:c,keyPassword:l}=e;const u=t.reduce(((e,t)=>(t.keysToReactivate.forEach((t=>{e[t.Key.ID]=t})),e)),{}),d={},p={};let y=i,h=a;for(const e of s){const{id:t,Key:i,privateKey:s}=e,{ID:P}=i;try{if(!s)throw new Error("Missing key");await resetUserId(i,s);const e=await o.g.exportPrivateKey({privateKey:s,passphrase:l}),w=await(0,g.JZ)(s,{ID:P,primary:(0,g.d4)(y),flags:(0,m.Zr)(void 0)}),v=(0,g.KE)(void 0,[...y,w]),O=await getReactivatedAddressesKeys({addresses:a,oldUserKeys:y,newUserKeys:v,user:n,keyPassword:l}),j=(A=O,{AddressKeyFingerprints:(0,b.Z)(A.reduce(((e,t)=>{let{reactivatedKeys:r}=t;return r?e.concat(r):e}),[])).map((e=>{let{privateKey:t}=e;return t.getFingerprint()})),SignedKeyLists:A.reduce(((e,t)=>{var r;if(null===(r=t.reactivatedKeys)||void 0===r||!r.length||!t.signedKeyList)throw new Error("Missing reactivated keys");return e[t.address.ID]=t.signedKeyList,e}),{})});h=h.map((e=>{const t=j.SignedKeyLists[e.ID];return t?reactivateKeysProcessV2_objectSpread(reactivateKeysProcessV2_objectSpread({},e),{},{SignedKeyList:t}):e})),await r((0,f.yI)(reactivateKeysProcessV2_objectSpread({ID:P,PrivateKey:e},j))),y=v,c(t,"ok"),O.forEach((e=>{let{reactivatedKeys:t}=e;null==t||t.forEach((e=>{let{ID:t}=e;p[t]=!0;const r=u[t];r&&(c(r.id,"ok"),d[r.id]=!0)}))}))}catch(e){c(t,e);const{status:r}=(0,w.tf)(e);if(r===v.NLA.FORBIDDEN)break}}var A;return t.forEach((e=>{let{keysToReactivate:t}=e;t.forEach((e=>{let{id:t,privateKey:r}=e;d[t]||r||c(t,new Error("User key inactivate"))}))})),{userKeys:y,addresses:h,allReactivatedAddressKeysMap:p}})({api:r,user:a,activeKeys:e,addresses:c,keysToReactivate:u.keysToReactivate,onReactivation:i,keyPassword:s,addressRecordsInV2Format:d});A=t.userKeys,O=t.addresses,j=t.allReactivatedAddressKeysMap}catch(e){u.keysToReactivate.forEach((t=>{let{id:r}=t;return i(r,e)})),d.forEach((t=>{let{keysToReactivate:r}=t;r.forEach((t=>{let{id:r}=t;return i(r,e)}))}))}const S=null===(t=(0,P.x)(A))||void 0===t?void 0:t.privateKey;for(const{address:e,keysToReactivate:t}of h){const n=[];t.forEach((e=>{!0===j[e.Key.ID]?i(e.id,"ok"):n.push(e)}));try{const t=O.find((t=>{let{ID:r}=t;return(null==e?void 0:e.ID)===r}));if(!t||!S)throw new Error("Missing dependency");const o=await(0,p.N)(t.Keys,a,A,""),s=await(0,g.kS)(t,t.SignedKeyList,t.Keys,o);await reactivateAddressKeysV2({api:r,address:t,activeKeys:s,userKey:S,onReactivation:i,keysToReactivate:n})}catch(e){n.forEach((t=>{let{id:r}=t;return i(r,e)}))}}};var O=r(92673);function deviceRecovery_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function deviceRecovery_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?deviceRecovery_ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):deviceRecovery_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const getRecoveryMessageId=e=>"dr-".concat(e),getRecoveryMessage=e=>(0,u.rV)(getRecoveryMessageId(e)),getHasRecoveryMessage=e=>!!getRecoveryMessage(e),removeDeviceRecovery=e=>{(0,u.cl)(getRecoveryMessageId(e))},getKeysFromDeviceRecovery=async e=>{const t=getRecoveryMessage(e.ID),r=(0,O.WA)(e.Keys);if(!t||!r.length)return;const a=await(0,O.pi)([t],r);return Promise.all(a.map((e=>{let{armoredKey:t}=e;return o.g.importPrivateKey({armoredKey:t,passphrase:null})})))},attemptDeviceRecovery=async e=>{let{user:t,addresses:r,keyPassword:a,api:c}=e;const l=Boolean(t.Private);if(!r||!l)return;if(!(0,i.Z)(t,r))return;const u=await(0,d.rB)(t,a),m=((e,t,r)=>{const a=(e||[]).map((e=>{let{address:t,keys:r}=e;const a=getKeysToReactivate(t.Keys,r);if(a.length)return{address:t,keys:r,keysToReactivate:a}})),i=getKeysToReactivate(null==t?void 0:t.Keys,r);return[t&&r&&i.length?{user:t,keys:r,keysToReactivate:i}:void 0,...a].filter(n.Z)})(await Promise.all(r.map((async e=>({address:e,keys:await(0,p.N)(e.Keys,t,u,a)})))),t,u),f=await(async e=>{if(0===e.length)throw new Error("Keys to reactivate needed");return Promise.all(e.map((async e=>{const t=await Promise.all(e.keysToReactivate.map((async e=>{try{const{fingerprint:t}=await o.g.getKeyInfo({armoredKey:e.PrivateKey});return{id:(0,s.Z)(12),Key:e,fingerprint:t,result:void 0}}catch(t){return{id:(0,s.Z)(12),Key:e,fingerprint:"-",result:void 0}}})));return _objectSpread(_objectSpread({},e),{},{keysToReactivate:t})})))})(m),g=await getKeysFromDeviceRecovery(t);if(!g)return;const mapToUploadedPrivateKey=e=>{let{id:t,Key:r,fingerprint:a}=e;const n=g.find((e=>a===e.getFingerprint()));if(n)return{id:t,Key:r,privateKey:n}},h=f.map((e=>{const t=e.keysToReactivate.map(mapToUploadedPrivateKey).filter(n.Z);if(t.length)return deviceRecovery_objectSpread(deviceRecovery_objectSpread({},e),{},{keysToReactivate:t})})).filter(n.Z);let b=0;return await(async e=>{let{api:t,user:r,userKeys:a,addresses:n,keyReactivationRecords:i,keyPassword:o,onReactivation:s}=e;return(0,y.k_)(n)?reactivation_reactivateKeysProcessV2({api:t,keyReactivationRecords:i,keyPassword:o,user:r,userKeys:a,addresses:n,onReactivation:s}):reactivation_reactivateKeysProcessLegacy({api:t,keyReactivationRecords:i,keyPassword:o,onReactivation:s})})({api:c,user:t,userKeys:u,addresses:r,keyReactivationRecords:h,keyPassword:a,onReactivation:(e,t)=>{"ok"===t&&b++}}),b},storeRecoveryMessage=async e=>{let{user:t,userKeys:r,recoverySecret:a}=e;const n=await getKeysFromDeviceRecovery(t)||[],i=[...r.map((e=>{let{privateKey:t}=e;return t})),...n],o=(0,l.Z)(i,(e=>e.getFingerprint())),s=await(0,O.pf)({recoverySecret:a,privateKeys:o});((e,t)=>{(0,u.LS)(getRecoveryMessageId(e),t)})(t.ID,s)},storeDeviceRecovery=async e=>{let{api:t,user:r,userKeys:a}=e;if(!Boolean(r.Private))return;const n=null==a?void 0:a[0];if(!n)return;const i=(0,O.zH)(r.Keys.find((e=>e.ID===n.ID)));if(!i){const{recoverySecret:e,signature:i}=await(0,O.nE)(n.privateKey),silentApi=e=>t(deviceRecovery_objectSpread(deviceRecovery_objectSpread({},e),{},{silence:!0}));return await silentApi((o={RecoverySecret:e,Signature:i},{url:"core/v4/settings/recovery/secret",method:"post",data:o})),void await storeRecoveryMessage({user:r,userKeys:a,recoverySecret:e})}var o;await(0,O.U_)(i,n.publicKey).catch(c.Z)&&await storeRecoveryMessage({user:r,userKeys:a,recoverySecret:i.RecoverySecret})},j=O.lJ},92673:function(e,t,r){r.d(t,{U_:function(){return validateRecoverySecret},WA:function(){return getRecoverySecrets},lJ:function(){return getIsRecoveryFileAvailable},nE:function(){return generateRecoverySecret},pf:function(){return generateRecoveryFileMessage},pi:function(){return parseRecoveryFiles},y1:function(){return getPrimaryRecoverySecret},zH:function(){return getKeyWithRecoverySecret}});var a=r(56666),n=r(28391),i=r(79811),o=r(76574),s=r(39300),c=r(38795),l=r(1350),u=r(47886),d=r(54036);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const decryptRecoveryFile=e=>async t=>{try{return await Promise.any(e.map((async e=>{let{RecoverySecret:r}=e;const{data:a}=await n.g.decryptMessage({armoredMessage:t,passwords:r,format:"binary"});return a})))}catch(e){return}},parseRecoveryFiles=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;const r=(await Promise.all(e.map(decryptRecoveryFile(t)))).filter(c.Z),a=(await Promise.all(r.map((e=>n.g.getArmoredKeys({binaryKeys:e}))))).flat();return Promise.all(a.map((async e=>_objectSpread(_objectSpread({},await n.g.getKeyInfo({armoredKey:e})),{},{armoredKey:e}))))},generateRecoverySecret=async e=>{const t=crypto.getRandomValues(new Uint8Array(32)),r=(0,s.oG)(t);return{signature:await n.g.signMessage({textData:r,stripTrailingSpaces:!0,signingKeys:e,detached:!0}),recoverySecret:r}},generateRecoveryFileMessage=async e=>{let{recoverySecret:t,privateKeys:r}=e;const a=await Promise.all(r.map((e=>n.g.exportPrivateKey({privateKey:e,passphrase:null,format:"binary"})))),{message:i}=await n.g.encryptMessage({binaryData:(0,o.w3)(a),passwords:[t]});return i},validateRecoverySecret=async(e,t)=>{const{RecoverySecret:r,RecoverySecretSignature:a}=e,{verified:o}=await n.g.verifyMessage({textData:r,stripTrailingSpaces:!0,verificationKeys:t,armoredSignature:a});return o===i.bR.SIGNED_AND_VALID},getKeyWithRecoverySecret=e=>{if(null!=e&&e.RecoverySecret&&null!=e&&e.RecoverySecretSignature)return e},getRecoverySecrets=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map(getKeyWithRecoverySecret).filter(c.Z)},getPrimaryRecoverySecret=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return getKeyWithRecoverySecret(null==e?void 0:e[0])},getIsRecoveryFileAvailable=e=>{let{user:t,addresses:r,userKeys:a,appName:n}=e;const i=(0,u.k_)(r),o=(0,d.x)(a),s=Boolean(t.Private);return!(null==o||!o.privateKey)&&i&&s&&n!==l.eim.PROTONVPN_SETTINGS}},92925:function(e,t,r){r.d(t,{Z:function(){return getRandomString}});const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function getRandomString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a;const r=crypto.getRandomValues(new Uint32Array(e));let n="";for(let a=0;a<e;a++)n+=t[r[a]%t.length];return n}}},function(e){var __webpack_exec__=function(t){return e(e.s=t)};e.O(0,[8246,7836,6444,1526],(function(){return __webpack_exec__(82522),__webpack_exec__(33575)}));e.O()}]);
//# sourceMappingURL=index.3331893b.js.map